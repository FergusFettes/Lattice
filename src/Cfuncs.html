<!DOCTYPE html>
<!-- Generated by Cython 0.29.2 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: Cfuncs.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
.cython .hll { background-color: #ffffcc }
.cython  { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #0000FF } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.29.2</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="Cfuncs.c">Cfuncs.c</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">001</span>: <span class="c"># cython: linetrace=True</span></pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(1,0,<span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: <span class="k">import</span> <span class="nn">cython</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">004</span>: <span class="k">import</span> <span class="nn">array</span></pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(4,0,<span class='error_goto'>__PYX_ERR(0, 4, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_array, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_array, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">005</span>: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(5,0,<span class='error_goto'>__PYX_ERR(0, 5, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 5, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 5, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">006</span>: <span class="k">import</span> <span class="nn">time</span></pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(6,0,<span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_time, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_time, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">007</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">008</span>: <span class="k">from</span> <span class="nn">cython.parallel</span> <span class="k">import</span> <span class="n">prange</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">009</span>: <span class="k">from</span> <span class="nn">libc.stdlib</span> <span class="k">cimport</span> <span class="n">rand</span><span class="p">,</span> <span class="n">RAND_MAX</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">010</span>: <span class="k">from</span> <span class="nn">cpython</span> <span class="k">cimport</span> <span class="n">array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">011</span>: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">012</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">013</span>: <span class="k">import</span> <span class="nn">Cyarr</span> <span class="k">as</span> <span class="nn">cy</span></pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(13,0,<span class='error_goto'>__PYX_ERR(0, 13, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_Cyarr, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_cy, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">014</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">015</span>: <span class="c">#==================HI-LEVEL==================</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">016</span>: <span class="c">#============================================</span></pre>
<pre class="cython line score-69" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">017</span>: <span class="k">cpdef</span> <span class="nf">change_zoom_level</span><span class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">head_pos</span><span class="p">,</span> <span class="nb">int</span> <span class="n">buffer_length</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="n">buf</span><span class="p">):</span></pre>
<pre class='cython code score-69 '>static PyObject *__pyx_pw_6Cfuncs_1change_zoom_level(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_6Cfuncs_change_zoom_level(__Pyx_memviewslice __pyx_v_head_pos, int __pyx_v_buffer_length, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_buf, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyObject *__pyx_v_dim_v = NULL;
  PyObject *__pyx_v_buf_v = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("change_zoom_level", 0);
  <span class='trace'>__Pyx_TraceCall</span>("change_zoom_level", __pyx_f[0], 17, 0, <span class='error_goto'>__PYX_ERR(0, 17, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.change_zoom_level", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dim_v);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_buf_v);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_1change_zoom_level(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_change_zoom_level[] = "\n    Checks the array edges, resizes if necessary.\n\n    :param arr:\n    :return:        (3D pointer) new buffer\n    ";
static PyObject *__pyx_pw_6Cfuncs_1change_zoom_level(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_head_pos = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_buffer_length;
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_buf = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("change_zoom_level (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_head_pos,&amp;__pyx_n_s_buffer_length,&amp;__pyx_n_s_dim,&amp;__pyx_n_s_buf,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_head_pos)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_buffer_length)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("change_zoom_level", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 17, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("change_zoom_level", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 17, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_buf)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("change_zoom_level", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 17, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "change_zoom_level") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 17, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_head_pos = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_head_pos.memview)) __PYX_ERR(0, 17, __pyx_L3_error)</span>
    __pyx_v_buffer_length = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]); if (unlikely((__pyx_v_buffer_length == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 17, __pyx_L3_error)</span>
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 17, __pyx_L3_error)</span>
    __pyx_v_buf = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_buf.memview)) __PYX_ERR(0, 17, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("change_zoom_level", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 17, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.change_zoom_level", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_change_zoom_level(__pyx_self, __pyx_v_head_pos, __pyx_v_buffer_length, __pyx_v_dim, __pyx_v_buf);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_change_zoom_level(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_head_pos, int __pyx_v_buffer_length, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_buf) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("change_zoom_level", 0);
  <span class='trace'>__Pyx_TraceCall</span>("change_zoom_level (wrapper)", __pyx_f[0], 17, 0, <span class='error_goto'>__PYX_ERR(0, 17, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_head_pos.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("head_pos"); <span class='error_goto'>__PYX_ERR(0, 17, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 17, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_buf.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("buf"); <span class='error_goto'>__PYX_ERR(0, 17, __pyx_L1_error)</span> }
  __pyx_t_1 = __pyx_f_6Cfuncs_change_zoom_level(__pyx_v_head_pos, __pyx_v_buffer_length, __pyx_v_dim, __pyx_v_buf, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 17, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.change_zoom_level", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_head_pos, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_buf, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">018</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">019</span>: <span class="sd">    Checks the array edges, resizes if necessary.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">020</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">021</span>: <span class="sd">    :param arr:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">022</span>: <span class="sd">    :return:        (3D pointer) new buffer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">023</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">024</span>:     <span class="k">if</span> <span class="n">cy</span><span class="o">.</span><span class="n">check_rim</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">buf</span><span class="p">[</span><span class="n">head_pos</span><span class="p">[</span><span class="mf">0</span><span class="p">]])</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span></pre>
<pre class='cython code score-54 '>  <span class='trace'>__Pyx_TraceLine</span>(24,0,<span class='error_goto'>__PYX_ERR(0, 24, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_cy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_check_rim);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_dim, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = 0;
  __pyx_t_5 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_head_pos.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_head_pos.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 24, __pyx_L1_error)</span>
  }
  __pyx_t_6.data = __pyx_v_buf.data;
  __pyx_t_6.memview = __pyx_v_buf.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_6, 0);
  {
    Py_ssize_t __pyx_tmp_idx = (*((int *) ( /* dim=0 */ (__pyx_v_head_pos.data + __pyx_t_4 * __pyx_v_head_pos.strides[0]) )));
        Py_ssize_t __pyx_tmp_shape = __pyx_v_buf.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_buf.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 24, __pyx_L1_error)</span>
        }
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_6.shape[0] = __pyx_v_buf.shape[1];
__pyx_t_6.strides[0] = __pyx_v_buf.strides[1];
    __pyx_t_6.suboffsets[0] = -1;

__pyx_t_6.shape[1] = __pyx_v_buf.shape[2];
__pyx_t_6.strides[1] = __pyx_v_buf.strides[2];
    __pyx_t_6.suboffsets[1] = -1;

__pyx_t_7 = __pyx_memoryview_fromslice(__pyx_t_6, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
  __pyx_t_8 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_5 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[4] = {__pyx_t_8, __pyx_int_0, __pyx_t_2, __pyx_t_7};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 24, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[4] = {__pyx_t_8, __pyx_int_0, __pyx_t_2, __pyx_t_7};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 24, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  {
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 24, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (__pyx_t_8) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8); __pyx_t_8 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_5, __pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_5, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2+__pyx_t_5, __pyx_t_7);
    __pyx_t_2 = 0;
    __pyx_t_7 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 24, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_10 = (__pyx_t_1 == Py_True);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_11 = (__pyx_t_10 != 0);
  if (__pyx_t_11) {
/* … */
  }
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">025</span>:         <span class="n">dim_v</span><span class="p">,</span> <span class="n">buf_v</span> <span class="o">=</span> <span class="n">resize_array_buffer</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">buffer_length</span><span class="p">)</span></pre>
<pre class='cython code score-15 '>    <span class='trace'>__Pyx_TraceLine</span>(25,0,<span class='error_goto'>__PYX_ERR(0, 25, __pyx_L1_error)</span>)
    __pyx_t_1 = __pyx_f_6Cfuncs_resize_array_buffer(__pyx_v_dim, __pyx_v_buffer_length, 0, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 25, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (likely(__pyx_t_1 != Py_None)) {
      PyObject* sequence = __pyx_t_1;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 25, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 25, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 25, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      <span class='pyx_c_api'>__Pyx_RaiseNoneNotIterableError</span>(); <span class='error_goto'>__PYX_ERR(0, 25, __pyx_L1_error)</span>
    }
    __pyx_v_dim_v = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_v_buf_v = __pyx_t_9;
    __pyx_t_9 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">026</span>:         <span class="n">change_buffer</span><span class="p">(</span><span class="n">head_pos</span><span class="p">,</span> <span class="n">buffer_length</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">dim_v</span><span class="p">,</span> <span class="n">buf_v</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(26,0,<span class='error_goto'>__PYX_ERR(0, 26, __pyx_L1_error)</span>)
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_v_dim_v, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 26, __pyx_L1_error)</span>
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_v_buf_v, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 26, __pyx_L1_error)</span>
    __pyx_t_1 = __pyx_f_6Cfuncs_change_buffer(__pyx_v_head_pos, __pyx_v_buffer_length, __pyx_v_dim, __pyx_v_buf, __pyx_t_12, __pyx_t_13, 0, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 26, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
    __pyx_t_12.memview = NULL;
    __pyx_t_12.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
    __pyx_t_13.memview = NULL;
    __pyx_t_13.data = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">027</span>: <span class="c">#   else:   # if outer rim has nothing, check next one in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">028</span>: <span class="c">#       if cy.check_rim(1, dim_v, arr_v) is False and check _rim(2, dim_v, arr_v) is False:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">029</span>: <span class="c">#           dim_v, buf_v = resize_array_buffer(dim, buffer_length, -1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">030</span>: <span class="c">#           change_buffer(head_pos, buffer_length, dim, buf, dim_v, buf_v,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">031</span>: <span class="c">#                         array.array(&#39;i&#39;, [1,1]), array.array(&#39;i&#39;, [2, 2]))</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">032</span>:     <span class="k">return</span> <span class="n">dim_v</span><span class="p">,</span> <span class="n">buf_v</span></pre>
<pre class='cython code score-14 '>  <span class='trace'>__Pyx_TraceLine</span>(32,0,<span class='error_goto'>__PYX_ERR(0, 32, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_dim_v)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim_v"); <span class='error_goto'>__PYX_ERR(0, 32, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_buf_v)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("buf_v"); <span class='error_goto'>__PYX_ERR(0, 32, __pyx_L1_error)</span> }
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dim_v);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dim_v);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_dim_v);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_buf_v);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_buf_v);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_buf_v);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">033</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">034</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">035</span>: <span class="k">cpdef</span> <span class="kt">tuple</span> <span class="nf">init</span><span class="p">(</span><span class="nb">list</span> <span class="n">dimensions</span><span class="p">):</span></pre>
<pre class='cython code score-19 '>static PyObject *__pyx_pw_6Cfuncs_3init(PyObject *__pyx_self, PyObject *__pyx_v_dimensions); /*proto*/
static PyObject *__pyx_f_6Cfuncs_init(PyObject *__pyx_v_dimensions, CYTHON_UNUSED int __pyx_skip_dispatch) {
  int __pyx_v_buffer_length;
  __Pyx_memviewslice __pyx_v_head_position = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_tail_position = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_buffer_status = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dim_h = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dim_t = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr_h = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr_t = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_buf_h = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("init", 0);
  <span class='trace'>__Pyx_TraceCall</span>("init", __pyx_f[0], 35, 0, <span class='error_goto'>__PYX_ERR(0, 35, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.init", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_head_position, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_tail_position, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_buffer_status, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim_h, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim_t, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr_h, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr_t, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_buf_h, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_3init(PyObject *__pyx_self, PyObject *__pyx_v_dimensions); /*proto*/
static char __pyx_doc_6Cfuncs_2init[] = "\n    Initializes all the variables for a standard run.\n\n    :param dimensions:      (list) initial dimensions of array\n    :param rules:           (list) rules\n    :return:\n        head_pos            (pointer) position of head in buffer\n        tail_pos        (pointer) positions to be analysed\n        buffer_length       (int) buffer length\n        buffer_status       (pointer) list of array poistions in buffer\n        dim                 (pointer) dimensions of array\n        arr                 (2D pointer) array\n        buf                 (3D pointer) buffer\n        dim                 (pointer) dimensions of array\n        arr                 (2D pointer) array\n        buf                 (3D pointer) buffer\n    ";
static PyObject *__pyx_pw_6Cfuncs_3init(PyObject *__pyx_self, PyObject *__pyx_v_dimensions) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("init (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_dimensions), (&amp;PyList_Type), 1, "dimensions", 1))) <span class='error_goto'>__PYX_ERR(0, 35, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6Cfuncs_2init(__pyx_self, ((PyObject*)__pyx_v_dimensions));

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_2init(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_dimensions) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("init", 0);
  <span class='trace'>__Pyx_TraceCall</span>("init (wrapper)", __pyx_f[0], 35, 0, <span class='error_goto'>__PYX_ERR(0, 35, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6Cfuncs_init(__pyx_v_dimensions, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.init", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">036</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">037</span>: <span class="sd">    Initializes all the variables for a standard run.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">038</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">039</span>: <span class="sd">    :param dimensions:      (list) initial dimensions of array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">040</span>: <span class="sd">    :param rules:           (list) rules</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">041</span>: <span class="sd">    :return:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">042</span>: <span class="sd">        head_pos            (pointer) position of head in buffer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">043</span>: <span class="sd">        tail_pos        (pointer) positions to be analysed</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">044</span>: <span class="sd">        buffer_length       (int) buffer length</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">045</span>: <span class="sd">        buffer_status       (pointer) list of array poistions in buffer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">046</span>: <span class="sd">        dim                 (pointer) dimensions of array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">047</span>: <span class="sd">        arr                 (2D pointer) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">048</span>: <span class="sd">        buf                 (3D pointer) buffer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">049</span>: <span class="sd">        dim                 (pointer) dimensions of array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">050</span>: <span class="sd">        arr                 (2D pointer) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">051</span>: <span class="sd">        buf                 (3D pointer) buffer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">052</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">053</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">buffer_length</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">054</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:]</span> <span class="n">head_position</span><span class="p">,</span> <span class="n">tail_position</span><span class="p">,</span> <span class="n">buffer_status</span></pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">055</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:]</span> <span class="n">dim_h</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">)</span></pre>
<pre class='cython code score-15 '>  <span class='trace'>__Pyx_TraceLine</span>(55,0,<span class='error_goto'>__PYX_ERR(0, 55, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 55, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_u_i);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dimensions);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dimensions);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_dimensions);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 55, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 55, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_dim_h = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">056</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:]</span> <span class="n">dim_t</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">)</span></pre>
<pre class='cython code score-15 '>  <span class='trace'>__Pyx_TraceLine</span>(56,0,<span class='error_goto'>__PYX_ERR(0, 56, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 56, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_u_i);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dimensions);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dimensions);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_dimensions);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 56, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 56, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dim_t = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">057</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">arr_h</span><span class="p">,</span> <span class="n">arr_t</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">058</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="n">buf_h</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">059</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">060</span>:     <span class="n">buffer_length</span> <span class="o">=</span> <span class="mf">10</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(60,0,<span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>)
  __pyx_v_buffer_length = 10;
</pre><pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">061</span>:     <span class="n">buffer_status</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">buffer_length</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">intc</span><span class="p">)</span></pre>
<pre class='cython code score-54 '>  <span class='trace'>__Pyx_TraceLine</span>(61,0,<span class='error_goto'>__PYX_ERR(0, 61, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 61, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 61, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_buffer_length);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 61, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 61, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 61, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_7 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
    PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_2, __pyx_t_6};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 61, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
    PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_2, __pyx_t_6};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 61, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else
  #endif
  {
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 61, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    if (__pyx_t_5) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_5); __pyx_t_5 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_7, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_7, __pyx_t_6);
    __pyx_t_2 = 0;
    __pyx_t_6 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 61, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 61, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_buffer_status = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">062</span>:     <span class="n">buffer_status</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(62,0,<span class='error_goto'>__PYX_ERR(0, 62, __pyx_L1_error)</span>)
  __pyx_t_9 = 0;
  __pyx_t_7 = -1;
  if (__pyx_t_9 &lt; 0) {
    __pyx_t_9 += __pyx_v_buffer_status.shape[0];
    if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_buffer_status.shape[0])) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 62, __pyx_L1_error)</span>
  }
  *((int *) ( /* dim=0 */ (__pyx_v_buffer_status.data + __pyx_t_9 * __pyx_v_buffer_status.strides[0]) )) = 1;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">063</span>:     <span class="n">head_position</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-23 '>  <span class='trace'>__Pyx_TraceLine</span>(63,0,<span class='error_goto'>__PYX_ERR(0, 63, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 63, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_0);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 63, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 63, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 63, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_head_position = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">064</span>:     <span class="n">tail_position</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-23 '>  <span class='trace'>__Pyx_TraceLine</span>(64,0,<span class='error_goto'>__PYX_ERR(0, 64, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 64, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_0);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 64, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 64, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 64, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_tail_position = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">065</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">066</span>:     <span class="n">buf_h</span> <span class="o">=</span> <span class="n">init_array_buffer</span><span class="p">(</span><span class="n">dim_h</span><span class="p">,</span> <span class="n">buffer_length</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(66,0,<span class='error_goto'>__PYX_ERR(0, 66, __pyx_L1_error)</span>)
  __pyx_t_10 = __pyx_f_6Cfuncs_init_array_buffer(__pyx_v_dim_h, __pyx_v_buffer_length, 0);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 66, __pyx_L1_error)</span>
  __pyx_v_buf_h = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">067</span>:     <span class="n">arr_h</span> <span class="o">=</span> <span class="n">buf_h</span><span class="p">[</span><span class="n">head_position</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">%</span> <span class="n">buffer_length</span><span class="p">]</span></pre>
<pre class='cython code score-12 '>  <span class='trace'>__Pyx_TraceLine</span>(67,0,<span class='error_goto'>__PYX_ERR(0, 67, __pyx_L1_error)</span>)
  __pyx_t_11 = 0;
  __pyx_t_7 = -1;
  if (__pyx_t_11 &lt; 0) {
    __pyx_t_11 += __pyx_v_head_position.shape[0];
    if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_head_position.shape[0])) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 67, __pyx_L1_error)</span>
  }
  __pyx_t_7 = (*((int *) ( /* dim=0 */ (__pyx_v_head_position.data + __pyx_t_11 * __pyx_v_head_position.strides[0]) )));
  if (unlikely(__pyx_v_buffer_length == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
    <span class='error_goto'>__PYX_ERR(0, 67, __pyx_L1_error)</span>
  }
  __pyx_t_12.data = __pyx_v_buf_h.data;
  __pyx_t_12.memview = __pyx_v_buf_h.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_12, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __Pyx_mod_int(__pyx_t_7, __pyx_v_buffer_length);
        Py_ssize_t __pyx_tmp_shape = __pyx_v_buf_h.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_buf_h.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 67, __pyx_L1_error)</span>
        }
        __pyx_t_12.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_12.shape[0] = __pyx_v_buf_h.shape[1];
__pyx_t_12.strides[0] = __pyx_v_buf_h.strides[1];
    __pyx_t_12.suboffsets[0] = -1;

__pyx_t_12.shape[1] = __pyx_v_buf_h.shape[2];
__pyx_t_12.strides[1] = __pyx_v_buf_h.strides[2];
    __pyx_t_12.suboffsets[1] = -1;

__pyx_v_arr_h = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">068</span>:     <span class="n">arr_t</span> <span class="o">=</span> <span class="n">buf_h</span><span class="p">[</span><span class="n">tail_position</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">%</span> <span class="n">buffer_length</span><span class="p">]</span></pre>
<pre class='cython code score-12 '>  <span class='trace'>__Pyx_TraceLine</span>(68,0,<span class='error_goto'>__PYX_ERR(0, 68, __pyx_L1_error)</span>)
  __pyx_t_13 = 0;
  __pyx_t_7 = -1;
  if (__pyx_t_13 &lt; 0) {
    __pyx_t_13 += __pyx_v_tail_position.shape[0];
    if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_tail_position.shape[0])) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 68, __pyx_L1_error)</span>
  }
  __pyx_t_7 = (*((int *) ( /* dim=0 */ (__pyx_v_tail_position.data + __pyx_t_13 * __pyx_v_tail_position.strides[0]) )));
  if (unlikely(__pyx_v_buffer_length == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
    <span class='error_goto'>__PYX_ERR(0, 68, __pyx_L1_error)</span>
  }
  __pyx_t_12.data = __pyx_v_buf_h.data;
  __pyx_t_12.memview = __pyx_v_buf_h.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_12, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __Pyx_mod_int(__pyx_t_7, __pyx_v_buffer_length);
        Py_ssize_t __pyx_tmp_shape = __pyx_v_buf_h.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_buf_h.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 68, __pyx_L1_error)</span>
        }
        __pyx_t_12.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_12.shape[0] = __pyx_v_buf_h.shape[1];
__pyx_t_12.strides[0] = __pyx_v_buf_h.strides[1];
    __pyx_t_12.suboffsets[0] = -1;

__pyx_t_12.shape[1] = __pyx_v_buf_h.shape[2];
__pyx_t_12.strides[1] = __pyx_v_buf_h.strides[2];
    __pyx_t_12.suboffsets[1] = -1;

__pyx_v_arr_t = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">069</span>: </pre>
<pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">070</span>:     <span class="n">cy</span><span class="o">.</span><span class="n">clear_array</span><span class="p">(</span><span class="n">dim_h</span><span class="p">,</span> <span class="n">arr_h</span><span class="p">)</span></pre>
<pre class='cython code score-45 '>  <span class='trace'>__Pyx_TraceLine</span>(70,0,<span class='error_goto'>__PYX_ERR(0, 70, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_cy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 70, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_clear_array);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 70, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_dim_h, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 70, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_arr_h, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 70, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      __pyx_t_7 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_8)) {
    PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_t_4, __pyx_t_6};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_8, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 70, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_8)) {
    PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_t_4, __pyx_t_6};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_8, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 70, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else
  #endif
  {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 70, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (__pyx_t_2) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_7, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_7, __pyx_t_6);
    __pyx_t_4 = 0;
    __pyx_t_6 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 70, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">071</span>:     <span class="n">advance_array</span><span class="p">(</span><span class="n">head_position</span><span class="p">,</span> <span class="n">buffer_length</span><span class="p">,</span> <span class="n">buf_h</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>  <span class='trace'>__Pyx_TraceLine</span>(71,0,<span class='error_goto'>__PYX_ERR(0, 71, __pyx_L1_error)</span>)
  __pyx_t_1 = __pyx_f_6Cfuncs_advance_array(__pyx_v_head_position, __pyx_v_buffer_length, __pyx_v_buf_h, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 71, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">072</span>:     <span class="n">arr_h</span> <span class="o">=</span> <span class="n">update_array_positions</span><span class="p">(</span><span class="n">head_position</span><span class="p">,</span> <span class="n">buffer_length</span><span class="p">,</span> <span class="n">buffer_status</span><span class="p">,</span></pre>
<pre class='cython code score-3 '>  <span class='trace'>__Pyx_TraceLine</span>(72,0,<span class='error_goto'>__PYX_ERR(0, 72, __pyx_L1_error)</span>)
  __pyx_t_14.__pyx_n = 1;
  __pyx_t_14.display = 0;
  __pyx_t_1 = __pyx_f_6Cfuncs_update_array_positions(__pyx_v_head_position, __pyx_v_buffer_length, __pyx_v_buffer_status, __pyx_v_buf_h, 0, &amp;__pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 72, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 72, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr_h, 1);
  __pyx_v_arr_h = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">073</span>:                                    <span class="n">buf_h</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">074</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">075</span>:     <span class="n">randomize_center</span><span class="p">(</span><span class="mf">7</span><span class="p">,</span> <span class="n">dim_h</span><span class="p">,</span> <span class="n">arr_h</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>  <span class='trace'>__Pyx_TraceLine</span>(75,0,<span class='error_goto'>__PYX_ERR(0, 75, __pyx_L1_error)</span>)
  __pyx_t_1 = __pyx_f_6Cfuncs_randomize_center(7, __pyx_v_dim_h, __pyx_v_arr_h, 0, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 75, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">076</span>:     <span class="n">advance_array</span><span class="p">(</span><span class="n">head_position</span><span class="p">,</span> <span class="n">buffer_length</span><span class="p">,</span> <span class="n">buf_h</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>  <span class='trace'>__Pyx_TraceLine</span>(76,0,<span class='error_goto'>__PYX_ERR(0, 76, __pyx_L1_error)</span>)
  __pyx_t_1 = __pyx_f_6Cfuncs_advance_array(__pyx_v_head_position, __pyx_v_buffer_length, __pyx_v_buf_h, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 76, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">077</span>:     <span class="n">arr_h</span> <span class="o">=</span> <span class="n">update_array_positions</span><span class="p">(</span><span class="n">head_position</span><span class="p">,</span> <span class="n">buffer_length</span><span class="p">,</span> <span class="n">buffer_status</span><span class="p">,</span></pre>
<pre class='cython code score-3 '>  <span class='trace'>__Pyx_TraceLine</span>(77,0,<span class='error_goto'>__PYX_ERR(0, 77, __pyx_L1_error)</span>)
  __pyx_t_14.__pyx_n = 1;
  __pyx_t_14.display = 0;
  __pyx_t_1 = __pyx_f_6Cfuncs_update_array_positions(__pyx_v_head_position, __pyx_v_buffer_length, __pyx_v_buffer_status, __pyx_v_buf_h, 0, &amp;__pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 77, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 77, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr_h, 1);
  __pyx_v_arr_h = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">078</span>:                                    <span class="n">buf_h</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">079</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">080</span>:     <span class="n">buffer_status</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2</span> <span class="c">#placing the tail in place</span></pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(80,0,<span class='error_goto'>__PYX_ERR(0, 80, __pyx_L1_error)</span>)
  __pyx_t_15 = 0;
  __pyx_t_7 = -1;
  if (__pyx_t_15 &lt; 0) {
    __pyx_t_15 += __pyx_v_buffer_status.shape[0];
    if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_buffer_status.shape[0])) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 80, __pyx_L1_error)</span>
  }
  *((int *) ( /* dim=0 */ (__pyx_v_buffer_status.data + __pyx_t_15 * __pyx_v_buffer_status.strides[0]) )) = 2;
</pre><pre class="cython line score-0">&#xA0;<span class="">081</span>: </pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">082</span>:     <span class="k">return</span> <span class="n">head_position</span><span class="p">,</span> <span class="n">tail_position</span><span class="p">,</span> <span class="n">buffer_length</span><span class="p">,</span> <span class="n">buffer_status</span><span class="p">,</span>\</pre>
<pre class='cython code score-18 '>  <span class='trace'>__Pyx_TraceLine</span>(82,0,<span class='error_goto'>__PYX_ERR(0, 82, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_head_position, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_tail_position, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_buffer_length);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_buffer_status, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(82,0,<span class='error_goto'>__PYX_ERR(0, 82, __pyx_L1_error)</span>)
  __pyx_t_20 = <span class='py_c_api'>PyTuple_New</span>(10);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 82, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 1, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 2, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 3, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 4, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 5, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_16);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 6, __pyx_t_16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_17);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 7, __pyx_t_17);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_18);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 8, __pyx_t_18);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 9, __pyx_t_19);
  __pyx_t_1 = 0;
  __pyx_t_8 = 0;
  __pyx_t_5 = 0;
  __pyx_t_6 = 0;
  __pyx_t_4 = 0;
  __pyx_t_2 = 0;
  __pyx_t_16 = 0;
  __pyx_t_17 = 0;
  __pyx_t_18 = 0;
  __pyx_t_19 = 0;
  __pyx_r = ((PyObject*)__pyx_t_20);
  __pyx_t_20 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">083</span>:             <span class="n">dim_t</span><span class="p">,</span> <span class="n">arr_t</span><span class="p">,</span> <span class="n">buf_h</span><span class="p">,</span> <span class="n">dim_h</span><span class="p">,</span> <span class="n">arr_h</span><span class="p">,</span> <span class="n">buf_h</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(83,0,<span class='error_goto'>__PYX_ERR(0, 83, __pyx_L1_error)</span>)
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_dim_t, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_arr_t, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_16 = __pyx_memoryview_fromslice(__pyx_v_buf_h, 3, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  __pyx_t_17 = __pyx_memoryview_fromslice(__pyx_v_dim_h, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  __pyx_t_18 = __pyx_memoryview_fromslice(__pyx_v_arr_h, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  __pyx_t_19 = __pyx_memoryview_fromslice(__pyx_v_buf_h, 3, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
</pre><pre class="cython line score-0">&#xA0;<span class="">084</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">085</span>: </pre>
<pre class="cython line score-122" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">086</span>: <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">basic_update</span><span class="p">(</span></pre>
<pre class='cython code score-122 '>static PyObject *__pyx_pw_6Cfuncs_5basic_update(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static void __pyx_f_6Cfuncs_basic_update(float __pyx_v_updates, float __pyx_v_beta, float __pyx_v_threshold, __Pyx_memviewslice __pyx_v_rule, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_6Cfuncs_basic_update *__pyx_optional_args) {
  __Pyx_memviewslice __pyx_v_bounds = __pyx_k_;
  __Pyx_memviewslice __pyx_v_bars = __pyx_k__2;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("basic_update", 0);
  <span class='trace'>__Pyx_TraceCall</span>("basic_update", __pyx_f[0], 86, 0, <span class='error_goto'>__PYX_ERR(0, 86, __pyx_L1_error)</span>);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_bounds = __pyx_optional_args-&gt;bounds;
      if (__pyx_optional_args-&gt;__pyx_n &gt; 1) {
        __pyx_v_bars = __pyx_optional_args-&gt;bars;
      }
    }
  }
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("Cfuncs.basic_update", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_5basic_update(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_4basic_update[] = "\n    Performs the basic update\n\n    :param updates:     (float) ising updates (as percentage of all positions, 0 is off)\n    :param beta:        (float) inverse temperature\n    :param threshold:   (float) noise threshold     (1 is off)\n    :param rule:        (pointer) conway rule       (rule[0] == -1 is off)\n    :param dim:         (pointer) arr dimensions\n    :param arr:         (2D pointer) array\n    :param bounds:      (pointer) boundary values   (-1 is off)\n    :param bars:        [start, width, step, axis, bounce, polarity (-1 is off)]\n    :return:            None\n    ";
static PyObject *__pyx_pw_6Cfuncs_5basic_update(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  float __pyx_v_updates;
  float __pyx_v_beta;
  float __pyx_v_threshold;
  __Pyx_memviewslice __pyx_v_rule = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_bounds = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_bars = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("basic_update (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_updates,&amp;__pyx_n_s_beta,&amp;__pyx_n_s_threshold,&amp;__pyx_n_s_rule,&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,&amp;__pyx_n_s_bounds,&amp;__pyx_n_s_bars,0};
    PyObject* values[8] = {0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_updates)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_beta)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("basic_update", 0, 6, 8, 1); <span class='error_goto'>__PYX_ERR(0, 86, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_threshold)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("basic_update", 0, 6, 8, 2); <span class='error_goto'>__PYX_ERR(0, 86, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_rule)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("basic_update", 0, 6, 8, 3); <span class='error_goto'>__PYX_ERR(0, 86, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("basic_update", 0, 6, 8, 4); <span class='error_goto'>__PYX_ERR(0, 86, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("basic_update", 0, 6, 8, 5); <span class='error_goto'>__PYX_ERR(0, 86, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bounds);
          if (value) { values[6] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bars);
          if (value) { values[7] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "basic_update") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 86, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_updates = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[0]); if (unlikely((__pyx_v_updates == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 87, __pyx_L3_error)</span>
    __pyx_v_beta = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[1]); if (unlikely((__pyx_v_beta == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 87, __pyx_L3_error)</span>
    __pyx_v_threshold = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[2]); if (unlikely((__pyx_v_threshold == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 88, __pyx_L3_error)</span>
    __pyx_v_rule = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_rule.memview)) __PYX_ERR(0, 89, __pyx_L3_error)</span>
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[4], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 89, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_int</span>(values[5], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 89, __pyx_L3_error)</span>
    if (values[6]) {
      __pyx_v_bounds = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[6], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_bounds.memview)) __PYX_ERR(0, 90, __pyx_L3_error)</span>
    } else {
      __pyx_v_bounds = __pyx_k_;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_bounds, 1);
    }
    if (values[7]) {
      __pyx_v_bars = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[7], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_bars.memview)) __PYX_ERR(0, 91, __pyx_L3_error)</span>
    } else {
      __pyx_v_bars = __pyx_k__2;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_bars, 1);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("basic_update", 0, 6, 8, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 86, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.basic_update", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_4basic_update(__pyx_self, __pyx_v_updates, __pyx_v_beta, __pyx_v_threshold, __pyx_v_rule, __pyx_v_dim, __pyx_v_arr, __pyx_v_bounds, __pyx_v_bars);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_4basic_update(CYTHON_UNUSED PyObject *__pyx_self, float __pyx_v_updates, float __pyx_v_beta, float __pyx_v_threshold, __Pyx_memviewslice __pyx_v_rule, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, __Pyx_memviewslice __pyx_v_bounds, __Pyx_memviewslice __pyx_v_bars) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("basic_update", 0);
  <span class='trace'>__Pyx_TraceCall</span>("basic_update (wrapper)", __pyx_f[0], 86, 0, <span class='error_goto'>__PYX_ERR(0, 86, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_rule.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("rule"); <span class='error_goto'>__PYX_ERR(0, 86, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 86, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 86, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_bounds.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("bounds"); <span class='error_goto'>__PYX_ERR(0, 86, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_bars.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("bars"); <span class='error_goto'>__PYX_ERR(0, 86, __pyx_L1_error)</span> }
  __pyx_t_1.__pyx_n = 2;
  __pyx_t_1.bounds = __pyx_v_bounds;
  __pyx_t_1.bars = __pyx_v_bars;
  __pyx_f_6Cfuncs_basic_update(__pyx_v_updates, __pyx_v_beta, __pyx_v_threshold, __pyx_v_rule, __pyx_v_dim, __pyx_v_arr, 0, &amp;__pyx_t_1); 
  __pyx_t_2 = __Pyx_void_to_None(NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 86, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.basic_update", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_rule, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bounds, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bars, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_opt_args_6Cfuncs_basic_update {
  int __pyx_n;
  __Pyx_memviewslice bounds;
  __Pyx_memviewslice bars;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">087</span>:     <span class="nb">float</span> <span class="n">updates</span><span class="p">,</span> <span class="nb">float</span> <span class="n">beta</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">088</span>:     <span class="nb">float</span> <span class="n">threshold</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">089</span>:     <span class="nb">int</span><span class="p">[:]</span> <span class="n">rule</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">arr</span><span class="p">,</span></pre>
<pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">090</span>:     <span class="nb">int</span><span class="p">[:]</span> <span class="n">bounds</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">]),</span></pre>
<pre class='cython code score-54 '>  <span class='trace'>__Pyx_TraceLine</span>(90,0,<span class='error_goto'>__PYX_ERR(0, 90, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 90, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_neg_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_neg_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_neg_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, __pyx_int_neg_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 90, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 90, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 90, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_k_ = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(90,0,<span class='error_goto'>__PYX_ERR(0, 90, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 90, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_int_neg_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_neg_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_neg_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 3, __pyx_int_neg_1);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 90, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 90, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 90, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_k_ = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-94" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">091</span>:     <span class="n">double</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">bars</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">]],</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">),</span></pre>
<pre class='cython code score-94 '>  <span class='trace'>__Pyx_TraceLine</span>(91,0,<span class='error_goto'>__PYX_ERR(0, 91, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 4, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 5, __pyx_int_neg_1);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_5);
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_k__2 = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(91,0,<span class='error_goto'>__PYX_ERR(0, 91, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 3, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 4, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 5, __pyx_int_neg_1);
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_k__2 = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">092</span>: <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">093</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">094</span>: <span class="sd">    Performs the basic update</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">095</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">096</span>: <span class="sd">    :param updates:     (float) ising updates (as percentage of all positions, 0 is off)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">097</span>: <span class="sd">    :param beta:        (float) inverse temperature</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">098</span>: <span class="sd">    :param threshold:   (float) noise threshold     (1 is off)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">099</span>: <span class="sd">    :param rule:        (pointer) conway rule       (rule[0] == -1 is off)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">100</span>: <span class="sd">    :param dim:         (pointer) arr dimensions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">101</span>: <span class="sd">    :param arr:         (2D pointer) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">102</span>: <span class="sd">    :param bounds:      (pointer) boundary values   (-1 is off)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">103</span>: <span class="sd">    :param bars:        [start, width, step, axis, bounce, polarity (-1 is off)]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">104</span>: <span class="sd">    :return:            None</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">105</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">106</span>:     <span class="n">ising_process</span><span class="p">(</span><span class="n">updates</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>  <span class='trace'>__Pyx_TraceLine</span>(106,0,<span class='error_goto'>__PYX_ERR(0, 106, __pyx_L1_error)</span>)
  __pyx_t_1 = __pyx_f_6Cfuncs_ising_process(__pyx_v_updates, __pyx_v_beta, __pyx_v_dim, __pyx_v_arr, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 106, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">107</span>:     <span class="n">add_stochastic_noise</span><span class="p">(</span><span class="n">threshold</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>  <span class='trace'>__Pyx_TraceLine</span>(107,0,<span class='error_goto'>__PYX_ERR(0, 107, __pyx_L1_error)</span>)
  __pyx_t_1 = __pyx_f_6Cfuncs_add_stochastic_noise(__pyx_v_threshold, __pyx_v_dim, __pyx_v_arr, 0, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">108</span>:     <span class="n">cy</span><span class="o">.</span><span class="n">set_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mf">2</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mf">3</span><span class="p">],</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-73 '>  <span class='trace'>__Pyx_TraceLine</span>(108,0,<span class='error_goto'>__PYX_ERR(0, 108, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_cy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_set_bounds);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_bounds.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_bounds.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 108, __pyx_L1_error)</span>
  }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_bounds.data + __pyx_t_4 * __pyx_v_bounds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = 1;
  __pyx_t_5 = -1;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_bounds.shape[0];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_bounds.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 108, __pyx_L1_error)</span>
  }
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_bounds.data + __pyx_t_6 * __pyx_v_bounds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_8 = 2;
  __pyx_t_5 = -1;
  if (__pyx_t_8 &lt; 0) {
    __pyx_t_8 += __pyx_v_bounds.shape[0];
    if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_bounds.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 108, __pyx_L1_error)</span>
  }
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_bounds.data + __pyx_t_8 * __pyx_v_bounds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_10 = 3;
  __pyx_t_5 = -1;
  if (__pyx_t_10 &lt; 0) {
    __pyx_t_10 += __pyx_v_bounds.shape[0];
    if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_bounds.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 108, __pyx_L1_error)</span>
  }
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_bounds.data + __pyx_t_10 * __pyx_v_bounds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_12 = __pyx_memoryview_fromslice(__pyx_v_dim, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_v_arr, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_14 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_14)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_5 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[7] = {__pyx_t_14, __pyx_t_2, __pyx_t_7, __pyx_t_9, __pyx_t_11, __pyx_t_12, __pyx_t_13};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 6+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[7] = {__pyx_t_14, __pyx_t_2, __pyx_t_7, __pyx_t_9, __pyx_t_11, __pyx_t_12, __pyx_t_13};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 6+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  } else
  #endif
  {
    __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(6+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
    if (__pyx_t_14) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_14); __pyx_t_14 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0+__pyx_t_5, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 1+__pyx_t_5, __pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 2+__pyx_t_5, __pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 3+__pyx_t_5, __pyx_t_11);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 4+__pyx_t_5, __pyx_t_12);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 5+__pyx_t_5, __pyx_t_13);
    __pyx_t_2 = 0;
    __pyx_t_7 = 0;
    __pyx_t_9 = 0;
    __pyx_t_11 = 0;
    __pyx_t_12 = 0;
    __pyx_t_13 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_15, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">109</span>:     <span class="n">cy</span><span class="o">.</span><span class="n">scroll_bars</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">bars</span><span class="p">)</span></pre>
<pre class='cython code score-48 '>  <span class='trace'>__Pyx_TraceLine</span>(109,0,<span class='error_goto'>__PYX_ERR(0, 109, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_cy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 109, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_scroll_bars);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 109, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_dim, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 109, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_v_arr, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 109, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_12 = __pyx_memoryview_fromslice(__pyx_v_bars, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 109, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_11 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_15))) {
    __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_15);
    if (likely(__pyx_t_11)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_15, function);
      __pyx_t_5 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_15)) {
    PyObject *__pyx_temp[4] = {__pyx_t_11, __pyx_t_3, __pyx_t_13, __pyx_t_12};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_15, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 109, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_15)) {
    PyObject *__pyx_temp[4] = {__pyx_t_11, __pyx_t_3, __pyx_t_13, __pyx_t_12};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_15, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 109, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  } else
  #endif
  {
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 109, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (__pyx_t_11) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_11); __pyx_t_11 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_5, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_5, __pyx_t_13);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2+__pyx_t_5, __pyx_t_12);
    __pyx_t_3 = 0;
    __pyx_t_13 = 0;
    __pyx_t_12 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_15, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 109, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">110</span>:     <span class="n">conway_process</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(110,0,<span class='error_goto'>__PYX_ERR(0, 110, __pyx_L1_error)</span>)
  __pyx_f_6Cfuncs_conway_process(__pyx_v_rule, __pyx_v_dim, __pyx_v_arr, 0);
</pre><pre class="cython line score-0">&#xA0;<span class="">111</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">112</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">113</span>: <span class="c"># A real hero would make this a decorator</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">114</span>: <span class="c"># Same for all the other small changes!</span></pre>
<pre class="cython line score-163" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">115</span>: <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">basic_update_buffer</span><span class="p">(</span></pre>
<pre class='cython code score-163 '>static PyObject *__pyx_pw_6Cfuncs_7basic_update_buffer(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static void __pyx_f_6Cfuncs_basic_update_buffer(float __pyx_v_updates, float __pyx_v_beta, float __pyx_v_threshold, __Pyx_memviewslice __pyx_v_rules, __Pyx_memviewslice __pyx_v_frame, int __pyx_v_buffer_length, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, __Pyx_memviewslice __pyx_v_buf, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_6Cfuncs_basic_update_buffer *__pyx_optional_args) {
  __Pyx_memviewslice __pyx_v_bounds = __pyx_k__3;
  __Pyx_memviewslice __pyx_v_bars = __pyx_k__4;
  __Pyx_memviewslice __pyx_v_fuzz = __pyx_k__5;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("basic_update_buffer", 0);
  <span class='trace'>__Pyx_TraceCall</span>("basic_update_buffer", __pyx_f[0], 115, 0, <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L1_error)</span>);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_bounds = __pyx_optional_args-&gt;bounds;
      if (__pyx_optional_args-&gt;__pyx_n &gt; 1) {
        __pyx_v_bars = __pyx_optional_args-&gt;bars;
        if (__pyx_optional_args-&gt;__pyx_n &gt; 2) {
          __pyx_v_fuzz = __pyx_optional_args-&gt;fuzz;
        }
      }
    }
  }
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("Cfuncs.basic_update_buffer", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_7basic_update_buffer(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_6basic_update_buffer[] = "\n    Performs the basic update, including advancing the array in the buffer.\n    Doesnt update your pointers though.\n\n    :param updates:     (float) ising updates (as percentage of all positions, 0 is off)\n    :param beta:        (float) inverse temperature\n    :param threshold:   (float) noise threshold     (1 is off)\n    :param rule:        (pointer) conway rule       (rule[0] == -1 is off)\n    :param frame:\n    :param buffer_length:\n    :param dim:         (pointer) arr dimensions\n    :param arr:         (2D pointer) array\n    :param buf:         (3D pointer) array buffer\n    :param bounds:      (pointer) boundary values   (-1 is off)\n    :param bars:        [start, width, step, axis, bounce, polarity (-1 is off)]\n    :param fuzz:        [start, width, step, axis, bounce, coverage, polarity (-2 is off)]\n    :return:            None\n    ";
static PyObject *__pyx_pw_6Cfuncs_7basic_update_buffer(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  float __pyx_v_updates;
  float __pyx_v_beta;
  float __pyx_v_threshold;
  __Pyx_memviewslice __pyx_v_rules = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_frame = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_buffer_length;
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_buf = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_bounds = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_bars = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_fuzz = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("basic_update_buffer (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_updates,&amp;__pyx_n_s_beta,&amp;__pyx_n_s_threshold,&amp;__pyx_n_s_rules,&amp;__pyx_n_s_frame,&amp;__pyx_n_s_buffer_length,&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,&amp;__pyx_n_s_buf,&amp;__pyx_n_s_bounds,&amp;__pyx_n_s_bars,&amp;__pyx_n_s_fuzz,0};
    PyObject* values[12] = {0,0,0,0,0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case 12: values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_updates)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_beta)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("basic_update_buffer", 0, 9, 12, 1); <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_threshold)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("basic_update_buffer", 0, 9, 12, 2); <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_rules)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("basic_update_buffer", 0, 9, 12, 3); <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_frame)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("basic_update_buffer", 0, 9, 12, 4); <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_buffer_length)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("basic_update_buffer", 0, 9, 12, 5); <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("basic_update_buffer", 0, 9, 12, 6); <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("basic_update_buffer", 0, 9, 12, 7); <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (likely((values[8] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_buf)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("basic_update_buffer", 0, 9, 12, 8); <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bounds);
          if (value) { values[9] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bars);
          if (value) { values[10] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_fuzz);
          if (value) { values[11] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "basic_update_buffer") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case 12: values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_updates = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[0]); if (unlikely((__pyx_v_updates == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 116, __pyx_L3_error)</span>
    __pyx_v_beta = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[1]); if (unlikely((__pyx_v_beta == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 116, __pyx_L3_error)</span>
    __pyx_v_threshold = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[2]); if (unlikely((__pyx_v_threshold == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 117, __pyx_L3_error)</span>
    __pyx_v_rules = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_rules.memview)) __PYX_ERR(0, 118, __pyx_L3_error)</span>
    __pyx_v_frame = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[4], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_frame.memview)) __PYX_ERR(0, 118, __pyx_L3_error)</span>
    __pyx_v_buffer_length = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[5]); if (unlikely((__pyx_v_buffer_length == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 118, __pyx_L3_error)</span>
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[6], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 119, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_int</span>(values[7], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 119, __pyx_L3_error)</span>
    __pyx_v_buf = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(values[8], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_buf.memview)) __PYX_ERR(0, 119, __pyx_L3_error)</span>
    if (values[9]) {
      __pyx_v_bounds = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[9], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_bounds.memview)) __PYX_ERR(0, 120, __pyx_L3_error)</span>
    } else {
      __pyx_v_bounds = __pyx_k__3;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_bounds, 1);
    }
    if (values[10]) {
      __pyx_v_bars = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[10], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_bars.memview)) __PYX_ERR(0, 121, __pyx_L3_error)</span>
    } else {
      __pyx_v_bars = __pyx_k__4;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_bars, 1);
    }
    if (values[11]) {
      __pyx_v_fuzz = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[11], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_fuzz.memview)) __PYX_ERR(0, 122, __pyx_L3_error)</span>
    } else {
      __pyx_v_fuzz = __pyx_k__5;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_fuzz, 1);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("basic_update_buffer", 0, 9, 12, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.basic_update_buffer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_6basic_update_buffer(__pyx_self, __pyx_v_updates, __pyx_v_beta, __pyx_v_threshold, __pyx_v_rules, __pyx_v_frame, __pyx_v_buffer_length, __pyx_v_dim, __pyx_v_arr, __pyx_v_buf, __pyx_v_bounds, __pyx_v_bars, __pyx_v_fuzz);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_6basic_update_buffer(CYTHON_UNUSED PyObject *__pyx_self, float __pyx_v_updates, float __pyx_v_beta, float __pyx_v_threshold, __Pyx_memviewslice __pyx_v_rules, __Pyx_memviewslice __pyx_v_frame, int __pyx_v_buffer_length, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, __Pyx_memviewslice __pyx_v_buf, __Pyx_memviewslice __pyx_v_bounds, __Pyx_memviewslice __pyx_v_bars, __Pyx_memviewslice __pyx_v_fuzz) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("basic_update_buffer", 0);
  <span class='trace'>__Pyx_TraceCall</span>("basic_update_buffer (wrapper)", __pyx_f[0], 115, 0, <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_rules.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("rules"); <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_frame.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("frame"); <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_buf.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("buf"); <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_bounds.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("bounds"); <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_bars.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("bars"); <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_fuzz.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("fuzz"); <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L1_error)</span> }
  __pyx_t_1.__pyx_n = 3;
  __pyx_t_1.bounds = __pyx_v_bounds;
  __pyx_t_1.bars = __pyx_v_bars;
  __pyx_t_1.fuzz = __pyx_v_fuzz;
  __pyx_f_6Cfuncs_basic_update_buffer(__pyx_v_updates, __pyx_v_beta, __pyx_v_threshold, __pyx_v_rules, __pyx_v_frame, __pyx_v_buffer_length, __pyx_v_dim, __pyx_v_arr, __pyx_v_buf, 0, &amp;__pyx_t_1); 
  __pyx_t_2 = __Pyx_void_to_None(NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 115, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.basic_update_buffer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_rules, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_frame, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_buf, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bounds, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bars, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_fuzz, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_opt_args_6Cfuncs_basic_update_buffer {
  int __pyx_n;
  __Pyx_memviewslice bounds;
  __Pyx_memviewslice bars;
  __Pyx_memviewslice fuzz;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">116</span>:     <span class="nb">float</span> <span class="n">updates</span><span class="p">,</span> <span class="nb">float</span> <span class="n">beta</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">117</span>:     <span class="nb">float</span> <span class="n">threshold</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">118</span>:     <span class="nb">int</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">rules</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">frame</span><span class="p">,</span> <span class="nb">int</span> <span class="n">buffer_length</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">119</span>:     <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">arr</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="n">buf</span><span class="p">,</span></pre>
<pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">120</span>:     <span class="nb">int</span><span class="p">[:]</span> <span class="n">bounds</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">]),</span></pre>
<pre class='cython code score-54 '>  <span class='trace'>__Pyx_TraceLine</span>(120,0,<span class='error_goto'>__PYX_ERR(0, 120, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_neg_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_neg_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_neg_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 3, __pyx_int_neg_1);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_k__3 = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(120,0,<span class='error_goto'>__PYX_ERR(0, 120, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_neg_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_neg_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_neg_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, __pyx_int_neg_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_k__3 = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-94" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">121</span>:     <span class="n">double</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">bars</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">]],</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">),</span></pre>
<pre class='cython code score-94 '>  <span class='trace'>__Pyx_TraceLine</span>(121,0,<span class='error_goto'>__PYX_ERR(0, 121, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 3, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 4, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 5, __pyx_int_neg_1);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_2);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k__4 = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(121,0,<span class='error_goto'>__PYX_ERR(0, 121, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 4, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 5, __pyx_int_neg_1);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_5);
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_k__4 = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-98" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">122</span>:     <span class="n">double</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">fuzz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">2</span><span class="p">]],</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">),</span></pre>
<pre class='cython code score-98 '>  <span class='trace'>__Pyx_TraceLine</span>(122,0,<span class='error_goto'>__PYX_ERR(0, 122, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 2, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 3, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 4, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_0_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_0_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 5, __pyx_float_0_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 6, __pyx_int_neg_2);
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
  __pyx_t_5 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_k__5 = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(122,0,<span class='error_goto'>__PYX_ERR(0, 122, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 3, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 4, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_0_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_0_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 5, __pyx_float_0_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 6, __pyx_int_neg_2);
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_k__5 = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">123</span>: <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">124</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">125</span>: <span class="sd">    Performs the basic update, including advancing the array in the buffer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">126</span>: <span class="sd">    Doesnt update your pointers though.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">127</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">128</span>: <span class="sd">    :param updates:     (float) ising updates (as percentage of all positions, 0 is off)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">129</span>: <span class="sd">    :param beta:        (float) inverse temperature</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">130</span>: <span class="sd">    :param threshold:   (float) noise threshold     (1 is off)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">131</span>: <span class="sd">    :param rule:        (pointer) conway rule       (rule[0] == -1 is off)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">132</span>: <span class="sd">    :param frame:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">133</span>: <span class="sd">    :param buffer_length:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">134</span>: <span class="sd">    :param dim:         (pointer) arr dimensions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">135</span>: <span class="sd">    :param arr:         (2D pointer) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">136</span>: <span class="sd">    :param buf:         (3D pointer) array buffer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">137</span>: <span class="sd">    :param bounds:      (pointer) boundary values   (-1 is off)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">138</span>: <span class="sd">    :param bars:        [start, width, step, axis, bounce, polarity (-1 is off)]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">139</span>: <span class="sd">    :param fuzz:        [start, width, step, axis, bounce, coverage, polarity (-2 is off)]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">140</span>: <span class="sd">    :return:            None</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">141</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">142</span>:     <span class="n">ising_process</span><span class="p">(</span><span class="n">updates</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>  <span class='trace'>__Pyx_TraceLine</span>(142,0,<span class='error_goto'>__PYX_ERR(0, 142, __pyx_L1_error)</span>)
  __pyx_t_1 = __pyx_f_6Cfuncs_ising_process(__pyx_v_updates, __pyx_v_beta, __pyx_v_dim, __pyx_v_arr, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 142, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">143</span>:     <span class="n">add_stochastic_noise</span><span class="p">(</span><span class="n">threshold</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>  <span class='trace'>__Pyx_TraceLine</span>(143,0,<span class='error_goto'>__PYX_ERR(0, 143, __pyx_L1_error)</span>)
  __pyx_t_1 = __pyx_f_6Cfuncs_add_stochastic_noise(__pyx_v_threshold, __pyx_v_dim, __pyx_v_arr, 0, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 143, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">144</span>:     <span class="n">cy</span><span class="o">.</span><span class="n">set_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mf">2</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mf">3</span><span class="p">],</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-73 '>  <span class='trace'>__Pyx_TraceLine</span>(144,0,<span class='error_goto'>__PYX_ERR(0, 144, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_cy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 144, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_set_bounds);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 144, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_bounds.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_bounds.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 144, __pyx_L1_error)</span>
  }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_bounds.data + __pyx_t_4 * __pyx_v_bounds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 144, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = 1;
  __pyx_t_5 = -1;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_bounds.shape[0];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_bounds.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 144, __pyx_L1_error)</span>
  }
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_bounds.data + __pyx_t_6 * __pyx_v_bounds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 144, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_8 = 2;
  __pyx_t_5 = -1;
  if (__pyx_t_8 &lt; 0) {
    __pyx_t_8 += __pyx_v_bounds.shape[0];
    if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_bounds.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 144, __pyx_L1_error)</span>
  }
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_bounds.data + __pyx_t_8 * __pyx_v_bounds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 144, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_10 = 3;
  __pyx_t_5 = -1;
  if (__pyx_t_10 &lt; 0) {
    __pyx_t_10 += __pyx_v_bounds.shape[0];
    if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_bounds.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 144, __pyx_L1_error)</span>
  }
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_bounds.data + __pyx_t_10 * __pyx_v_bounds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 144, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_12 = __pyx_memoryview_fromslice(__pyx_v_dim, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 144, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_v_arr, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 144, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_14 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_14)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_5 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[7] = {__pyx_t_14, __pyx_t_2, __pyx_t_7, __pyx_t_9, __pyx_t_11, __pyx_t_12, __pyx_t_13};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 6+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 144, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[7] = {__pyx_t_14, __pyx_t_2, __pyx_t_7, __pyx_t_9, __pyx_t_11, __pyx_t_12, __pyx_t_13};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 6+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 144, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  } else
  #endif
  {
    __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(6+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 144, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
    if (__pyx_t_14) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_14); __pyx_t_14 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0+__pyx_t_5, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 1+__pyx_t_5, __pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 2+__pyx_t_5, __pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 3+__pyx_t_5, __pyx_t_11);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 4+__pyx_t_5, __pyx_t_12);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 5+__pyx_t_5, __pyx_t_13);
    __pyx_t_2 = 0;
    __pyx_t_7 = 0;
    __pyx_t_9 = 0;
    __pyx_t_11 = 0;
    __pyx_t_12 = 0;
    __pyx_t_13 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_15, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 144, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">145</span>:     <span class="n">cy</span><span class="o">.</span><span class="n">scroll_bars</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">bars</span><span class="p">)</span></pre>
<pre class='cython code score-48 '>  <span class='trace'>__Pyx_TraceLine</span>(145,0,<span class='error_goto'>__PYX_ERR(0, 145, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_cy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_scroll_bars);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_dim, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_v_arr, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_12 = __pyx_memoryview_fromslice(__pyx_v_bars, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_11 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_15))) {
    __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_15);
    if (likely(__pyx_t_11)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_15, function);
      __pyx_t_5 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_15)) {
    PyObject *__pyx_temp[4] = {__pyx_t_11, __pyx_t_3, __pyx_t_13, __pyx_t_12};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_15, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_15)) {
    PyObject *__pyx_temp[4] = {__pyx_t_11, __pyx_t_3, __pyx_t_13, __pyx_t_12};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_15, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  } else
  #endif
  {
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (__pyx_t_11) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_11); __pyx_t_11 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_5, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_5, __pyx_t_13);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2+__pyx_t_5, __pyx_t_12);
    __pyx_t_3 = 0;
    __pyx_t_13 = 0;
    __pyx_t_12 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_15, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">146</span>:     <span class="n">scroll_noise</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">fuzz</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(146,0,<span class='error_goto'>__PYX_ERR(0, 146, __pyx_L1_error)</span>)
  __pyx_t_16.__pyx_n = 1;
  __pyx_t_16.bars = __pyx_v_fuzz;
  __pyx_f_6Cfuncs_scroll_noise(__pyx_v_dim, __pyx_v_arr, 0, &amp;__pyx_t_16); 
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">147</span>:     <span class="n">conway_process</span><span class="p">(</span><span class="n">prepair_rule</span><span class="p">(</span><span class="n">rules</span><span class="p">,</span> <span class="n">frame</span><span class="p">),</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(147,0,<span class='error_goto'>__PYX_ERR(0, 147, __pyx_L1_error)</span>)
  __pyx_t_17 = __pyx_f_6Cfuncs_prepair_rule(__pyx_v_rules, __pyx_v_frame, 0);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 147, __pyx_L1_error)</span>
  __pyx_f_6Cfuncs_conway_process(__pyx_t_17, __pyx_v_dim, __pyx_v_arr, 0);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
  __pyx_t_17.memview = NULL;
  __pyx_t_17.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">148</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">149</span>:     <span class="n">advance_array</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">buffer_length</span><span class="p">,</span> <span class="n">buf</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>  <span class='trace'>__Pyx_TraceLine</span>(149,0,<span class='error_goto'>__PYX_ERR(0, 149, __pyx_L1_error)</span>)
  __pyx_t_1 = __pyx_f_6Cfuncs_advance_array(__pyx_v_frame, __pyx_v_buffer_length, __pyx_v_buf, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">150</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">151</span>: </pre>
<pre class="cython line score-75" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">152</span>: <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">basic_print</span><span class="p">(</span></pre>
<pre class='cython code score-75 '>static PyObject *__pyx_pw_6Cfuncs_9basic_print(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static void __pyx_f_6Cfuncs_basic_print(__Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_6Cfuncs_basic_print *__pyx_optional_args) {
  __Pyx_memviewslice __pyx_v_bounds = __pyx_k__6;
  __Pyx_memviewslice __pyx_v_bars = __pyx_k__7;
  __Pyx_memviewslice __pyx_v_fuzz = __pyx_k__8;
  PyObject *__pyx_v_temp = NULL;
  PyObject *__pyx_v_out = NULL;
  Py_ssize_t __pyx_v_i;
  Py_ssize_t __pyx_v_j;
  PyObject *__pyx_v_fin = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("basic_print", 0);
  <span class='trace'>__Pyx_TraceCall</span>("basic_print", __pyx_f[0], 152, 0, <span class='error_goto'>__PYX_ERR(0, 152, __pyx_L1_error)</span>);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_bounds = __pyx_optional_args-&gt;bounds;
      if (__pyx_optional_args-&gt;__pyx_n &gt; 1) {
        __pyx_v_bars = __pyx_optional_args-&gt;bars;
        if (__pyx_optional_args-&gt;__pyx_n &gt; 2) {
          __pyx_v_fuzz = __pyx_optional_args-&gt;fuzz;
        }
      }
    }
  }
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("Cfuncs.basic_print", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_temp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_fin);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_9basic_print(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_8basic_print[] = "\n    Performs a basic print after adding back the bars etc. as reference.\n    This means the bars and bounds are avoided in the calculation.\n\n    :param dim:         (pointer) arr dimensions\n    :param arr:         (2D pointer) array\n    :param bounds:      (pointer) boundary values   (-1 is off)\n    :param bars:        [start, width, step, axis, bounce, polarity (-1 is off)]\n    :param fuzz:        [start, width, step, axis, bounce, coverage, polarity (-2 is off)]\n    :return:            None\n    ";
static PyObject *__pyx_pw_6Cfuncs_9basic_print(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_bounds = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_bars = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_fuzz = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("basic_print (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,&amp;__pyx_n_s_bounds,&amp;__pyx_n_s_bars,&amp;__pyx_n_s_fuzz,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("basic_print", 0, 2, 5, 1); <span class='error_goto'>__PYX_ERR(0, 152, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bounds);
          if (value) { values[2] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bars);
          if (value) { values[3] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_fuzz);
          if (value) { values[4] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "basic_print") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 152, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 153, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 153, __pyx_L3_error)</span>
    if (values[2]) {
      __pyx_v_bounds = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_bounds.memview)) __PYX_ERR(0, 154, __pyx_L3_error)</span>
    } else {
      __pyx_v_bounds = __pyx_k__6;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_bounds, 1);
    }
    if (values[3]) {
      __pyx_v_bars = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_bars.memview)) __PYX_ERR(0, 155, __pyx_L3_error)</span>
    } else {
      __pyx_v_bars = __pyx_k__7;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_bars, 1);
    }
    if (values[4]) {
      __pyx_v_fuzz = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[4], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_fuzz.memview)) __PYX_ERR(0, 156, __pyx_L3_error)</span>
    } else {
      __pyx_v_fuzz = __pyx_k__8;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_fuzz, 1);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("basic_print", 0, 2, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 152, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.basic_print", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_8basic_print(__pyx_self, __pyx_v_dim, __pyx_v_arr, __pyx_v_bounds, __pyx_v_bars, __pyx_v_fuzz);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_8basic_print(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, __Pyx_memviewslice __pyx_v_bounds, __Pyx_memviewslice __pyx_v_bars, __Pyx_memviewslice __pyx_v_fuzz) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("basic_print", 0);
  <span class='trace'>__Pyx_TraceCall</span>("basic_print (wrapper)", __pyx_f[0], 152, 0, <span class='error_goto'>__PYX_ERR(0, 152, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 152, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 152, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_bounds.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("bounds"); <span class='error_goto'>__PYX_ERR(0, 152, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_bars.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("bars"); <span class='error_goto'>__PYX_ERR(0, 152, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_fuzz.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("fuzz"); <span class='error_goto'>__PYX_ERR(0, 152, __pyx_L1_error)</span> }
  __pyx_t_1.__pyx_n = 3;
  __pyx_t_1.bounds = __pyx_v_bounds;
  __pyx_t_1.bars = __pyx_v_bars;
  __pyx_t_1.fuzz = __pyx_v_fuzz;
  __pyx_f_6Cfuncs_basic_print(__pyx_v_dim, __pyx_v_arr, 0, &amp;__pyx_t_1); 
  __pyx_t_2 = __Pyx_void_to_None(NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 152, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.basic_print", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bounds, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bars, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_fuzz, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_opt_args_6Cfuncs_basic_print {
  int __pyx_n;
  __Pyx_memviewslice bounds;
  __Pyx_memviewslice bars;
  __Pyx_memviewslice fuzz;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">153</span>:     <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">arr</span><span class="p">,</span></pre>
<pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">154</span>:     <span class="nb">int</span><span class="p">[:]</span> <span class="n">bounds</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">]),</span></pre>
<pre class='cython code score-54 '>  <span class='trace'>__Pyx_TraceLine</span>(154,0,<span class='error_goto'>__PYX_ERR(0, 154, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 154, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_neg_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_neg_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_neg_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 3, __pyx_int_neg_1);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 154, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 154, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 154, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_k__6 = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(154,0,<span class='error_goto'>__PYX_ERR(0, 154, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 154, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_neg_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_neg_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_neg_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, __pyx_int_neg_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 154, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 154, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 154, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_k__6 = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-94" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">155</span>:     <span class="n">double</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">bars</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">]],</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">),</span></pre>
<pre class='cython code score-94 '>  <span class='trace'>__Pyx_TraceLine</span>(155,0,<span class='error_goto'>__PYX_ERR(0, 155, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 155, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 155, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 155, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 3, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 4, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 5, __pyx_int_neg_1);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 155, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 155, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 155, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 155, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_2);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 155, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 155, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k__7 = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(155,0,<span class='error_goto'>__PYX_ERR(0, 155, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 155, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 155, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 155, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 4, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 5, __pyx_int_neg_1);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 155, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 155, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 155, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 155, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_5);
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 155, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 155, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_k__7 = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-98" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">156</span>:     <span class="n">double</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">fuzz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">2</span><span class="p">]],</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">),</span></pre>
<pre class='cython code score-98 '>  <span class='trace'>__Pyx_TraceLine</span>(156,0,<span class='error_goto'>__PYX_ERR(0, 156, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 2, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 3, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 4, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_0_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_0_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 5, __pyx_float_0_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 6, __pyx_int_neg_2);
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
  __pyx_t_5 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_k__8 = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(156,0,<span class='error_goto'>__PYX_ERR(0, 156, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 3, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 4, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_0_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_0_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 5, __pyx_float_0_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 6, __pyx_int_neg_2);
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_k__8 = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">157</span>: <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">158</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">159</span>: <span class="sd">    Performs a basic print after adding back the bars etc. as reference.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">160</span>: <span class="sd">    This means the bars and bounds are avoided in the calculation.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">161</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">162</span>: <span class="sd">    :param dim:         (pointer) arr dimensions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">163</span>: <span class="sd">    :param arr:         (2D pointer) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">164</span>: <span class="sd">    :param bounds:      (pointer) boundary values   (-1 is off)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">165</span>: <span class="sd">    :param bars:        [start, width, step, axis, bounce, polarity (-1 is off)]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">166</span>: <span class="sd">    :param fuzz:        [start, width, step, axis, bounce, coverage, polarity (-2 is off)]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">167</span>: <span class="sd">    :return:            None</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">168</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">169</span>:     <span class="n">cy</span><span class="o">.</span><span class="n">set_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mf">2</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mf">3</span><span class="p">],</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-73 '>  <span class='trace'>__Pyx_TraceLine</span>(169,0,<span class='error_goto'>__PYX_ERR(0, 169, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_cy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 169, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_set_bounds);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 169, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_bounds.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_bounds.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 169, __pyx_L1_error)</span>
  }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_bounds.data + __pyx_t_4 * __pyx_v_bounds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 169, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = 1;
  __pyx_t_5 = -1;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_bounds.shape[0];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_bounds.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 169, __pyx_L1_error)</span>
  }
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_bounds.data + __pyx_t_6 * __pyx_v_bounds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 169, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_8 = 2;
  __pyx_t_5 = -1;
  if (__pyx_t_8 &lt; 0) {
    __pyx_t_8 += __pyx_v_bounds.shape[0];
    if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_bounds.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 169, __pyx_L1_error)</span>
  }
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_bounds.data + __pyx_t_8 * __pyx_v_bounds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 169, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_10 = 3;
  __pyx_t_5 = -1;
  if (__pyx_t_10 &lt; 0) {
    __pyx_t_10 += __pyx_v_bounds.shape[0];
    if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_bounds.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 169, __pyx_L1_error)</span>
  }
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_bounds.data + __pyx_t_10 * __pyx_v_bounds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 169, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_12 = __pyx_memoryview_fromslice(__pyx_v_dim, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 169, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_v_arr, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 169, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_14 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_14)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_5 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[7] = {__pyx_t_14, __pyx_t_2, __pyx_t_7, __pyx_t_9, __pyx_t_11, __pyx_t_12, __pyx_t_13};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 6+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 169, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[7] = {__pyx_t_14, __pyx_t_2, __pyx_t_7, __pyx_t_9, __pyx_t_11, __pyx_t_12, __pyx_t_13};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 6+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 169, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  } else
  #endif
  {
    __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(6+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 169, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
    if (__pyx_t_14) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_14); __pyx_t_14 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0+__pyx_t_5, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 1+__pyx_t_5, __pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 2+__pyx_t_5, __pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 3+__pyx_t_5, __pyx_t_11);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 4+__pyx_t_5, __pyx_t_12);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 5+__pyx_t_5, __pyx_t_13);
    __pyx_t_2 = 0;
    __pyx_t_7 = 0;
    __pyx_t_9 = 0;
    __pyx_t_11 = 0;
    __pyx_t_12 = 0;
    __pyx_t_13 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_15, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 169, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">170</span>:     <span class="n">cy</span><span class="o">.</span><span class="n">scroll_bars</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">bars</span><span class="p">)</span></pre>
<pre class='cython code score-48 '>  <span class='trace'>__Pyx_TraceLine</span>(170,0,<span class='error_goto'>__PYX_ERR(0, 170, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_cy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 170, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_scroll_bars);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 170, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_dim, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 170, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_v_arr, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 170, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_12 = __pyx_memoryview_fromslice(__pyx_v_bars, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 170, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_11 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_15))) {
    __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_15);
    if (likely(__pyx_t_11)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_15, function);
      __pyx_t_5 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_15)) {
    PyObject *__pyx_temp[4] = {__pyx_t_11, __pyx_t_3, __pyx_t_13, __pyx_t_12};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_15, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 170, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_15)) {
    PyObject *__pyx_temp[4] = {__pyx_t_11, __pyx_t_3, __pyx_t_13, __pyx_t_12};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_15, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 170, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  } else
  #endif
  {
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 170, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (__pyx_t_11) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_11); __pyx_t_11 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_5, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_5, __pyx_t_13);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2+__pyx_t_5, __pyx_t_12);
    __pyx_t_3 = 0;
    __pyx_t_13 = 0;
    __pyx_t_12 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_15, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 170, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">171</span>:     <span class="n">scroll_noise</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">fuzz</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(171,0,<span class='error_goto'>__PYX_ERR(0, 171, __pyx_L1_error)</span>)
  __pyx_t_16.__pyx_n = 1;
  __pyx_t_16.bars = __pyx_v_fuzz;
  __pyx_f_6Cfuncs_scroll_noise(__pyx_v_dim, __pyx_v_arr, 0, &amp;__pyx_t_16); 
</pre><pre class="cython line score-0">&#xA0;<span class="">172</span>: </pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">173</span>:     <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span></pre>
<pre class='cython code score-43 '>  <span class='trace'>__Pyx_TraceLine</span>(173,0,<span class='error_goto'>__PYX_ERR(0, 173, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_15, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 173, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_15, __pyx_n_s_empty_like);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 173, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
  __pyx_t_15 = __pyx_memoryview_fromslice(__pyx_v_arr, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 173, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
  __pyx_t_12 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
    __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
    if (likely(__pyx_t_12)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      __pyx_t_5 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_9)) {
    PyObject *__pyx_temp[3] = {__pyx_t_12, __pyx_t_15, ((PyObject *)(&amp;PyUnicode_Type))};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_9, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 173, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_9)) {
    PyObject *__pyx_temp[3] = {__pyx_t_12, __pyx_t_15, ((PyObject *)(&amp;PyUnicode_Type))};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_9, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 173, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
  } else
  #endif
  {
    __pyx_t_13 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 173, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    if (__pyx_t_12) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0, __pyx_t_12); __pyx_t_12 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0+__pyx_t_5, __pyx_t_15);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)(&amp;PyUnicode_Type)));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)(&amp;PyUnicode_Type)));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 1+__pyx_t_5, ((PyObject *)(&amp;PyUnicode_Type)));
    __pyx_t_15 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_13, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 173, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_v_temp = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">174</span>:     <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(174,0,<span class='error_goto'>__PYX_ERR(0, 174, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 174, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_out = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">175</span>:     <span class="k">cdef</span> <span class="kt">Py_ssize_t</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">176</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(176,0,<span class='error_goto'>__PYX_ERR(0, 176, __pyx_L1_error)</span>)
  __pyx_t_17 = 0;
  __pyx_t_5 = -1;
  if (__pyx_t_17 &lt; 0) {
    __pyx_t_17 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_dim.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 176, __pyx_L1_error)</span>
  }
  __pyx_t_5 = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_17 * __pyx_v_dim.strides[0]) )));
  __pyx_t_18 = __pyx_t_5;
  for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
    __pyx_v_i = __pyx_t_19;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">177</span>:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(177,0,<span class='error_goto'>__PYX_ERR(0, 177, __pyx_L1_error)</span>)
    __pyx_t_20 = 1;
    __pyx_t_21 = -1;
    if (__pyx_t_20 &lt; 0) {
      __pyx_t_20 += __pyx_v_dim.shape[0];
      if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_21 = 0;
    } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_dim.shape[0])) __pyx_t_21 = 0;
    if (unlikely(__pyx_t_21 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_21);
      <span class='error_goto'>__PYX_ERR(0, 177, __pyx_L1_error)</span>
    }
    __pyx_t_21 = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_20 * __pyx_v_dim.strides[0]) )));
    __pyx_t_22 = __pyx_t_21;
    for (__pyx_t_23 = 0; __pyx_t_23 &lt; __pyx_t_22; __pyx_t_23+=1) {
      __pyx_v_j = __pyx_t_23;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">178</span>:             <span class="k">if</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(178,0,<span class='error_goto'>__PYX_ERR(0, 178, __pyx_L1_error)</span>)
      __pyx_t_24 = __pyx_v_i;
      __pyx_t_25 = __pyx_v_j;
      __pyx_t_26 = -1;
      if (__pyx_t_24 &lt; 0) {
        __pyx_t_24 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_26 = 0;
      } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_arr.shape[0])) __pyx_t_26 = 0;
      if (__pyx_t_25 &lt; 0) {
        __pyx_t_25 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_26 = 1;
      } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_arr.shape[1])) __pyx_t_26 = 1;
      if (unlikely(__pyx_t_26 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_26);
        <span class='error_goto'>__PYX_ERR(0, 178, __pyx_L1_error)</span>
      }
      __pyx_t_27 = (((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_24 * __pyx_v_arr.strides[0]) ) + __pyx_t_25 * __pyx_v_arr.strides[1]) ))) == 0) != 0);
      if (__pyx_t_27) {
/* … */
        goto __pyx_L7;
      }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">179</span>:                 <span class="n">temp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;.&#39;</span></pre>
<pre class='cython code score-5 '>        <span class='trace'>__Pyx_TraceLine</span>(179,0,<span class='error_goto'>__PYX_ERR(0, 179, __pyx_L1_error)</span>)
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_temp, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 179, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_t_1, __pyx_v_j, __pyx_kp_u__9, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 179, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">180</span>:             <span class="k">elif</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(180,0,<span class='error_goto'>__PYX_ERR(0, 180, __pyx_L1_error)</span>)
      __pyx_t_28 = __pyx_v_i;
      __pyx_t_29 = __pyx_v_j;
      __pyx_t_26 = -1;
      if (__pyx_t_28 &lt; 0) {
        __pyx_t_28 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_28 &lt; 0)) __pyx_t_26 = 0;
      } else if (unlikely(__pyx_t_28 &gt;= __pyx_v_arr.shape[0])) __pyx_t_26 = 0;
      if (__pyx_t_29 &lt; 0) {
        __pyx_t_29 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_29 &lt; 0)) __pyx_t_26 = 1;
      } else if (unlikely(__pyx_t_29 &gt;= __pyx_v_arr.shape[1])) __pyx_t_26 = 1;
      if (unlikely(__pyx_t_26 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_26);
        <span class='error_goto'>__PYX_ERR(0, 180, __pyx_L1_error)</span>
      }
      __pyx_t_27 = (((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_28 * __pyx_v_arr.strides[0]) ) + __pyx_t_29 * __pyx_v_arr.strides[1]) ))) == 1) != 0);
      if (__pyx_t_27) {
/* … */
      }
      __pyx_L7:;
    }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">181</span>:                 <span class="n">temp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;o&#39;</span></pre>
<pre class='cython code score-5 '>        <span class='trace'>__Pyx_TraceLine</span>(181,0,<span class='error_goto'>__PYX_ERR(0, 181, __pyx_L1_error)</span>)
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_temp, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 181, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_t_1, __pyx_v_j, __pyx_n_u_o, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 181, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">182</span>:         <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="n">i</span><span class="p">,:]))</span></pre>
<pre class='cython code score-30 '>    <span class='trace'>__Pyx_TraceLine</span>(182,0,<span class='error_goto'>__PYX_ERR(0, 182, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 182, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 182, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__11);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__11);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_slice__11);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_temp, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 182, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyUnicode_Join</span>(__pyx_kp_u__10, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 182, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_30 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_out, __pyx_t_9);<span class='error_goto'> if (unlikely(__pyx_t_30 == ((int)-1))) __PYX_ERR(0, 182, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
/* … */
  __pyx_slice__11 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__11)) __PYX_ERR(0, 182, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__11);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">183</span>:     <span class="n">fin</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(183,0,<span class='error_goto'>__PYX_ERR(0, 183, __pyx_L1_error)</span>)
  __pyx_t_9 = <span class='py_c_api'>PyUnicode_Join</span>(__pyx_kp_u__12, __pyx_v_out);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 183, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_v_fin = ((PyObject*)__pyx_t_9);
  __pyx_t_9 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">184</span>:     <span class="k">print</span><span class="p">(</span><span class="n">fin</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  <span class='trace'>__Pyx_TraceLine</span>(184,0,<span class='error_goto'>__PYX_ERR(0, 184, __pyx_L1_error)</span>)
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_v_fin);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 184, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">185</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">186</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">187</span>: <span class="c">#==============MID-LEVEL========================</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">188</span>: <span class="c">#===============================================</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">189</span>: <span class="c">#replace memoryview with pointer when you change everything to c</span></pre>
<pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">190</span>: <span class="k">cpdef</span> <span class="nf">update_array_positions</span><span class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">position</span><span class="p">,</span> <span class="nb">int</span> <span class="n">buffer_length</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">buffer_status</span><span class="p">,</span></pre>
<pre class='cython code score-73 '>static PyObject *__pyx_pw_6Cfuncs_11update_array_positions(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_6Cfuncs_update_array_positions(__Pyx_memviewslice __pyx_v_position, int __pyx_v_buffer_length, __Pyx_memviewslice __pyx_v_buffer_status, __Pyx_memviewslice __pyx_v_buf, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_6Cfuncs_update_array_positions *__pyx_optional_args) {
  int __pyx_v_display = ((int)1);
  __Pyx_memviewslice __pyx_v_arrout = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_index;
  int __pyx_v_target;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_array_positions", 0);
  <span class='trace'>__Pyx_TraceCall</span>("update_array_positions", __pyx_f[0], 190, 0, <span class='error_goto'>__PYX_ERR(0, 190, __pyx_L1_error)</span>);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_display = __pyx_optional_args-&gt;display;
    }
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.update_array_positions", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arrout, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_11update_array_positions(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_10update_array_positions[] = "\n    Updates the chosen array (switches the memoryview\n    to the next one in the buffer) and the buffer status.\n\n    :param position:            (pointer) position of array to update\n    :param buffer_length:       (int)\n    :param buffer_status:       (pointer) current positions of arrays\n    :param buf:                 (3D pointer) buffer\n    :param display:             (int) output position?\n    :return:                    (pointer) updated array\n    ";
static PyObject *__pyx_pw_6Cfuncs_11update_array_positions(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_position = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_buffer_length;
  __Pyx_memviewslice __pyx_v_buffer_status = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_buf = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_display;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_array_positions (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_position,&amp;__pyx_n_s_buffer_length,&amp;__pyx_n_s_buffer_status,&amp;__pyx_n_s_buf,&amp;__pyx_n_s_display,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_position)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_buffer_length)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update_array_positions", 0, 4, 5, 1); <span class='error_goto'>__PYX_ERR(0, 190, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_buffer_status)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update_array_positions", 0, 4, 5, 2); <span class='error_goto'>__PYX_ERR(0, 190, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_buf)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update_array_positions", 0, 4, 5, 3); <span class='error_goto'>__PYX_ERR(0, 190, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_display);
          if (value) { values[4] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update_array_positions") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 190, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_position = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_position.memview)) __PYX_ERR(0, 190, __pyx_L3_error)</span>
    __pyx_v_buffer_length = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]); if (unlikely((__pyx_v_buffer_length == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 190, __pyx_L3_error)</span>
    __pyx_v_buffer_status = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_buffer_status.memview)) __PYX_ERR(0, 190, __pyx_L3_error)</span>
    __pyx_v_buf = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_buf.memview)) __PYX_ERR(0, 191, __pyx_L3_error)</span>
    if (values[4]) {
      __pyx_v_display = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]); if (unlikely((__pyx_v_display == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 191, __pyx_L3_error)</span>
    } else {
      __pyx_v_display = ((int)1);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update_array_positions", 0, 4, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 190, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.update_array_positions", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_10update_array_positions(__pyx_self, __pyx_v_position, __pyx_v_buffer_length, __pyx_v_buffer_status, __pyx_v_buf, __pyx_v_display);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_10update_array_positions(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_position, int __pyx_v_buffer_length, __Pyx_memviewslice __pyx_v_buffer_status, __Pyx_memviewslice __pyx_v_buf, int __pyx_v_display) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_array_positions", 0);
  <span class='trace'>__Pyx_TraceCall</span>("update_array_positions (wrapper)", __pyx_f[0], 190, 0, <span class='error_goto'>__PYX_ERR(0, 190, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_position.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("position"); <span class='error_goto'>__PYX_ERR(0, 190, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_buffer_status.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("buffer_status"); <span class='error_goto'>__PYX_ERR(0, 190, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_buf.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("buf"); <span class='error_goto'>__PYX_ERR(0, 190, __pyx_L1_error)</span> }
  __pyx_t_2.__pyx_n = 1;
  __pyx_t_2.display = __pyx_v_display;
  __pyx_t_1 = __pyx_f_6Cfuncs_update_array_positions(__pyx_v_position, __pyx_v_buffer_length, __pyx_v_buffer_status, __pyx_v_buf, 0, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 190, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.update_array_positions", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_position, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_buffer_status, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_buf, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_opt_args_6Cfuncs_update_array_positions {
  int __pyx_n;
  int display;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">191</span>:                              <span class="nb">int</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="n">buf</span><span class="p">,</span> <span class="nb">int</span> <span class="n">display</span><span class="o">=</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">192</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">193</span>: <span class="sd">    Updates the chosen array (switches the memoryview</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">194</span>: <span class="sd">    to the next one in the buffer) and the buffer status.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">195</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">196</span>: <span class="sd">    :param position:            (pointer) position of array to update</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">197</span>: <span class="sd">    :param buffer_length:       (int)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">198</span>: <span class="sd">    :param buffer_status:       (pointer) current positions of arrays</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">199</span>: <span class="sd">    :param buf:                 (3D pointer) buffer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">200</span>: <span class="sd">    :param display:             (int) output position?</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">201</span>: <span class="sd">    :return:                    (pointer) updated array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">202</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">203</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">arrout</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">204</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">index</span><span class="p">,</span> <span class="nf">target</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">205</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">206</span>:     <span class="n">index</span> <span class="o">=</span> <span class="n">position</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">%</span> <span class="n">buffer_length</span></pre>
<pre class='cython code score-7 '>  <span class='trace'>__Pyx_TraceLine</span>(206,0,<span class='error_goto'>__PYX_ERR(0, 206, __pyx_L1_error)</span>)
  __pyx_t_1 = 0;
  __pyx_t_2 = -1;
  if (__pyx_t_1 &lt; 0) {
    __pyx_t_1 += __pyx_v_position.shape[0];
    if (unlikely(__pyx_t_1 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_1 &gt;= __pyx_v_position.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 206, __pyx_L1_error)</span>
  }
  __pyx_t_2 = (*((int *) ( /* dim=0 */ (__pyx_v_position.data + __pyx_t_1 * __pyx_v_position.strides[0]) )));
  if (unlikely(__pyx_v_buffer_length == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
    <span class='error_goto'>__PYX_ERR(0, 206, __pyx_L1_error)</span>
  }
  __pyx_v_index = __Pyx_mod_int(__pyx_t_2, __pyx_v_buffer_length);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">207</span>:     <span class="n">target</span> <span class="o">=</span> <span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">buffer_length</span></pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(207,0,<span class='error_goto'>__PYX_ERR(0, 207, __pyx_L1_error)</span>)
  __pyx_t_3 = (__pyx_v_index + 1);
  if (unlikely(__pyx_v_buffer_length == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
    <span class='error_goto'>__PYX_ERR(0, 207, __pyx_L1_error)</span>
  }
  __pyx_v_target = __Pyx_mod_long(__pyx_t_3, __pyx_v_buffer_length);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">208</span>:     <span class="k">if</span> <span class="ow">not</span> <span class="n">buffer_status</span><span class="p">[</span><span class="n">target</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(208,0,<span class='error_goto'>__PYX_ERR(0, 208, __pyx_L1_error)</span>)
  __pyx_t_4 = __pyx_v_target;
  __pyx_t_2 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_buffer_status.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_buffer_status.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L1_error)</span>
  }
  __pyx_t_5 = ((!(((*((int *) ( /* dim=0 */ (__pyx_v_buffer_status.data + __pyx_t_4 * __pyx_v_buffer_status.strides[0]) ))) == 0) != 0)) != 0);
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">209</span>:         <span class="k">return</span> <span class="bp">None</span></pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(209,0,<span class='error_goto'>__PYX_ERR(0, 209, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">210</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">211</span>:         <span class="n">buffer_status</span><span class="p">[</span><span class="n">target</span><span class="p">]</span> <span class="o">=</span> <span class="n">buffer_status</span><span class="p">[</span><span class="n">index</span><span class="p">]</span></pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(211,0,<span class='error_goto'>__PYX_ERR(0, 211, __pyx_L1_error)</span>)
  /*else*/ {
    __pyx_t_6 = __pyx_v_index;
    __pyx_t_2 = -1;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_buffer_status.shape[0];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_2 = 0;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_buffer_status.shape[0])) __pyx_t_2 = 0;
    if (unlikely(__pyx_t_2 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
      <span class='error_goto'>__PYX_ERR(0, 211, __pyx_L1_error)</span>
    }
    __pyx_t_7 = __pyx_v_target;
    __pyx_t_2 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_buffer_status.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_2 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_buffer_status.shape[0])) __pyx_t_2 = 0;
    if (unlikely(__pyx_t_2 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
      <span class='error_goto'>__PYX_ERR(0, 211, __pyx_L1_error)</span>
    }
    *((int *) ( /* dim=0 */ (__pyx_v_buffer_status.data + __pyx_t_7 * __pyx_v_buffer_status.strides[0]) )) = (*((int *) ( /* dim=0 */ (__pyx_v_buffer_status.data + __pyx_t_6 * __pyx_v_buffer_status.strides[0]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">212</span>:         <span class="n">buffer_status</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(212,0,<span class='error_goto'>__PYX_ERR(0, 212, __pyx_L1_error)</span>)
    __pyx_t_8 = __pyx_v_index;
    __pyx_t_2 = -1;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_buffer_status.shape[0];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_2 = 0;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_buffer_status.shape[0])) __pyx_t_2 = 0;
    if (unlikely(__pyx_t_2 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
      <span class='error_goto'>__PYX_ERR(0, 212, __pyx_L1_error)</span>
    }
    *((int *) ( /* dim=0 */ (__pyx_v_buffer_status.data + __pyx_t_8 * __pyx_v_buffer_status.strides[0]) )) = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">213</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">214</span>:     <span class="n">position</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(214,0,<span class='error_goto'>__PYX_ERR(0, 214, __pyx_L1_error)</span>)
  __pyx_t_9 = 0;
  __pyx_t_2 = -1;
  if (__pyx_t_9 &lt; 0) {
    __pyx_t_9 += __pyx_v_position.shape[0];
    if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_position.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 214, __pyx_L1_error)</span>
  }
  *((int *) ( /* dim=0 */ (__pyx_v_position.data + __pyx_t_9 * __pyx_v_position.strides[0]) )) += 1;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">215</span>:     <span class="n">arrout</span> <span class="o">=</span> <span class="n">buf</span><span class="p">[</span><span class="n">position</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">%</span> <span class="n">buffer_length</span><span class="p">]</span></pre>
<pre class='cython code score-12 '>  <span class='trace'>__Pyx_TraceLine</span>(215,0,<span class='error_goto'>__PYX_ERR(0, 215, __pyx_L1_error)</span>)
  __pyx_t_10 = 0;
  __pyx_t_2 = -1;
  if (__pyx_t_10 &lt; 0) {
    __pyx_t_10 += __pyx_v_position.shape[0];
    if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_position.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 215, __pyx_L1_error)</span>
  }
  __pyx_t_2 = (*((int *) ( /* dim=0 */ (__pyx_v_position.data + __pyx_t_10 * __pyx_v_position.strides[0]) )));
  if (unlikely(__pyx_v_buffer_length == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
    <span class='error_goto'>__PYX_ERR(0, 215, __pyx_L1_error)</span>
  }
  __pyx_t_11.data = __pyx_v_buf.data;
  __pyx_t_11.memview = __pyx_v_buf.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_11, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __Pyx_mod_int(__pyx_t_2, __pyx_v_buffer_length);
        Py_ssize_t __pyx_tmp_shape = __pyx_v_buf.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_buf.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 215, __pyx_L1_error)</span>
        }
        __pyx_t_11.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_11.shape[0] = __pyx_v_buf.shape[1];
__pyx_t_11.strides[0] = __pyx_v_buf.strides[1];
    __pyx_t_11.suboffsets[0] = -1;

__pyx_t_11.shape[1] = __pyx_v_buf.shape[2];
__pyx_t_11.strides[1] = __pyx_v_buf.strides[2];
    __pyx_t_11.suboffsets[1] = -1;

__pyx_v_arrout = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">216</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">217</span>:     <span class="k">if</span> <span class="n">display</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(217,0,<span class='error_goto'>__PYX_ERR(0, 217, __pyx_L1_error)</span>)
  __pyx_t_5 = (__pyx_v_display != 0);
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">218</span>:         <span class="n">print_buffer_status</span><span class="p">(</span><span class="n">buffer_status</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>    <span class='trace'>__Pyx_TraceLine</span>(218,0,<span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>)
    __pyx_t_12 = __pyx_f_6Cfuncs_print_buffer_status(__pyx_v_buffer_status, 0, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 218, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">219</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">220</span>:     <span class="c"># should make a pointer to the memview to be a real hero</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">221</span>:     <span class="k">return</span> <span class="n">arrout</span></pre>
<pre class='cython code score-1 '>  <span class='trace'>__Pyx_TraceLine</span>(221,0,<span class='error_goto'>__PYX_ERR(0, 221, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_12 = __pyx_memoryview_fromslice(__pyx_v_arrout, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 221, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_r = __pyx_t_12;
  __pyx_t_12 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">222</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">223</span>: </pre>
<pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">224</span>: <span class="k">cpdef</span> <span class="nf">print_buffer_status</span><span class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">buffer_status</span><span class="p">,</span> <span class="nb">int</span> <span class="n">pad</span><span class="o">=</span><span class="mf">4</span><span class="p">,</span></pre>
<pre class='cython code score-64 '>static PyObject *__pyx_pw_6Cfuncs_13print_buffer_status(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_6Cfuncs_print_buffer_status(__Pyx_memviewslice __pyx_v_buffer_status, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_6Cfuncs_print_buffer_status *__pyx_optional_args) {
  int __pyx_v_pad = ((int)4);
  PyObject *__pyx_v_border = ((PyObject*)__pyx_kp_u__13);
  PyObject *__pyx_v_base = ((PyObject*)__pyx_kp_u__14);
  PyObject *__pyx_v_out = 0;
  PyObject *__pyx_v_buff = 0;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("print_buffer_status", 0);
  <span class='trace'>__Pyx_TraceCall</span>("print_buffer_status", __pyx_f[0], 224, 0, <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L1_error)</span>);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_pad = __pyx_optional_args-&gt;pad;
      if (__pyx_optional_args-&gt;__pyx_n &gt; 1) {
        __pyx_v_border = __pyx_optional_args-&gt;border;
        if (__pyx_optional_args-&gt;__pyx_n &gt; 2) {
          __pyx_v_base = __pyx_optional_args-&gt;base;
        }
      }
    }
  }
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.print_buffer_status", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_buff);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_13print_buffer_status(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_12print_buffer_status[] = "\n    Outputs the array positions like so:\n        ***************\n        *  h      t   *\n        *  PPPPAAAH   *\n        ***************\n        where h=head, t=tail\n    :param buffer_status:      (pointer) current state of buffer\n    :param pad:                 (int) width of padding\n    :param border:              (str) style of border\n    :param base:                (str) style of base\n    :return:                    None\n    ";
static PyObject *__pyx_pw_6Cfuncs_13print_buffer_status(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_buffer_status = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_pad;
  PyObject *__pyx_v_border = 0;
  PyObject *__pyx_v_base = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("print_buffer_status (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_buffer_status,&amp;__pyx_n_s_pad,&amp;__pyx_n_s_border,&amp;__pyx_n_s_base,0};
    PyObject* values[4] = {0,0,0,0};
    values[2] = ((PyObject*)__pyx_kp_u__13);
    values[3] = ((PyObject*)__pyx_kp_u__14);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_buffer_status)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_pad);
          if (value) { values[1] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_border);
          if (value) { values[2] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_base);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "print_buffer_status") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_buffer_status = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_buffer_status.memview)) __PYX_ERR(0, 224, __pyx_L3_error)</span>
    if (values[1]) {
      __pyx_v_pad = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]); if (unlikely((__pyx_v_pad == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L3_error)</span>
    } else {
      __pyx_v_pad = ((int)4);
    }
    __pyx_v_border = ((PyObject*)values[2]);
    __pyx_v_base = ((PyObject*)values[3]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("print_buffer_status", 0, 1, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.print_buffer_status", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_border), (&amp;PyUnicode_Type), 1, "border", 1))) <span class='error_goto'>__PYX_ERR(0, 225, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_base), (&amp;PyUnicode_Type), 1, "base", 1))) <span class='error_goto'>__PYX_ERR(0, 225, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6Cfuncs_12print_buffer_status(__pyx_self, __pyx_v_buffer_status, __pyx_v_pad, __pyx_v_border, __pyx_v_base);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_12print_buffer_status(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_buffer_status, int __pyx_v_pad, PyObject *__pyx_v_border, PyObject *__pyx_v_base) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("print_buffer_status", 0);
  <span class='trace'>__Pyx_TraceCall</span>("print_buffer_status (wrapper)", __pyx_f[0], 224, 0, <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_buffer_status.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("buffer_status"); <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L1_error)</span> }
  __pyx_t_2.__pyx_n = 3;
  __pyx_t_2.pad = __pyx_v_pad;
  __pyx_t_2.border = __pyx_v_border;
  __pyx_t_2.base = __pyx_v_base;
  __pyx_t_1 = __pyx_f_6Cfuncs_print_buffer_status(__pyx_v_buffer_status, 0, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 224, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.print_buffer_status", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_buffer_status, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_opt_args_6Cfuncs_print_buffer_status {
  int __pyx_n;
  int pad;
  PyObject *border;
  PyObject *base;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">225</span>:                           <span class="nb">str</span> <span class="n">border</span><span class="o">=</span><span class="s">r&quot;*&quot;</span><span class="p">,</span> <span class="nb">str</span> <span class="n">base</span><span class="o">=</span><span class="s">r&quot;#&quot;</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">226</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">227</span>: <span class="sd">    Outputs the array positions like so:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">228</span>: <span class="sd">        ***************</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">229</span>: <span class="sd">        *  h      t   *</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">230</span>: <span class="sd">        *  PPPPAAAH   *</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">231</span>: <span class="sd">        ***************</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">232</span>: <span class="sd">        where h=head, t=tail</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">233</span>: <span class="sd">    :param buffer_status:      (pointer) current state of buffer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">234</span>: <span class="sd">    :param pad:                 (int) width of padding</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">235</span>: <span class="sd">    :param border:              (str) style of border</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">236</span>: <span class="sd">    :param base:                (str) style of base</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">237</span>: <span class="sd">    :return:                    None</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">238</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">239</span>:     <span class="k">cdef</span> <span class="kt">str</span> <span class="nf">out</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">240</span>:     <span class="k">cdef</span> <span class="kt">str</span> <span class="nf">buff</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">241</span>:     <span class="n">buff</span> <span class="o">=</span> <span class="s">&#39;a&#39;</span></pre>
<pre class='cython code score-1 '>  <span class='trace'>__Pyx_TraceLine</span>(241,0,<span class='error_goto'>__PYX_ERR(0, 241, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_a);
  __pyx_v_buff = __pyx_n_u_a;
</pre><pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">242</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">buffer_status</span><span class="p">:</span></pre>
<pre class='cython code score-44 '>  <span class='trace'>__Pyx_TraceLine</span>(242,0,<span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>)
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_buffer_status, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(242,0,<span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">243</span>:         <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(243,0,<span class='error_goto'>__PYX_ERR(0, 243, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_i, __pyx_int_0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 243, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 243, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_5) {
/* … */
    }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">244</span>:             <span class="n">buff</span> <span class="o">+=</span> <span class="s">&#39; &#39;</span></pre>
<pre class='cython code score-3 '>      <span class='trace'>__Pyx_TraceLine</span>(244,0,<span class='error_goto'>__PYX_ERR(0, 244, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_v_buff, __pyx_kp_u__15);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 244, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_buff, ((PyObject*)__pyx_t_1));
      __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">245</span>:         <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(245,0,<span class='error_goto'>__PYX_ERR(0, 245, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 245, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 245, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_5) {
/* … */
    }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">246</span>:             <span class="n">buff</span> <span class="o">+=</span> <span class="s">&#39;h&#39;</span></pre>
<pre class='cython code score-3 '>      <span class='trace'>__Pyx_TraceLine</span>(246,0,<span class='error_goto'>__PYX_ERR(0, 246, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_v_buff, __pyx_n_u_h);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 246, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_buff, ((PyObject*)__pyx_t_1));
      __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">247</span>:         <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(247,0,<span class='error_goto'>__PYX_ERR(0, 247, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_i, __pyx_int_2, 2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 247, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 247, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_5) {
/* … */
    }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">248</span>:             <span class="n">buff</span> <span class="o">+=</span> <span class="s">&#39;t&#39;</span></pre>
<pre class='cython code score-3 '>      <span class='trace'>__Pyx_TraceLine</span>(248,0,<span class='error_goto'>__PYX_ERR(0, 248, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_v_buff, __pyx_n_u_t);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 248, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_buff, ((PyObject*)__pyx_t_1));
      __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">249</span>:     <span class="n">buff</span> <span class="o">=</span> <span class="n">buff</span><span class="p">[</span><span class="mf">1</span><span class="p">:]</span></pre>
<pre class='cython code score-3 '>  <span class='trace'>__Pyx_TraceLine</span>(249,0,<span class='error_goto'>__PYX_ERR(0, 249, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_Substring</span>(__pyx_v_buff, 1, PY_SSIZE_T_MAX);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 249, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_buff, ((PyObject*)__pyx_t_2));
  __pyx_t_2 = 0;
</pre><pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">250</span>:     <span class="n">out</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s">&#39;{0}{1}{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pad</span><span class="o">*</span><span class="n">border</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">buffer_status</span><span class="p">)</span><span class="o">*</span><span class="n">border</span><span class="p">),</span></pre>
<pre class='cython code score-74 '>  <span class='trace'>__Pyx_TraceLine</span>(250,0,<span class='error_goto'>__PYX_ERR(0, 250, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_u_0_1_0, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 250, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_pad);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 250, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_6, __pyx_v_border);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 250, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_buffer_status); 
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 250, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_6, __pyx_v_border);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 250, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  __pyx_t_10 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_10 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
    PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_t_7, __pyx_t_9};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 250, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
    PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_t_7, __pyx_t_9};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 250, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  } else
  #endif
  {
    __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 250, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    if (__pyx_t_6) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_6); __pyx_t_6 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+__pyx_t_10, __pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1+__pyx_t_10, __pyx_t_9);
    __pyx_t_7 = 0;
    __pyx_t_9 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 250, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(250,0,<span class='error_goto'>__PYX_ERR(0, 250, __pyx_L1_error)</span>)
  __pyx_t_13 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 250, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 1, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 2, __pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 3, __pyx_t_6);
  __pyx_t_2 = 0;
  __pyx_t_1 = 0;
  __pyx_t_11 = 0;
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyUnicode_Join</span>(__pyx_kp_u__12, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 250, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_v_out = ((PyObject*)__pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">251</span>:                     <span class="s">&#39;{0}{1}{2}{1}{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">border</span><span class="p">,</span> <span class="s">&#39; &#39;</span><span class="o">*</span><span class="p">(</span><span class="n">pad</span><span class="o">-</span><span class="mf">1</span><span class="p">),</span> <span class="n">buff</span><span class="p">),</span></pre>
<pre class='cython code score-50 '>  <span class='trace'>__Pyx_TraceLine</span>(251,0,<span class='error_goto'>__PYX_ERR(0, 251, __pyx_L1_error)</span>)
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_u_0_1_2_1_0, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 251, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_pad - 1));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 251, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_kp_u__15, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 251, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = NULL;
  __pyx_t_10 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
    __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
    if (likely(__pyx_t_9)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
      __pyx_t_10 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_11)) {
    PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_v_border, __pyx_t_7, __pyx_v_buff};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_11, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 251, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_11)) {
    PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_v_border, __pyx_t_7, __pyx_v_buff};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_11, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 251, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  {
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 251, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (__pyx_t_9) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_9); __pyx_t_9 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_border);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_border);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_10, __pyx_v_border);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_10, __pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_buff);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_buff);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2+__pyx_t_10, __pyx_v_buff);
    __pyx_t_7 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 251, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">252</span>:                     <span class="s">&#39;{0}{1}{2}{1}{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">border</span><span class="p">,</span> <span class="s">&#39; &#39;</span><span class="o">*</span><span class="p">(</span><span class="n">pad</span><span class="o">-</span><span class="mf">1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">buffer_status</span><span class="p">)</span><span class="o">*</span><span class="n">base</span><span class="p">),</span></pre>
<pre class='cython code score-61 '>  <span class='trace'>__Pyx_TraceLine</span>(252,0,<span class='error_goto'>__PYX_ERR(0, 252, __pyx_L1_error)</span>)
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_u_0_1_2_1_0, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 252, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_pad - 1));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 252, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_kp_u__15, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 252, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_buffer_status); 
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 252, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_7, __pyx_v_base);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 252, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  __pyx_t_10 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_10 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_6)) {
    PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_v_border, __pyx_t_9, __pyx_t_12};
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_6, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 252, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_6)) {
    PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_v_border, __pyx_t_9, __pyx_t_12};
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_6, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 252, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  } else
  #endif
  {
    __pyx_t_13 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 252, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    if (__pyx_t_7) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0, __pyx_t_7); __pyx_t_7 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_border);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_border);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0+__pyx_t_10, __pyx_v_border);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 1+__pyx_t_10, __pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 2+__pyx_t_10, __pyx_t_12);
    __pyx_t_9 = 0;
    __pyx_t_12 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_13, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 252, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-59" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">253</span>:                      <span class="s">&#39;{0}{1}{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pad</span><span class="o">*</span><span class="n">border</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">buffer_status</span><span class="p">)</span><span class="o">*</span><span class="n">border</span><span class="p">)))</span></pre>
<pre class='cython code score-59 '>  <span class='trace'>__Pyx_TraceLine</span>(253,0,<span class='error_goto'>__PYX_ERR(0, 253, __pyx_L1_error)</span>)
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_u_0_1_0, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_pad);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_v_border);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_buffer_status); 
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_v_border);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_12 = NULL;
  __pyx_t_10 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_13))) {
    __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_13);
    if (likely(__pyx_t_12)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_13, function);
      __pyx_t_10 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_13)) {
    PyObject *__pyx_temp[3] = {__pyx_t_12, __pyx_t_9, __pyx_t_7};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_13, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_13)) {
    PyObject *__pyx_temp[3] = {__pyx_t_12, __pyx_t_9, __pyx_t_7};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_13, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  {
    __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    if (__pyx_t_12) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_12); __pyx_t_12 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+__pyx_t_10, __pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1+__pyx_t_10, __pyx_t_7);
    __pyx_t_9 = 0;
    __pyx_t_7 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_13, __pyx_t_14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">254</span>:     <span class="k">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  <span class='trace'>__Pyx_TraceLine</span>(254,0,<span class='error_goto'>__PYX_ERR(0, 254, __pyx_L1_error)</span>)
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_v_out);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 254, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">255</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">256</span>: <span class="c">#TODO: for this to make any sense, it needs to take the new rules, and the old rules as</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">257</span>: <span class="c"># pointers but for that to work, the old rules need to have been passed as pointers</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">258</span>: <span class="c"># throughout, no?</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">259</span>: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">update_rules</span><span class="p">(</span></pre>
<pre class='cython code score-8 '>static void __pyx_f_6Cfuncs_update_rules(float *__pyx_v_updates, float *__pyx_v_beta, float *__pyx_v_threshold, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_bars, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_bounds, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_rules) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_rules", 0);
  <span class='trace'>__Pyx_TraceCall</span>("update_rules", __pyx_f[0], 259, 0, <span class='error_goto'>__PYX_ERR(0, 259, __pyx_L1_error)</span>);
  __PYX_INC_MEMVIEW(&amp;__pyx_v_bars, 1);
  __PYX_INC_MEMVIEW(&amp;__pyx_v_bounds, 1);
  __PYX_INC_MEMVIEW(&amp;__pyx_v_rules, 1);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("Cfuncs.update_rules", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bars, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bounds, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_rules, 1);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">260</span>:     <span class="nb">float</span><span class="o">*</span> <span class="n">updates</span><span class="p">,</span> <span class="nb">float</span><span class="o">*</span> <span class="n">beta</span><span class="p">,</span> <span class="nb">float</span><span class="o">*</span> <span class="n">threshold</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">261</span>:     <span class="nb">int</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">bars</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">bounds</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">262</span>:     <span class="nb">int</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">rules</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">263</span>: <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">264</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">265</span>: <span class="sd">    updates the rules.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">266</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">267</span>: <span class="sd">    :param updates:     (float) ising updates (as percentage of all positions, 0 is off)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">268</span>: <span class="sd">    :param beta:        (float) inverse temperature</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">269</span>: <span class="sd">    :param threshold:   (float) noise threshold</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">270</span>: <span class="sd">    :param bars:        [start, width, step, axis, bounce, polarity (-1 is off)]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">271</span>: <span class="sd">    :param bounds:      (pointer) boundary values   (-1 is off)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">272</span>: <span class="sd">    :param rules:       (2d pointer) rules for conway (-1 is off)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">273</span>: <span class="sd">    :return:        none</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">274</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">275</span>:     <span class="n">updates</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">100</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(275,0,<span class='error_goto'>__PYX_ERR(0, 275, __pyx_L1_error)</span>)
  (__pyx_v_updates[0]) = 100.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">276</span>:     <span class="n">beta</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span><span class="o">/</span><span class="mf">8</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(276,0,<span class='error_goto'>__PYX_ERR(0, 276, __pyx_L1_error)</span>)
  (__pyx_v_beta[0]) = (1.0 / 8.0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">277</span>:     <span class="n">threshold</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.9</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(277,0,<span class='error_goto'>__PYX_ERR(0, 277, __pyx_L1_error)</span>)
  (__pyx_v_threshold[0]) = 0.9;
</pre><pre class="cython line score-85" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">278</span>:     <span class="n">rules</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">2</span><span class="p">,</span><span class="mf">3</span><span class="p">,</span><span class="mf">3</span><span class="p">,</span><span class="mf">3</span><span class="p">],[</span><span class="mf">2</span><span class="p">,</span><span class="mf">3</span><span class="p">,</span><span class="mf">3</span><span class="p">,</span><span class="mf">3</span><span class="p">]],</span> <span class="n">np</span><span class="o">.</span><span class="n">intc</span><span class="p">)</span></pre>
<pre class='cython code score-85 '>  <span class='trace'>__Pyx_TraceLine</span>(278,0,<span class='error_goto'>__PYX_ERR(0, 278, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_int_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 2, __pyx_int_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 3, __pyx_int_3);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 3, __pyx_int_3);
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_5, __pyx_t_2};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_5, __pyx_t_2};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  } else
  #endif
  {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (__pyx_t_4) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_4); __pyx_t_4 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_6, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_6, __pyx_t_2);
    __pyx_t_5 = 0;
    __pyx_t_2 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_rules, 1);
  __pyx_v_rules = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">279</span>:     <span class="n">bars</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">])</span></pre>
<pre class='cython code score-31 '>  <span class='trace'>__Pyx_TraceLine</span>(279,0,<span class='error_goto'>__PYX_ERR(0, 279, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 279, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 4, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 5, __pyx_int_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 279, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 279, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 279, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bars, 1);
  __pyx_v_bars = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">280</span>:     <span class="n">bounds</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">])</span></pre>
<pre class='cython code score-27 '>  <span class='trace'>__Pyx_TraceLine</span>(280,0,<span class='error_goto'>__PYX_ERR(0, 280, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 280, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, __pyx_int_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 280, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 280, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 280, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bounds, 1);
  __pyx_v_bounds = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">281</span>: </pre>
<pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">282</span>: <span class="k">cpdef</span> <span class="nf">scroll_instruction_update</span><span class="p">(</span><span class="nb">int</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">bars</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">):</span></pre>
<pre class='cython code score-39 '>static PyObject *__pyx_pw_6Cfuncs_15scroll_instruction_update(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_6Cfuncs_scroll_instruction_update(__Pyx_memviewslice __pyx_v_bars, __Pyx_memviewslice __pyx_v_dim, CYTHON_UNUSED int __pyx_skip_dispatch) {
  __Pyx_memviewslice __pyx_v_bar = { 0, 0, { 0 }, { 0 }, { 0 } };
  Py_ssize_t __pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("scroll_instruction_update", 0);
  <span class='trace'>__Pyx_TraceCall</span>("scroll_instruction_update", __pyx_f[0], 282, 0, <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.scroll_instruction_update", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bar, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_15scroll_instruction_update(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_14scroll_instruction_update[] = "\n    Updates the positons of the scrollbar.\n\n    :param bars:        [start, width, step, axis, bounce, polarity (-1 is off)]\n    :param dim:         (pointer) dimensions of array\n    :return:            None\n    ";
static PyObject *__pyx_pw_6Cfuncs_15scroll_instruction_update(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_bars = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("scroll_instruction_update (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_bars,&amp;__pyx_n_s_dim,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bars)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("scroll_instruction_update", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "scroll_instruction_update") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_bars = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_bars.memview)) __PYX_ERR(0, 282, __pyx_L3_error)</span>
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 282, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("scroll_instruction_update", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.scroll_instruction_update", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_14scroll_instruction_update(__pyx_self, __pyx_v_bars, __pyx_v_dim);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_14scroll_instruction_update(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_bars, __Pyx_memviewslice __pyx_v_dim) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("scroll_instruction_update", 0);
  <span class='trace'>__Pyx_TraceCall</span>("scroll_instruction_update (wrapper)", __pyx_f[0], 282, 0, <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_bars.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("bars"); <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L1_error)</span> }
  __pyx_t_1 = __pyx_f_6Cfuncs_scroll_instruction_update(__pyx_v_bars, __pyx_v_dim, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 282, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.scroll_instruction_update", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bars, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">283</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">284</span>: <span class="sd">    Updates the positons of the scrollbar.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">285</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">286</span>: <span class="sd">    :param bars:        [start, width, step, axis, bounce, polarity (-1 is off)]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">287</span>: <span class="sd">    :param dim:         (pointer) dimensions of array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">288</span>: <span class="sd">    :return:            None</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">289</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">290</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:]</span> <span class="n">bar</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">291</span>:     <span class="k">cdef</span> <span class="kt">Py_ssize_t</span> <span class="nf">i</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">292</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bars</span><span class="p">)):</span></pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(292,0,<span class='error_goto'>__PYX_ERR(0, 292, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_bars); 
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">293</span>:         <span class="n">bar</span> <span class="o">=</span> <span class="n">bars</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(293,0,<span class='error_goto'>__PYX_ERR(0, 293, __pyx_L1_error)</span>)
    __pyx_t_4.data = __pyx_v_bars.data;
    __pyx_t_4.memview = __pyx_v_bars.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_4, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_bars.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_bars.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 293, __pyx_L1_error)</span>
        }
        __pyx_t_4.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_4.shape[0] = __pyx_v_bars.shape[1];
__pyx_t_4.strides[0] = __pyx_v_bars.strides[1];
    __pyx_t_4.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_v_bar, 1);
    __pyx_v_bar = __pyx_t_4;
    __pyx_t_4.memview = NULL;
    __pyx_t_4.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">294</span>:         <span class="c"># If bounce is on</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">295</span>:         <span class="k">if</span> <span class="n">bar</span><span class="p">[</span><span class="mf">4</span><span class="p">]:</span></pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(295,0,<span class='error_goto'>__PYX_ERR(0, 295, __pyx_L1_error)</span>)
    __pyx_t_5 = 4;
    __pyx_t_6 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_bar.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 295, __pyx_L1_error)</span>
    }
    __pyx_t_7 = ((*((int *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_5 * __pyx_v_bar.strides[0]) ))) != 0);
    if (__pyx_t_7) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">296</span>:             <span class="c"># If the step is positive</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">297</span>:             <span class="k">if</span> <span class="n">bar</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(297,0,<span class='error_goto'>__PYX_ERR(0, 297, __pyx_L1_error)</span>)
      __pyx_t_8 = 2;
      __pyx_t_6 = -1;
      if (__pyx_t_8 &lt; 0) {
        __pyx_t_8 += __pyx_v_bar.shape[0];
        if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 297, __pyx_L1_error)</span>
      }
      __pyx_t_7 = (((*((int *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_8 * __pyx_v_bar.strides[0]) ))) &gt; 0) != 0);
      if (__pyx_t_7) {
/* … */
        goto __pyx_L6;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">298</span>:                 <span class="c"># If the next step takes it out of bounds</span></pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">299</span>:                 <span class="k">if</span> <span class="n">bar</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">bar</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">bar</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">dim</span><span class="p">[</span><span class="n">bar</span><span class="p">[</span><span class="mf">3</span><span class="p">]]:</span></pre>
<pre class='cython code score-10 '>        <span class='trace'>__Pyx_TraceLine</span>(299,0,<span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span>)
        __pyx_t_9 = 0;
        __pyx_t_6 = -1;
        if (__pyx_t_9 &lt; 0) {
          __pyx_t_9 += __pyx_v_bar.shape[0];
          if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_6 = 0;
        } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
        if (unlikely(__pyx_t_6 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
          <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span>
        }
        __pyx_t_10 = 1;
        __pyx_t_6 = -1;
        if (__pyx_t_10 &lt; 0) {
          __pyx_t_10 += __pyx_v_bar.shape[0];
          if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_6 = 0;
        } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
        if (unlikely(__pyx_t_6 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
          <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span>
        }
        __pyx_t_11 = 2;
        __pyx_t_6 = -1;
        if (__pyx_t_11 &lt; 0) {
          __pyx_t_11 += __pyx_v_bar.shape[0];
          if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_6 = 0;
        } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
        if (unlikely(__pyx_t_6 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
          <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span>
        }
        __pyx_t_12 = 3;
        __pyx_t_6 = -1;
        if (__pyx_t_12 &lt; 0) {
          __pyx_t_12 += __pyx_v_bar.shape[0];
          if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_6 = 0;
        } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
        if (unlikely(__pyx_t_6 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
          <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span>
        }
        __pyx_t_13 = (*((int *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_12 * __pyx_v_bar.strides[0]) )));
        __pyx_t_6 = -1;
        if (__pyx_t_13 &lt; 0) {
          __pyx_t_13 += __pyx_v_dim.shape[0];
          if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_6 = 0;
        } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
        if (unlikely(__pyx_t_6 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
          <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span>
        }
        __pyx_t_7 = (((((*((int *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_9 * __pyx_v_bar.strides[0]) ))) + (*((int *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_10 * __pyx_v_bar.strides[0]) )))) + (*((int *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_11 * __pyx_v_bar.strides[0]) )))) &gt;= (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_13 * __pyx_v_dim.strides[0]) )))) != 0);
        if (__pyx_t_7) {
/* … */
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">300</span>:                     <span class="c"># Turn it around</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">301</span>:                     <span class="n">bar</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">bar</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-4 '>          <span class='trace'>__Pyx_TraceLine</span>(301,0,<span class='error_goto'>__PYX_ERR(0, 301, __pyx_L1_error)</span>)
          __pyx_t_14 = 2;
          __pyx_t_6 = -1;
          if (__pyx_t_14 &lt; 0) {
            __pyx_t_14 += __pyx_v_bar.shape[0];
            if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_6 = 0;
          } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
          if (unlikely(__pyx_t_6 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
            <span class='error_goto'>__PYX_ERR(0, 301, __pyx_L1_error)</span>
          }
          __pyx_t_15 = 2;
          __pyx_t_6 = -1;
          if (__pyx_t_15 &lt; 0) {
            __pyx_t_15 += __pyx_v_bar.shape[0];
            if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_6 = 0;
          } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
          if (unlikely(__pyx_t_6 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
            <span class='error_goto'>__PYX_ERR(0, 301, __pyx_L1_error)</span>
          }
          *((int *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_15 * __pyx_v_bar.strides[0]) )) = (-(*((int *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_14 * __pyx_v_bar.strides[0]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">302</span>:             <span class="c"># If the step is negative</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">303</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">304</span>:                 <span class="c"># If the next step takes it out of bounds</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">305</span>:                 <span class="k">if</span> <span class="n">bar</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">bar</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-4 '>      <span class='trace'>__Pyx_TraceLine</span>(305,0,<span class='error_goto'>__PYX_ERR(0, 305, __pyx_L1_error)</span>)
      /*else*/ {
        __pyx_t_16 = 0;
        __pyx_t_6 = -1;
        if (__pyx_t_16 &lt; 0) {
          __pyx_t_16 += __pyx_v_bar.shape[0];
          if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_6 = 0;
        } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
        if (unlikely(__pyx_t_6 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
          <span class='error_goto'>__PYX_ERR(0, 305, __pyx_L1_error)</span>
        }
        __pyx_t_17 = 2;
        __pyx_t_6 = -1;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_v_bar.shape[0];
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_6 = 0;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
        if (unlikely(__pyx_t_6 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
          <span class='error_goto'>__PYX_ERR(0, 305, __pyx_L1_error)</span>
        }
        __pyx_t_7 = ((((*((int *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_16 * __pyx_v_bar.strides[0]) ))) + (*((int *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_17 * __pyx_v_bar.strides[0]) )))) &lt; 0) != 0);
        if (__pyx_t_7) {
/* … */
        }
      }
      __pyx_L6:;
</pre><pre class="cython line score-0">&#xA0;<span class="">306</span>:                     <span class="c"># Turn it around</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">307</span>:                     <span class="n">bar</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">bar</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-4 '>          <span class='trace'>__Pyx_TraceLine</span>(307,0,<span class='error_goto'>__PYX_ERR(0, 307, __pyx_L1_error)</span>)
          __pyx_t_18 = 2;
          __pyx_t_6 = -1;
          if (__pyx_t_18 &lt; 0) {
            __pyx_t_18 += __pyx_v_bar.shape[0];
            if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_6 = 0;
          } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
          if (unlikely(__pyx_t_6 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
            <span class='error_goto'>__PYX_ERR(0, 307, __pyx_L1_error)</span>
          }
          __pyx_t_19 = 2;
          __pyx_t_6 = -1;
          if (__pyx_t_19 &lt; 0) {
            __pyx_t_19 += __pyx_v_bar.shape[0];
            if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_6 = 0;
          } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
          if (unlikely(__pyx_t_6 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
            <span class='error_goto'>__PYX_ERR(0, 307, __pyx_L1_error)</span>
          }
          *((int *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_19 * __pyx_v_bar.strides[0]) )) = (-(*((int *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_18 * __pyx_v_bar.strides[0]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">308</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">309</span>:         <span class="n">bar</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">bar</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">bar</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-6 '>    <span class='trace'>__Pyx_TraceLine</span>(309,0,<span class='error_goto'>__PYX_ERR(0, 309, __pyx_L1_error)</span>)
    __pyx_t_20 = 0;
    __pyx_t_6 = -1;
    if (__pyx_t_20 &lt; 0) {
      __pyx_t_20 += __pyx_v_bar.shape[0];
      if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 309, __pyx_L1_error)</span>
    }
    __pyx_t_21 = 2;
    __pyx_t_6 = -1;
    if (__pyx_t_21 &lt; 0) {
      __pyx_t_21 += __pyx_v_bar.shape[0];
      if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 309, __pyx_L1_error)</span>
    }
    __pyx_t_22 = 0;
    __pyx_t_6 = -1;
    if (__pyx_t_22 &lt; 0) {
      __pyx_t_22 += __pyx_v_bar.shape[0];
      if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 309, __pyx_L1_error)</span>
    }
    *((int *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_22 * __pyx_v_bar.strides[0]) )) = ((*((int *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_20 * __pyx_v_bar.strides[0]) ))) + (*((int *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_21 * __pyx_v_bar.strides[0]) ))));
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">310</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">311</span>: </pre>
<pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">312</span>: <span class="k">cpdef</span> <span class="kt">int</span>[<span class="p">:]</span> <span class="n">prepair_rule</span><span class="p">(</span><span class="nb">int</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">rules</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">frame</span><span class="p">):</span></pre>
<pre class='cython code score-45 '>static PyObject *__pyx_pw_6Cfuncs_17prepair_rule(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static __Pyx_memviewslice __pyx_f_6Cfuncs_prepair_rule(__Pyx_memviewslice __pyx_v_rules, __Pyx_memviewslice __pyx_v_frame, CYTHON_UNUSED int __pyx_skip_dispatch) {
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("prepair_rule", 0);
  <span class='trace'>__Pyx_TraceCall</span>("prepair_rule", __pyx_f[0], 312, 0, <span class='error_goto'>__PYX_ERR(0, 312, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.prepair_rule", __pyx_clineno, __pyx_lineno, __pyx_filename);
  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_17prepair_rule(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_16prepair_rule[] = "\n    Prepairs rule for this frame\n\n    :param rules:       (list) full rule list\n    :param frame:       (int) framnumber\n    :return:            (pointer) current rule\n    ";
static PyObject *__pyx_pw_6Cfuncs_17prepair_rule(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_rules = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_frame = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("prepair_rule (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_rules,&amp;__pyx_n_s_frame,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_rules)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_frame)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("prepair_rule", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 312, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "prepair_rule") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 312, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_rules = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_rules.memview)) __PYX_ERR(0, 312, __pyx_L3_error)</span>
    __pyx_v_frame = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_frame.memview)) __PYX_ERR(0, 312, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("prepair_rule", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 312, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.prepair_rule", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_16prepair_rule(__pyx_self, __pyx_v_rules, __pyx_v_frame);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_16prepair_rule(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_rules, __Pyx_memviewslice __pyx_v_frame) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("prepair_rule", 0);
  <span class='trace'>__Pyx_TraceCall</span>("prepair_rule (wrapper)", __pyx_f[0], 312, 0, <span class='error_goto'>__PYX_ERR(0, 312, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_rules.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("rules"); <span class='error_goto'>__PYX_ERR(0, 312, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_frame.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("frame"); <span class='error_goto'>__PYX_ERR(0, 312, __pyx_L1_error)</span> }
  __pyx_t_1 = __pyx_f_6Cfuncs_prepair_rule(__pyx_v_rules, __pyx_v_frame, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 312, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_1, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.prepair_rule", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_rules, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_frame, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">313</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">314</span>: <span class="sd">    Prepairs rule for this frame</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">315</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">316</span>: <span class="sd">    :param rules:       (list) full rule list</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">317</span>: <span class="sd">    :param frame:       (int) framnumber</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">318</span>: <span class="sd">    :return:            (pointer) current rule</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">319</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">320</span>:     <span class="k">return</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="n">rules</span><span class="p">[</span><span class="n">frame</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">rules</span><span class="p">)])</span></pre>
<pre class='cython code score-28 '>  <span class='trace'>__Pyx_TraceLine</span>(320,0,<span class='error_goto'>__PYX_ERR(0, 320, __pyx_L1_error)</span>)
  __pyx_t_1 = 0;
  __pyx_t_2 = -1;
  if (__pyx_t_1 &lt; 0) {
    __pyx_t_1 += __pyx_v_frame.shape[0];
    if (unlikely(__pyx_t_1 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_1 &gt;= __pyx_v_frame.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 320, __pyx_L1_error)</span>
  }
  __pyx_t_2 = (*((int *) ( /* dim=0 */ (__pyx_v_frame.data + __pyx_t_1 * __pyx_v_frame.strides[0]) )));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_rules); 
  if (unlikely(__pyx_t_3 == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
    <span class='error_goto'>__PYX_ERR(0, 320, __pyx_L1_error)</span>
  }
  __pyx_t_4.data = __pyx_v_rules.data;
  __pyx_t_4.memview = __pyx_v_rules.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_4, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __Pyx_mod_Py_ssize_t(__pyx_t_2, __pyx_t_3);
        Py_ssize_t __pyx_tmp_shape = __pyx_v_rules.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_rules.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 320, __pyx_L1_error)</span>
        }
        __pyx_t_4.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_4.shape[0] = __pyx_v_rules.shape[1];
__pyx_t_4.strides[0] = __pyx_v_rules.strides[1];
    __pyx_t_4.suboffsets[0] = -1;

__pyx_t_5 = __pyx_memoryview_fromslice(__pyx_t_4, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 320, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 320, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 320, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 320, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">321</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">322</span>: </pre>
<pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">323</span>: <span class="k">cpdef</span> <span class="nf">advance_array</span><span class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">pos</span><span class="p">,</span> <span class="nb">int</span> <span class="n">length</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="n">buf</span><span class="p">):</span></pre>
<pre class='cython code score-52 '>static PyObject *__pyx_pw_6Cfuncs_19advance_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_6Cfuncs_advance_array(__Pyx_memviewslice __pyx_v_pos, int __pyx_v_length, __Pyx_memviewslice __pyx_v_buf, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("advance_array", 0);
  <span class='trace'>__Pyx_TraceCall</span>("advance_array", __pyx_f[0], 323, 0, <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.advance_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_19advance_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_18advance_array[] = "\n    Copys the array into the next buffer position.\n\n    :param pos:         (pointer) index of array\n    :param length:      (int) length of buffer\n    :param buf:         (3D pointer) buffer\n    :return:            None\n    ";
static PyObject *__pyx_pw_6Cfuncs_19advance_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_pos = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_length;
  __Pyx_memviewslice __pyx_v_buf = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("advance_array (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_pos,&amp;__pyx_n_s_length,&amp;__pyx_n_s_buf,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_pos)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_length)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("advance_array", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_buf)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("advance_array", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "advance_array") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_pos = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_pos.memview)) __PYX_ERR(0, 323, __pyx_L3_error)</span>
    __pyx_v_length = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]); if (unlikely((__pyx_v_length == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L3_error)</span>
    __pyx_v_buf = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_buf.memview)) __PYX_ERR(0, 323, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("advance_array", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.advance_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_18advance_array(__pyx_self, __pyx_v_pos, __pyx_v_length, __pyx_v_buf);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_18advance_array(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_pos, int __pyx_v_length, __Pyx_memviewslice __pyx_v_buf) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("advance_array", 0);
  <span class='trace'>__Pyx_TraceCall</span>("advance_array (wrapper)", __pyx_f[0], 323, 0, <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_pos.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("pos"); <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_buf.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("buf"); <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L1_error)</span> }
  __pyx_t_1 = __pyx_f_6Cfuncs_advance_array(__pyx_v_pos, __pyx_v_length, __pyx_v_buf, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.advance_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pos, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_buf, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">324</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">325</span>: <span class="sd">    Copys the array into the next buffer position.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">326</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">327</span>: <span class="sd">    :param pos:         (pointer) index of array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">328</span>: <span class="sd">    :param length:      (int) length of buffer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">329</span>: <span class="sd">    :param buf:         (3D pointer) buffer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">330</span>: <span class="sd">    :return:            None</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">331</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">332</span>:     <span class="n">buf</span><span class="p">[(</span><span class="n">pos</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">length</span><span class="p">]</span> <span class="o">=</span> <span class="n">buf</span><span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">%</span> <span class="n">length</span><span class="p">]</span></pre>
<pre class='cython code score-24 '>  <span class='trace'>__Pyx_TraceLine</span>(332,0,<span class='error_goto'>__PYX_ERR(0, 332, __pyx_L1_error)</span>)
  __pyx_t_1 = 0;
  __pyx_t_2 = -1;
  if (__pyx_t_1 &lt; 0) {
    __pyx_t_1 += __pyx_v_pos.shape[0];
    if (unlikely(__pyx_t_1 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_1 &gt;= __pyx_v_pos.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 332, __pyx_L1_error)</span>
  }
  __pyx_t_2 = (*((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_1 * __pyx_v_pos.strides[0]) )));
  if (unlikely(__pyx_v_length == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
    <span class='error_goto'>__PYX_ERR(0, 332, __pyx_L1_error)</span>
  }
  __pyx_t_3.data = __pyx_v_buf.data;
  __pyx_t_3.memview = __pyx_v_buf.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __Pyx_mod_int(__pyx_t_2, __pyx_v_length);
        Py_ssize_t __pyx_tmp_shape = __pyx_v_buf.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_buf.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 332, __pyx_L1_error)</span>
        }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3.shape[0] = __pyx_v_buf.shape[1];
__pyx_t_3.strides[0] = __pyx_v_buf.strides[1];
    __pyx_t_3.suboffsets[0] = -1;

__pyx_t_3.shape[1] = __pyx_v_buf.shape[2];
__pyx_t_3.strides[1] = __pyx_v_buf.strides[2];
    __pyx_t_3.suboffsets[1] = -1;

__pyx_t_4 = 0;
  __pyx_t_2 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_pos.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_pos.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 332, __pyx_L1_error)</span>
  }
  __pyx_t_5 = ((*((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_4 * __pyx_v_pos.strides[0]) ))) + 1);
  if (unlikely(__pyx_v_length == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
    <span class='error_goto'>__PYX_ERR(0, 332, __pyx_L1_error)</span>
  }
  __pyx_t_6.data = __pyx_v_buf.data;
  __pyx_t_6.memview = __pyx_v_buf.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_6, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __Pyx_mod_long(__pyx_t_5, __pyx_v_length);
        Py_ssize_t __pyx_tmp_shape = __pyx_v_buf.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_buf.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 332, __pyx_L1_error)</span>
        }
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_6.shape[0] = __pyx_v_buf.shape[1];
__pyx_t_6.strides[0] = __pyx_v_buf.strides[1];
    __pyx_t_6.suboffsets[0] = -1;

__pyx_t_6.shape[1] = __pyx_v_buf.shape[2];
__pyx_t_6.strides[1] = __pyx_v_buf.strides[2];
    __pyx_t_6.suboffsets[1] = -1;

if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_3, __pyx_t_6, 2, 2, 0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 332, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">333</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">334</span>: </pre>
<pre class="cython line score-104" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">335</span>: <span class="k">cpdef</span> <span class="nf">change_buffer</span><span class="p">(</span></pre>
<pre class='cython code score-104 '>static PyObject *__pyx_pw_6Cfuncs_21change_buffer(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_6Cfuncs_change_buffer(__Pyx_memviewslice __pyx_v_pos, int __pyx_v_length, __Pyx_memviewslice __pyx_v_dim_old, __Pyx_memviewslice __pyx_v_buf_old, __Pyx_memviewslice __pyx_v_dim_nu, __Pyx_memviewslice __pyx_v_buf_nu, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_6Cfuncs_change_buffer *__pyx_optional_args) {
  __Pyx_memviewslice __pyx_v_offset = __pyx_k__16;
  __Pyx_memviewslice __pyx_v_cut = __pyx_k__17;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("change_buffer", 0);
  <span class='trace'>__Pyx_TraceCall</span>("change_buffer", __pyx_f[0], 335, 0, <span class='error_goto'>__PYX_ERR(0, 335, __pyx_L1_error)</span>);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_offset = __pyx_optional_args-&gt;offset;
      if (__pyx_optional_args-&gt;__pyx_n &gt; 1) {
        __pyx_v_cut = __pyx_optional_args-&gt;cut;
      }
    }
  }
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_27, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.change_buffer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_21change_buffer(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_20change_buffer[] = "\n    Copys the array into a different buffer, resizing and repositioning it as specified.\n\n    :param pos:         (int) index of array\n    :param length:      (int) length of buffer\n    :param dim_old:     (pointer) dimensions of old buffer\n    :param buf_old:     (3D pointer) old buffer\n    :param dim_nu:      (pointer) dimensions of new buffer\n    :param buf_nu:      (3D pointer) new buffer\n    :param offset:      (pointer) offset of array in new buffer\n    :param cut:         (pointer) cut off sides of old buffer\n    :return:            None\n    ";
static PyObject *__pyx_pw_6Cfuncs_21change_buffer(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_pos = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_length;
  __Pyx_memviewslice __pyx_v_dim_old = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_buf_old = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dim_nu = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_buf_nu = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_offset = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_cut = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("change_buffer (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_pos,&amp;__pyx_n_s_length,&amp;__pyx_n_s_dim_old,&amp;__pyx_n_s_buf_old,&amp;__pyx_n_s_dim_nu,&amp;__pyx_n_s_buf_nu,&amp;__pyx_n_s_offset,&amp;__pyx_n_s_cut,0};
    PyObject* values[8] = {0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_pos)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_length)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("change_buffer", 0, 6, 8, 1); <span class='error_goto'>__PYX_ERR(0, 335, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim_old)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("change_buffer", 0, 6, 8, 2); <span class='error_goto'>__PYX_ERR(0, 335, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_buf_old)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("change_buffer", 0, 6, 8, 3); <span class='error_goto'>__PYX_ERR(0, 335, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim_nu)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("change_buffer", 0, 6, 8, 4); <span class='error_goto'>__PYX_ERR(0, 335, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_buf_nu)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("change_buffer", 0, 6, 8, 5); <span class='error_goto'>__PYX_ERR(0, 335, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_offset);
          if (value) { values[6] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_cut);
          if (value) { values[7] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "change_buffer") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 335, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_pos = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_pos.memview)) __PYX_ERR(0, 336, __pyx_L3_error)</span>
    __pyx_v_length = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]); if (unlikely((__pyx_v_length == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L3_error)</span>
    __pyx_v_dim_old = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim_old.memview)) __PYX_ERR(0, 336, __pyx_L3_error)</span>
    __pyx_v_buf_old = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_buf_old.memview)) __PYX_ERR(0, 336, __pyx_L3_error)</span>
    __pyx_v_dim_nu = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[4], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim_nu.memview)) __PYX_ERR(0, 337, __pyx_L3_error)</span>
    __pyx_v_buf_nu = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(values[5], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_buf_nu.memview)) __PYX_ERR(0, 337, __pyx_L3_error)</span>
    if (values[6]) {
      __pyx_v_offset = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[6], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_offset.memview)) __PYX_ERR(0, 338, __pyx_L3_error)</span>
    } else {
      __pyx_v_offset = __pyx_k__16;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_offset, 1);
    }
    if (values[7]) {
      __pyx_v_cut = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[7], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_cut.memview)) __PYX_ERR(0, 338, __pyx_L3_error)</span>
    } else {
      __pyx_v_cut = __pyx_k__17;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_cut, 1);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("change_buffer", 0, 6, 8, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 335, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.change_buffer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_20change_buffer(__pyx_self, __pyx_v_pos, __pyx_v_length, __pyx_v_dim_old, __pyx_v_buf_old, __pyx_v_dim_nu, __pyx_v_buf_nu, __pyx_v_offset, __pyx_v_cut);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_20change_buffer(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_pos, int __pyx_v_length, __Pyx_memviewslice __pyx_v_dim_old, __Pyx_memviewslice __pyx_v_buf_old, __Pyx_memviewslice __pyx_v_dim_nu, __Pyx_memviewslice __pyx_v_buf_nu, __Pyx_memviewslice __pyx_v_offset, __Pyx_memviewslice __pyx_v_cut) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("change_buffer", 0);
  <span class='trace'>__Pyx_TraceCall</span>("change_buffer (wrapper)", __pyx_f[0], 335, 0, <span class='error_goto'>__PYX_ERR(0, 335, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_pos.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("pos"); <span class='error_goto'>__PYX_ERR(0, 335, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_dim_old.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim_old"); <span class='error_goto'>__PYX_ERR(0, 335, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_buf_old.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("buf_old"); <span class='error_goto'>__PYX_ERR(0, 335, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_dim_nu.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim_nu"); <span class='error_goto'>__PYX_ERR(0, 335, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_buf_nu.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("buf_nu"); <span class='error_goto'>__PYX_ERR(0, 335, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_offset.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("offset"); <span class='error_goto'>__PYX_ERR(0, 335, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_cut.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("cut"); <span class='error_goto'>__PYX_ERR(0, 335, __pyx_L1_error)</span> }
  __pyx_t_2.__pyx_n = 2;
  __pyx_t_2.offset = __pyx_v_offset;
  __pyx_t_2.cut = __pyx_v_cut;
  __pyx_t_1 = __pyx_f_6Cfuncs_change_buffer(__pyx_v_pos, __pyx_v_length, __pyx_v_dim_old, __pyx_v_buf_old, __pyx_v_dim_nu, __pyx_v_buf_nu, 0, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.change_buffer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pos, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim_old, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_buf_old, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim_nu, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_buf_nu, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_offset, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_cut, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">336</span>:     <span class="nb">int</span><span class="p">[:]</span> <span class="n">pos</span><span class="p">,</span> <span class="nb">int</span> <span class="n">length</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim_old</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="n">buf_old</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>struct __pyx_opt_args_6Cfuncs_change_buffer {
  int __pyx_n;
  __Pyx_memviewslice offset;
  __Pyx_memviewslice cut;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">337</span>:     <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim_nu</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="n">buf_nu</span><span class="p">,</span></pre>
<pre class="cython line score-92" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">338</span>:     <span class="nb">int</span><span class="p">[:]</span> <span class="n">offset</span><span class="o">=</span><span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">1</span><span class="p">,</span><span class="mf">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">cut</span><span class="o">=</span><span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-92 '>  <span class='trace'>__Pyx_TraceLine</span>(338,0,<span class='error_goto'>__PYX_ERR(0, 338, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_1);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_k__16 = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_0);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_k__17 = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(335,0,<span class='error_goto'>__PYX_ERR(0, 335, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_1);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(338,0,<span class='error_goto'>__PYX_ERR(0, 338, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_k__16 = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_0);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_k__17 = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">339</span>: <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">340</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">341</span>: <span class="sd">    Copys the array into a different buffer, resizing and repositioning it as specified.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">342</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">343</span>: <span class="sd">    :param pos:         (int) index of array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">344</span>: <span class="sd">    :param length:      (int) length of buffer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">345</span>: <span class="sd">    :param dim_old:     (pointer) dimensions of old buffer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">346</span>: <span class="sd">    :param buf_old:     (3D pointer) old buffer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">347</span>: <span class="sd">    :param dim_nu:      (pointer) dimensions of new buffer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">348</span>: <span class="sd">    :param buf_nu:      (3D pointer) new buffer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">349</span>: <span class="sd">    :param offset:      (pointer) offset of array in new buffer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">350</span>: <span class="sd">    :param cut:         (pointer) cut off sides of old buffer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">351</span>: <span class="sd">    :return:            None</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">352</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-57" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">353</span>:     <span class="n">cy</span><span class="o">.</span><span class="n">clear_array</span><span class="p">(</span><span class="n">dim_nu</span><span class="p">,</span> <span class="n">buf_nu</span><span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">%</span> <span class="n">length</span><span class="p">])</span></pre>
<pre class='cython code score-57 '>  <span class='trace'>__Pyx_TraceLine</span>(353,0,<span class='error_goto'>__PYX_ERR(0, 353, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_cy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_clear_array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_dim_nu, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = 0;
  __pyx_t_5 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_pos.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_pos.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 353, __pyx_L1_error)</span>
  }
  __pyx_t_5 = (*((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_4 * __pyx_v_pos.strides[0]) )));
  if (unlikely(__pyx_v_length == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
    <span class='error_goto'>__PYX_ERR(0, 353, __pyx_L1_error)</span>
  }
  __pyx_t_6.data = __pyx_v_buf_nu.data;
  __pyx_t_6.memview = __pyx_v_buf_nu.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_6, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __Pyx_mod_int(__pyx_t_5, __pyx_v_length);
        Py_ssize_t __pyx_tmp_shape = __pyx_v_buf_nu.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_buf_nu.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 353, __pyx_L1_error)</span>
        }
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_6.shape[0] = __pyx_v_buf_nu.shape[1];
__pyx_t_6.strides[0] = __pyx_v_buf_nu.strides[1];
    __pyx_t_6.suboffsets[0] = -1;

__pyx_t_6.shape[1] = __pyx_v_buf_nu.shape[2];
__pyx_t_6.strides[1] = __pyx_v_buf_nu.strides[2];
    __pyx_t_6.suboffsets[1] = -1;

__pyx_t_7 = __pyx_memoryview_fromslice(__pyx_t_6, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
  __pyx_t_8 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_5 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_8, __pyx_t_2, __pyx_t_7};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_8, __pyx_t_2, __pyx_t_7};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  {
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (__pyx_t_8) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8); __pyx_t_8 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_5, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_5, __pyx_t_7);
    __pyx_t_2 = 0;
    __pyx_t_7 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">354</span>:     <span class="n">buf_nu</span><span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">%</span> <span class="n">length</span><span class="p">,</span> <span class="n">offset</span><span class="p">[</span><span class="mf">0</span><span class="p">]:</span> <span class="n">offset</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">dim_old</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">cut</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">2</span><span class="p">,</span>\</pre>
<pre class='cython code score-20 '>__pyx_t_18 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(354,0,<span class='error_goto'>__PYX_ERR(0, 354, __pyx_L1_error)</span>)
  __pyx_t_5 = -1;
  if (__pyx_t_18 &lt; 0) {
    __pyx_t_18 += __pyx_v_pos.shape[0];
    if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_pos.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 354, __pyx_L1_error)</span>
  }
  __pyx_t_5 = (*((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_18 * __pyx_v_pos.strides[0]) )));
  if (unlikely(__pyx_v_length == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
    <span class='error_goto'>__PYX_ERR(0, 354, __pyx_L1_error)</span>
  }
  __pyx_t_19 = 0;
  __pyx_t_12 = -1;
  if (__pyx_t_19 &lt; 0) {
    __pyx_t_19 += __pyx_v_offset.shape[0];
    if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_12 = 0;
  } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_offset.shape[0])) __pyx_t_12 = 0;
  if (unlikely(__pyx_t_12 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
    <span class='error_goto'>__PYX_ERR(0, 354, __pyx_L1_error)</span>
  }
  __pyx_t_20 = 0;
  __pyx_t_12 = -1;
  if (__pyx_t_20 &lt; 0) {
    __pyx_t_20 += __pyx_v_offset.shape[0];
    if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_12 = 0;
  } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_offset.shape[0])) __pyx_t_12 = 0;
  if (unlikely(__pyx_t_12 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
    <span class='error_goto'>__PYX_ERR(0, 354, __pyx_L1_error)</span>
  }
  __pyx_t_21 = 0;
  __pyx_t_12 = -1;
  if (__pyx_t_21 &lt; 0) {
    __pyx_t_21 += __pyx_v_dim_old.shape[0];
    if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_12 = 0;
  } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_dim_old.shape[0])) __pyx_t_12 = 0;
  if (unlikely(__pyx_t_12 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
    <span class='error_goto'>__PYX_ERR(0, 354, __pyx_L1_error)</span>
  }
  __pyx_t_22 = 0;
  __pyx_t_12 = -1;
  if (__pyx_t_22 &lt; 0) {
    __pyx_t_22 += __pyx_v_cut.shape[0];
    if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_12 = 0;
  } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_cut.shape[0])) __pyx_t_12 = 0;
  if (unlikely(__pyx_t_12 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
    <span class='error_goto'>__PYX_ERR(0, 354, __pyx_L1_error)</span>
  }
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(354,0,<span class='error_goto'>__PYX_ERR(0, 354, __pyx_L1_error)</span>)
  __pyx_t_27.data = __pyx_v_buf_nu.data;
  __pyx_t_27.memview = __pyx_v_buf_nu.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_27, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __Pyx_mod_int(__pyx_t_5, __pyx_v_length);
        Py_ssize_t __pyx_tmp_shape = __pyx_v_buf_nu.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_buf_nu.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 354, __pyx_L1_error)</span>
        }
        __pyx_t_27.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_12 = -1;
  if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_27,
    __pyx_v_buf_nu.shape[1], __pyx_v_buf_nu.strides[1], __pyx_v_buf_nu.suboffsets[1],
    1,
    0,
    &amp;__pyx_t_12,
    (*((int *) ( /* dim=0 */ (__pyx_v_offset.data + __pyx_t_19 * __pyx_v_offset.strides[0]) ))),
    (((*((int *) ( /* dim=0 */ (__pyx_v_offset.data + __pyx_t_20 * __pyx_v_offset.strides[0]) ))) + (*((int *) ( /* dim=0 */ (__pyx_v_dim_old.data + __pyx_t_21 * __pyx_v_dim_old.strides[0]) )))) - ((*((int *) ( /* dim=0 */ (__pyx_v_cut.data + __pyx_t_22 * __pyx_v_cut.strides[0]) ))) * 2)),
    0,
    1,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 354, __pyx_L1_error)</span>
}

if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_27,
    __pyx_v_buf_nu.shape[2], __pyx_v_buf_nu.strides[2], __pyx_v_buf_nu.suboffsets[2],
    2,
    1,
    &amp;__pyx_t_12,
    (*((int *) ( /* dim=0 */ (__pyx_v_offset.data + __pyx_t_23 * __pyx_v_offset.strides[0]) ))),
    (((*((int *) ( /* dim=0 */ (__pyx_v_offset.data + __pyx_t_24 * __pyx_v_offset.strides[0]) ))) + (*((int *) ( /* dim=0 */ (__pyx_v_dim_old.data + __pyx_t_25 * __pyx_v_dim_old.strides[0]) )))) - ((*((int *) ( /* dim=0 */ (__pyx_v_cut.data + __pyx_t_26 * __pyx_v_cut.strides[0]) ))) * 2)),
    0,
    1,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 354, __pyx_L1_error)</span>
}

if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_6, __pyx_t_27, 2, 2, 0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 354, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_27, 1);
  __pyx_t_27.memview = NULL;
  __pyx_t_27.data = NULL;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">355</span>:                 <span class="n">offset</span><span class="p">[</span><span class="mf">1</span><span class="p">]:</span> <span class="n">offset</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dim_old</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">cut</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span>\</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(355,0,<span class='error_goto'>__PYX_ERR(0, 355, __pyx_L1_error)</span>)
  __pyx_t_23 = 1;
  __pyx_t_12 = -1;
  if (__pyx_t_23 &lt; 0) {
    __pyx_t_23 += __pyx_v_offset.shape[0];
    if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_12 = 0;
  } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_offset.shape[0])) __pyx_t_12 = 0;
  if (unlikely(__pyx_t_12 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
    <span class='error_goto'>__PYX_ERR(0, 355, __pyx_L1_error)</span>
  }
  __pyx_t_24 = 1;
  __pyx_t_12 = -1;
  if (__pyx_t_24 &lt; 0) {
    __pyx_t_24 += __pyx_v_offset.shape[0];
    if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_12 = 0;
  } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_offset.shape[0])) __pyx_t_12 = 0;
  if (unlikely(__pyx_t_12 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
    <span class='error_goto'>__PYX_ERR(0, 355, __pyx_L1_error)</span>
  }
  __pyx_t_25 = 1;
  __pyx_t_12 = -1;
  if (__pyx_t_25 &lt; 0) {
    __pyx_t_25 += __pyx_v_dim_old.shape[0];
    if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_12 = 0;
  } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_dim_old.shape[0])) __pyx_t_12 = 0;
  if (unlikely(__pyx_t_12 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
    <span class='error_goto'>__PYX_ERR(0, 355, __pyx_L1_error)</span>
  }
  __pyx_t_26 = 1;
  __pyx_t_12 = -1;
  if (__pyx_t_26 &lt; 0) {
    __pyx_t_26 += __pyx_v_cut.shape[0];
    if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_12 = 0;
  } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_cut.shape[0])) __pyx_t_12 = 0;
  if (unlikely(__pyx_t_12 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
    <span class='error_goto'>__PYX_ERR(0, 355, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">356</span>:         <span class="n">buf_old</span><span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">%</span> <span class="n">length</span><span class="p">,</span> <span class="n">cut</span><span class="p">[</span><span class="mf">0</span><span class="p">]:</span> <span class="n">dim_old</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">cut</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span>\</pre>
<pre class='cython code score-18 '>  <span class='trace'>__Pyx_TraceLine</span>(356,0,<span class='error_goto'>__PYX_ERR(0, 356, __pyx_L1_error)</span>)
  __pyx_t_10 = 0;
  __pyx_t_5 = -1;
  if (__pyx_t_10 &lt; 0) {
    __pyx_t_10 += __pyx_v_pos.shape[0];
    if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_pos.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 356, __pyx_L1_error)</span>
  }
  __pyx_t_5 = (*((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_10 * __pyx_v_pos.strides[0]) )));
  if (unlikely(__pyx_v_length == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
    <span class='error_goto'>__PYX_ERR(0, 356, __pyx_L1_error)</span>
  }
  __pyx_t_11 = 0;
  __pyx_t_12 = -1;
  if (__pyx_t_11 &lt; 0) {
    __pyx_t_11 += __pyx_v_cut.shape[0];
    if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_12 = 0;
  } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_cut.shape[0])) __pyx_t_12 = 0;
  if (unlikely(__pyx_t_12 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
    <span class='error_goto'>__PYX_ERR(0, 356, __pyx_L1_error)</span>
  }
  __pyx_t_13 = 0;
  __pyx_t_12 = -1;
  if (__pyx_t_13 &lt; 0) {
    __pyx_t_13 += __pyx_v_dim_old.shape[0];
    if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_12 = 0;
  } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_dim_old.shape[0])) __pyx_t_12 = 0;
  if (unlikely(__pyx_t_12 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
    <span class='error_goto'>__PYX_ERR(0, 356, __pyx_L1_error)</span>
  }
  __pyx_t_14 = 0;
  __pyx_t_12 = -1;
  if (__pyx_t_14 &lt; 0) {
    __pyx_t_14 += __pyx_v_cut.shape[0];
    if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_12 = 0;
  } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_cut.shape[0])) __pyx_t_12 = 0;
  if (unlikely(__pyx_t_12 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
    <span class='error_goto'>__PYX_ERR(0, 356, __pyx_L1_error)</span>
  }
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(356,0,<span class='error_goto'>__PYX_ERR(0, 356, __pyx_L1_error)</span>)
  __pyx_t_6.data = __pyx_v_buf_old.data;
  __pyx_t_6.memview = __pyx_v_buf_old.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_6, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __Pyx_mod_int(__pyx_t_5, __pyx_v_length);
        Py_ssize_t __pyx_tmp_shape = __pyx_v_buf_old.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_buf_old.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 356, __pyx_L1_error)</span>
        }
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_12 = -1;
  if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_6,
    __pyx_v_buf_old.shape[1], __pyx_v_buf_old.strides[1], __pyx_v_buf_old.suboffsets[1],
    1,
    0,
    &amp;__pyx_t_12,
    (*((int *) ( /* dim=0 */ (__pyx_v_cut.data + __pyx_t_11 * __pyx_v_cut.strides[0]) ))),
    ((*((int *) ( /* dim=0 */ (__pyx_v_dim_old.data + __pyx_t_13 * __pyx_v_dim_old.strides[0]) ))) - (*((int *) ( /* dim=0 */ (__pyx_v_cut.data + __pyx_t_14 * __pyx_v_cut.strides[0]) )))),
    0,
    1,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 356, __pyx_L1_error)</span>
}

if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_6,
    __pyx_v_buf_old.shape[2], __pyx_v_buf_old.strides[2], __pyx_v_buf_old.suboffsets[2],
    2,
    1,
    &amp;__pyx_t_12,
    (*((int *) ( /* dim=0 */ (__pyx_v_cut.data + __pyx_t_15 * __pyx_v_cut.strides[0]) ))),
    ((*((int *) ( /* dim=0 */ (__pyx_v_dim_old.data + __pyx_t_16 * __pyx_v_dim_old.strides[0]) ))) - (*((int *) ( /* dim=0 */ (__pyx_v_cut.data + __pyx_t_17 * __pyx_v_cut.strides[0]) )))),
    0,
    1,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 356, __pyx_L1_error)</span>
}

</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">357</span>:                      <span class="n">cut</span><span class="p">[</span><span class="mf">1</span><span class="p">]:</span> <span class="n">dim_old</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">cut</span><span class="p">[</span><span class="mf">1</span><span class="p">]]</span></pre>
<pre class='cython code score-6 '>  <span class='trace'>__Pyx_TraceLine</span>(357,0,<span class='error_goto'>__PYX_ERR(0, 357, __pyx_L1_error)</span>)
  __pyx_t_15 = 1;
  __pyx_t_12 = -1;
  if (__pyx_t_15 &lt; 0) {
    __pyx_t_15 += __pyx_v_cut.shape[0];
    if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_12 = 0;
  } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_cut.shape[0])) __pyx_t_12 = 0;
  if (unlikely(__pyx_t_12 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
    <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L1_error)</span>
  }
  __pyx_t_16 = 1;
  __pyx_t_12 = -1;
  if (__pyx_t_16 &lt; 0) {
    __pyx_t_16 += __pyx_v_dim_old.shape[0];
    if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_12 = 0;
  } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_dim_old.shape[0])) __pyx_t_12 = 0;
  if (unlikely(__pyx_t_12 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
    <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L1_error)</span>
  }
  __pyx_t_17 = 1;
  __pyx_t_12 = -1;
  if (__pyx_t_17 &lt; 0) {
    __pyx_t_17 += __pyx_v_cut.shape[0];
    if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_12 = 0;
  } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_cut.shape[0])) __pyx_t_12 = 0;
  if (unlikely(__pyx_t_12 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
    <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">358</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">359</span>: </pre>
<pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">360</span>: <span class="k">cpdef</span> <span class="kt">int</span>[<span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="n">init_array_buffer</span><span class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span> <span class="n">length</span><span class="p">):</span></pre>
<pre class='cython code score-52 '>static PyObject *__pyx_pw_6Cfuncs_23init_array_buffer(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static __Pyx_memviewslice __pyx_f_6Cfuncs_init_array_buffer(__Pyx_memviewslice __pyx_v_dim, int __pyx_v_length, CYTHON_UNUSED int __pyx_skip_dispatch) {
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("init_array_buffer", 0);
  <span class='trace'>__Pyx_TraceCall</span>("init_array_buffer", __pyx_f[0], 360, 0, <span class='error_goto'>__PYX_ERR(0, 360, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.init_array_buffer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_23init_array_buffer(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_22init_array_buffer[] = "\n    Creates a buffer array.\n    Buffer is uninitialized. This is essentially a (safe, easy) malloc.\n\n    :param dim:     (pointer) size of the array\n    :param length:  (int) buffer_size\n    :return:        (3D pointer) new array buffer\n    ";
static PyObject *__pyx_pw_6Cfuncs_23init_array_buffer(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_length;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("init_array_buffer (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_dim,&amp;__pyx_n_s_length,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_length)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("init_array_buffer", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 360, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "init_array_buffer") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 360, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 360, __pyx_L3_error)</span>
    __pyx_v_length = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]); if (unlikely((__pyx_v_length == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 360, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("init_array_buffer", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 360, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.init_array_buffer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_22init_array_buffer(__pyx_self, __pyx_v_dim, __pyx_v_length);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_22init_array_buffer(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_dim, int __pyx_v_length) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("init_array_buffer", 0);
  <span class='trace'>__Pyx_TraceCall</span>("init_array_buffer (wrapper)", __pyx_f[0], 360, 0, <span class='error_goto'>__PYX_ERR(0, 360, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 360, __pyx_L1_error)</span> }
  __pyx_t_1 = __pyx_f_6Cfuncs_init_array_buffer(__pyx_v_dim, __pyx_v_length, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 360, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_1, 3, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 360, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.init_array_buffer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">361</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">362</span>: <span class="sd">    Creates a buffer array.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">363</span>: <span class="sd">    Buffer is uninitialized. This is essentially a (safe, easy) malloc.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">364</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">365</span>: <span class="sd">    :param dim:     (pointer) size of the array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">366</span>: <span class="sd">    :param length:  (int) buffer_size</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">367</span>: <span class="sd">    :return:        (3D pointer) new array buffer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">368</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-70" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">369</span>:     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="n">length</span><span class="p">,</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]],</span> <span class="n">np</span><span class="o">.</span><span class="n">intc</span><span class="p">)</span></pre>
<pre class='cython code score-70 '>  <span class='trace'>__Pyx_TraceLine</span>(369,0,<span class='error_goto'>__PYX_ERR(0, 369, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 369, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 369, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_length);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 369, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = 0;
  __pyx_t_5 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_dim.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 369, __pyx_L1_error)</span>
  }
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_4 * __pyx_v_dim.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 369, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = 1;
  __pyx_t_5 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_dim.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 369, __pyx_L1_error)</span>
  }
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_7 * __pyx_v_dim.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 369, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 369, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 2, __pyx_t_8);
  __pyx_t_2 = 0;
  __pyx_t_6 = 0;
  __pyx_t_8 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 369, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 369, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_5 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_8, __pyx_t_9, __pyx_t_6};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 369, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_8, __pyx_t_9, __pyx_t_6};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 369, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else
  #endif
  {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 369, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (__pyx_t_8) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_8); __pyx_t_8 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+__pyx_t_5, __pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1+__pyx_t_5, __pyx_t_6);
    __pyx_t_9 = 0;
    __pyx_t_6 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 369, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 369, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">370</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">371</span>: </pre>
<pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">372</span>: <span class="k">cpdef</span> <span class="kt">tuple</span> <span class="nf">resize_array_buffer</span><span class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">dim_old</span><span class="p">,</span> <span class="nb">int</span> <span class="n">length</span><span class="p">,</span> <span class="nb">int</span> <span class="n">add</span><span class="o">=</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-55 '>static PyObject *__pyx_pw_6Cfuncs_25resize_array_buffer(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_6Cfuncs_resize_array_buffer(__Pyx_memviewslice __pyx_v_dim_old, int __pyx_v_length, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_6Cfuncs_resize_array_buffer *__pyx_optional_args) {
  int __pyx_v_add = ((int)1);
  __Pyx_memviewslice __pyx_v_dim_v = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_buf_v = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("resize_array_buffer", 0);
  <span class='trace'>__Pyx_TraceCall</span>("resize_array_buffer", __pyx_f[0], 372, 0, <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L1_error)</span>);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_add = __pyx_optional_args-&gt;add;
    }
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.resize_array_buffer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim_v, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_buf_v, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_25resize_array_buffer(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_24resize_array_buffer[] = "\n    Creates a new array buffer, larger than the last\n    Buffer is uninitialized. This is essentially a (safe, easy) malloc.\n\n    :param dim_old:     (pointer) size of the array\n    :param length:      (int) buffer length\n    :param add:         amount of space to add at the edges of the new array\n    :return:            dim_v, buf_v\n    ";
static PyObject *__pyx_pw_6Cfuncs_25resize_array_buffer(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_dim_old = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_length;
  int __pyx_v_add;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("resize_array_buffer (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_dim_old,&amp;__pyx_n_s_length,&amp;__pyx_n_s_add,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim_old)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_length)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("resize_array_buffer", 0, 2, 3, 1); <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_add);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "resize_array_buffer") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_dim_old = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim_old.memview)) __PYX_ERR(0, 372, __pyx_L3_error)</span>
    __pyx_v_length = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]); if (unlikely((__pyx_v_length == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
    if (values[2]) {
      __pyx_v_add = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[2]); if (unlikely((__pyx_v_add == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
    } else {
      __pyx_v_add = ((int)1);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("resize_array_buffer", 0, 2, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.resize_array_buffer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_24resize_array_buffer(__pyx_self, __pyx_v_dim_old, __pyx_v_length, __pyx_v_add);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_24resize_array_buffer(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_dim_old, int __pyx_v_length, int __pyx_v_add) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("resize_array_buffer", 0);
  <span class='trace'>__Pyx_TraceCall</span>("resize_array_buffer (wrapper)", __pyx_f[0], 372, 0, <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_dim_old.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim_old"); <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L1_error)</span> }
  __pyx_t_2.__pyx_n = 1;
  __pyx_t_2.add = __pyx_v_add;
  __pyx_t_1 = __pyx_f_6Cfuncs_resize_array_buffer(__pyx_v_dim_old, __pyx_v_length, 0, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 372, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.resize_array_buffer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim_old, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_opt_args_6Cfuncs_resize_array_buffer {
  int __pyx_n;
  int add;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">373</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">374</span>: <span class="sd">    Creates a new array buffer, larger than the last</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">375</span>: <span class="sd">    Buffer is uninitialized. This is essentially a (safe, easy) malloc.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">376</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">377</span>: <span class="sd">    :param dim_old:     (pointer) size of the array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">378</span>: <span class="sd">    :param length:      (int) buffer length</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">379</span>: <span class="sd">    :param add:         amount of space to add at the edges of the new array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">380</span>: <span class="sd">    :return:            dim_v, buf_v</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">381</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">382</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:]</span> <span class="n">dim_v</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">dim_old</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">add</span> <span class="o">*</span> <span class="mf">2</span><span class="p">,</span> <span class="n">dim_old</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">add</span> <span class="o">*</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-29 '>  <span class='trace'>__Pyx_TraceLine</span>(382,0,<span class='error_goto'>__PYX_ERR(0, 382, __pyx_L1_error)</span>)
  __pyx_t_1 = 0;
  __pyx_t_2 = -1;
  if (__pyx_t_1 &lt; 0) {
    __pyx_t_1 += __pyx_v_dim_old.shape[0];
    if (unlikely(__pyx_t_1 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_1 &gt;= __pyx_v_dim_old.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 382, __pyx_L1_error)</span>
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(((*((int *) ( /* dim=0 */ (__pyx_v_dim_old.data + __pyx_t_1 * __pyx_v_dim_old.strides[0]) ))) + (__pyx_v_add * 2)));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 382, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = 1;
  __pyx_t_2 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_dim_old.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_dim_old.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 382, __pyx_L1_error)</span>
  }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(((*((int *) ( /* dim=0 */ (__pyx_v_dim_old.data + __pyx_t_4 * __pyx_v_dim_old.strides[0]) ))) + (__pyx_v_add * 2)));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 382, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 382, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_5);
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 382, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 382, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_6, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 382, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_dim_v = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">383</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="n">buf_v</span> <span class="o">=</span> <span class="n">init_array_buffer</span><span class="p">(</span><span class="n">dim_v</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(383,0,<span class='error_goto'>__PYX_ERR(0, 383, __pyx_L1_error)</span>)
  __pyx_t_8 = __pyx_f_6Cfuncs_init_array_buffer(__pyx_v_dim_v, __pyx_v_length, 0);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 383, __pyx_L1_error)</span>
  __pyx_v_buf_v = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">384</span>:     <span class="k">return</span> <span class="n">dim_v</span><span class="p">,</span> <span class="n">buf_v</span></pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(384,0,<span class='error_goto'>__PYX_ERR(0, 384, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_dim_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 384, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_buf_v, 3, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 384, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 384, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_5);
  __pyx_t_6 = 0;
  __pyx_t_5 = 0;
  __pyx_r = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">385</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">386</span>: </pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">387</span>: <span class="k">cpdef</span> <span class="kt">int</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">init_array</span><span class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">dim_v</span><span class="p">):</span></pre>
<pre class='cython code score-23 '>static PyObject *__pyx_pw_6Cfuncs_27init_array(PyObject *__pyx_self, PyObject *__pyx_arg_dim_v); /*proto*/
static __Pyx_memviewslice __pyx_f_6Cfuncs_init_array(__Pyx_memviewslice __pyx_v_dim_v, CYTHON_UNUSED int __pyx_skip_dispatch) {
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("init_array", 0);
  <span class='trace'>__Pyx_TraceCall</span>("init_array", __pyx_f[0], 387, 0, <span class='error_goto'>__PYX_ERR(0, 387, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.init_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_27init_array(PyObject *__pyx_self, PyObject *__pyx_arg_dim_v); /*proto*/
static char __pyx_doc_6Cfuncs_26init_array[] = "\n    Creates a little array.\n\n    :param size:    (pointer) size of the array\n    :return:        (pointer) dim_v, (pointer) arr_v, (arr) rule\n    ";
static PyObject *__pyx_pw_6Cfuncs_27init_array(PyObject *__pyx_self, PyObject *__pyx_arg_dim_v) {
  __Pyx_memviewslice __pyx_v_dim_v = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("init_array (wrapper)", 0);
  assert(__pyx_arg_dim_v); {
    __pyx_v_dim_v = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_arg_dim_v, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim_v.memview)) __PYX_ERR(0, 387, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.init_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_26init_array(__pyx_self, __pyx_v_dim_v);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_26init_array(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_dim_v) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("init_array", 0);
  <span class='trace'>__Pyx_TraceCall</span>("init_array (wrapper)", __pyx_f[0], 387, 0, <span class='error_goto'>__PYX_ERR(0, 387, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_dim_v.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim_v"); <span class='error_goto'>__PYX_ERR(0, 387, __pyx_L1_error)</span> }
  __pyx_t_1 = __pyx_f_6Cfuncs_init_array(__pyx_v_dim_v, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 387, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_1, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 387, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.init_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim_v, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">388</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">389</span>: <span class="sd">    Creates a little array.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">390</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">391</span>: <span class="sd">    :param size:    (pointer) size of the array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">392</span>: <span class="sd">    :return:        (pointer) dim_v, (pointer) arr_v, (arr) rule</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">393</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">394</span>:     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">dim_v</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">intc</span><span class="p">)</span></pre>
<pre class='cython code score-52 '>  <span class='trace'>__Pyx_TraceLine</span>(394,0,<span class='error_goto'>__PYX_ERR(0, 394, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 394, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 394, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_dim_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 394, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 394, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 394, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_2, __pyx_t_5};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 394, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_2, __pyx_t_5};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 394, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else
  #endif
  {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 394, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (__pyx_t_4) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_4); __pyx_t_4 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_6, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_6, __pyx_t_5);
    __pyx_t_2 = 0;
    __pyx_t_5 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 394, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 394, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">395</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">396</span>: </pre>
<pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">397</span>: <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">scroll_noise</span><span class="p">(</span></pre>
<pre class='cython code score-46 '>static PyObject *__pyx_pw_6Cfuncs_29scroll_noise(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static void __pyx_f_6Cfuncs_scroll_noise(__Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_6Cfuncs_scroll_noise *__pyx_optional_args) {
  __Pyx_memviewslice __pyx_v_bars = __pyx_k__18;
  __Pyx_memviewslice __pyx_v_bar = { 0, 0, { 0 }, { 0 }, { 0 } };
  Py_ssize_t __pyx_v_i;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("scroll_noise", 0);
  <span class='trace'>__Pyx_TraceCall</span>("scroll_noise", __pyx_f[0], 397, 0, <span class='error_goto'>__PYX_ERR(0, 397, __pyx_L1_error)</span>);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_bars = __pyx_optional_args-&gt;bars;
    }
  }
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("Cfuncs.scroll_noise", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bar, 1);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_29scroll_noise(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_28scroll_noise[] = "\n    Updates a region of the screen.\n\n    :param dim:\n    :param arr:\n    :param fuzz:     [start, width, step, axis, bounce, coverage, polarity (-2 is off)]\n    :param coverage:    coverage of the line\n    :returns:       None\n    ";
static PyObject *__pyx_pw_6Cfuncs_29scroll_noise(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_bars = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("scroll_noise (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,&amp;__pyx_n_s_bars,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("scroll_noise", 0, 2, 3, 1); <span class='error_goto'>__PYX_ERR(0, 397, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bars);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "scroll_noise") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 397, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 398, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 398, __pyx_L3_error)</span>
    if (values[2]) {
      __pyx_v_bars = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_bars.memview)) __PYX_ERR(0, 399, __pyx_L3_error)</span>
    } else {
      __pyx_v_bars = __pyx_k__18;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_bars, 1);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("scroll_noise", 0, 2, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 397, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.scroll_noise", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_28scroll_noise(__pyx_self, __pyx_v_dim, __pyx_v_arr, __pyx_v_bars);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_28scroll_noise(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, __Pyx_memviewslice __pyx_v_bars) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("scroll_noise", 0);
  <span class='trace'>__Pyx_TraceCall</span>("scroll_noise (wrapper)", __pyx_f[0], 397, 0, <span class='error_goto'>__PYX_ERR(0, 397, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 397, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 397, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_bars.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("bars"); <span class='error_goto'>__PYX_ERR(0, 397, __pyx_L1_error)</span> }
  __pyx_t_1.__pyx_n = 1;
  __pyx_t_1.bars = __pyx_v_bars;
  __pyx_f_6Cfuncs_scroll_noise(__pyx_v_dim, __pyx_v_arr, 0, &amp;__pyx_t_1); 
  __pyx_t_2 = __Pyx_void_to_None(NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 397, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.scroll_noise", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bars, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_opt_args_6Cfuncs_scroll_noise {
  int __pyx_n;
  __Pyx_memviewslice bars;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">398</span>:     <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">arr</span><span class="p">,</span></pre>
<pre class="cython line score-98" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">399</span>:     <span class="n">double</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">bars</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">5</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1</span><span class="p">]],</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">),</span></pre>
<pre class='cython code score-98 '>  <span class='trace'>__Pyx_TraceLine</span>(399,0,<span class='error_goto'>__PYX_ERR(0, 399, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 399, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 399, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 399, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 3, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 4, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_0_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_0_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 5, __pyx_float_0_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 6, __pyx_int_1);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 399, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 399, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 399, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 399, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_2);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 399, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 399, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_k__18 = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(397,0,<span class='error_goto'>__PYX_ERR(0, 397, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 399, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(399,0,<span class='error_goto'>__PYX_ERR(0, 399, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 399, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 399, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 2, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 3, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 4, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_0_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_0_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 5, __pyx_float_0_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 6, __pyx_int_1);
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 399, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 399, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 399, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 399, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
  __pyx_t_5 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 399, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 399, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_k__18 = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">400</span>: <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">401</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">402</span>: <span class="sd">    Updates a region of the screen.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">403</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">404</span>: <span class="sd">    :param dim:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">405</span>: <span class="sd">    :param arr:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">406</span>: <span class="sd">    :param fuzz:     [start, width, step, axis, bounce, coverage, polarity (-2 is off)]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">407</span>: <span class="sd">    :param coverage:    coverage of the line</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">408</span>: <span class="sd">    :returns:       None</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">409</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">410</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">411</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">bar</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">412</span>:     <span class="k">cdef</span> <span class="kt">Py_ssize_t</span> <span class="nf">i</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">413</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bars</span><span class="p">)):</span></pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(413,0,<span class='error_goto'>__PYX_ERR(0, 413, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_bars); 
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">414</span>:         <span class="n">bar</span> <span class="o">=</span> <span class="n">bars</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(414,0,<span class='error_goto'>__PYX_ERR(0, 414, __pyx_L1_error)</span>)
    __pyx_t_4.data = __pyx_v_bars.data;
    __pyx_t_4.memview = __pyx_v_bars.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_4, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_bars.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_bars.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape)) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 414, __pyx_L1_error)</span>
        }
        __pyx_t_4.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_4.shape[0] = __pyx_v_bars.shape[1];
__pyx_t_4.strides[0] = __pyx_v_bars.strides[1];
    __pyx_t_4.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_v_bar, 1);
    __pyx_v_bar = __pyx_t_4;
    __pyx_t_4.memview = NULL;
    __pyx_t_4.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">415</span>:         <span class="k">if</span> <span class="n">bar</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mf">2</span><span class="p">:</span> <span class="k">continue</span></pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(415,0,<span class='error_goto'>__PYX_ERR(0, 415, __pyx_L1_error)</span>)
    __pyx_t_5 = -1L;
    __pyx_t_6 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_bar.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 415, __pyx_L1_error)</span>
    }
    __pyx_t_7 = (((*((double *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_5 * __pyx_v_bar.strides[0]) ))) == -2.0) != 0);
    if (__pyx_t_7) {
      goto __pyx_L3_continue;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">416</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">417</span>:         <span class="k">if</span> <span class="n">bar</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(417,0,<span class='error_goto'>__PYX_ERR(0, 417, __pyx_L1_error)</span>)
    __pyx_t_8 = 3;
    __pyx_t_6 = -1;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_bar.shape[0];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 417, __pyx_L1_error)</span>
    }
    __pyx_t_7 = (((*((double *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_8 * __pyx_v_bar.strides[0]) ))) == 0.0) != 0);
    if (__pyx_t_7) {
/* … */
    }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">418</span>:             <span class="n">noise_rows</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">bar</span><span class="p">[</span><span class="mf">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">bar</span><span class="p">[</span><span class="mf">1</span><span class="p">]),</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">bar</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">]),</span> <span class="n">bar</span><span class="p">[</span><span class="mf">5</span><span class="p">])</span></pre>
<pre class='cython code score-8 '>      <span class='trace'>__Pyx_TraceLine</span>(418,0,<span class='error_goto'>__PYX_ERR(0, 418, __pyx_L1_error)</span>)
      __pyx_t_9 = 0;
      __pyx_t_6 = -1;
      if (__pyx_t_9 &lt; 0) {
        __pyx_t_9 += __pyx_v_bar.shape[0];
        if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 418, __pyx_L1_error)</span>
      }
      __pyx_t_10 = 1;
      __pyx_t_6 = -1;
      if (__pyx_t_10 &lt; 0) {
        __pyx_t_10 += __pyx_v_bar.shape[0];
        if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 418, __pyx_L1_error)</span>
      }
      __pyx_t_11 = -1L;
      __pyx_t_6 = -1;
      if (__pyx_t_11 &lt; 0) {
        __pyx_t_11 += __pyx_v_bar.shape[0];
        if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 418, __pyx_L1_error)</span>
      }
      __pyx_t_12 = 5;
      __pyx_t_6 = -1;
      if (__pyx_t_12 &lt; 0) {
        __pyx_t_12 += __pyx_v_bar.shape[0];
        if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 418, __pyx_L1_error)</span>
      }
      __pyx_t_13.__pyx_n = 2;
      __pyx_t_13.pol = ((int)(*((double *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_11 * __pyx_v_bar.strides[0]) ))));
      __pyx_t_13.cov = (*((double *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_12 * __pyx_v_bar.strides[0]) )));
      __pyx_f_6Cfuncs_noise_rows(((int)(*((double *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_9 * __pyx_v_bar.strides[0]) )))), ((int)(*((double *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_10 * __pyx_v_bar.strides[0]) )))), __pyx_v_dim, __pyx_v_arr, 0, &amp;__pyx_t_13); 
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">419</span>:         <span class="k">if</span> <span class="n">bar</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(419,0,<span class='error_goto'>__PYX_ERR(0, 419, __pyx_L1_error)</span>)
    __pyx_t_14 = 3;
    __pyx_t_6 = -1;
    if (__pyx_t_14 &lt; 0) {
      __pyx_t_14 += __pyx_v_bar.shape[0];
      if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 419, __pyx_L1_error)</span>
    }
    __pyx_t_7 = (((*((double *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_14 * __pyx_v_bar.strides[0]) ))) == 1.0) != 0);
    if (__pyx_t_7) {
/* … */
    }
    __pyx_L3_continue:;
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">420</span>:             <span class="n">noise_columns</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">bar</span><span class="p">[</span><span class="mf">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">bar</span><span class="p">[</span><span class="mf">1</span><span class="p">]),</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">bar</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">]),</span> <span class="n">bar</span><span class="p">[</span><span class="mf">5</span><span class="p">])</span></pre>
<pre class='cython code score-8 '>      <span class='trace'>__Pyx_TraceLine</span>(420,0,<span class='error_goto'>__PYX_ERR(0, 420, __pyx_L1_error)</span>)
      __pyx_t_15 = 0;
      __pyx_t_6 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_bar.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 420, __pyx_L1_error)</span>
      }
      __pyx_t_16 = 1;
      __pyx_t_6 = -1;
      if (__pyx_t_16 &lt; 0) {
        __pyx_t_16 += __pyx_v_bar.shape[0];
        if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 420, __pyx_L1_error)</span>
      }
      __pyx_t_17 = -1L;
      __pyx_t_6 = -1;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_v_bar.shape[0];
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 420, __pyx_L1_error)</span>
      }
      __pyx_t_18 = 5;
      __pyx_t_6 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_bar.shape[0];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_bar.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 420, __pyx_L1_error)</span>
      }
      __pyx_t_19.__pyx_n = 2;
      __pyx_t_19.pol = ((int)(*((double *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_17 * __pyx_v_bar.strides[0]) ))));
      __pyx_t_19.cov = (*((double *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_18 * __pyx_v_bar.strides[0]) )));
      __pyx_f_6Cfuncs_noise_columns(((int)(*((double *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_15 * __pyx_v_bar.strides[0]) )))), ((int)(*((double *) ( /* dim=0 */ (__pyx_v_bar.data + __pyx_t_16 * __pyx_v_bar.strides[0]) )))), __pyx_v_dim, __pyx_v_arr, 0, &amp;__pyx_t_19); 
</pre><pre class="cython line score-0">&#xA0;<span class="">421</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">422</span>: </pre>
<pre class="cython line score-89" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">423</span>: <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">noise_rows</span><span class="p">(</span><span class="nb">int</span> <span class="n">num</span><span class="p">,</span> <span class="nb">int</span> <span class="n">width</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">arr</span><span class="p">,</span></pre>
<pre class='cython code score-89 '>static PyObject *__pyx_pw_6Cfuncs_31noise_rows(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static void __pyx_f_6Cfuncs_noise_rows(int __pyx_v_num, int __pyx_v_width, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_6Cfuncs_noise_rows *__pyx_optional_args) {
  int __pyx_v_pol = ((int)1);
  float __pyx_v_cov = ((float)0.8);
  Py_ssize_t __pyx_v_i;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("noise_rows", 0);
  <span class='trace'>__Pyx_TraceCall</span>("noise_rows", __pyx_f[0], 423, 0, <span class='error_goto'>__PYX_ERR(0, 423, __pyx_L1_error)</span>);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_pol = __pyx_optional_args-&gt;pol;
      if (__pyx_optional_args-&gt;__pyx_n &gt; 1) {
        __pyx_v_cov = __pyx_optional_args-&gt;cov;
      }
    }
  }
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("Cfuncs.noise_rows", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_31noise_rows(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_30noise_rows[] = "\n    Fills rows of arr with noise\n\n    :param num:     (int) index of starting row\n    :param width:   (int) number of rows to fill\n    :param dim:     (pointer) dimensions of arr\n    :param arr:   (2D pointer) arr\n    :param polarity:    polarity of noise (1 additive, 0 normal, -1 subtractive)\n    :param coverage:    coverage of the line\n    :return:        None\n    ";
static PyObject *__pyx_pw_6Cfuncs_31noise_rows(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_num;
  int __pyx_v_width;
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_pol;
  float __pyx_v_cov;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("noise_rows (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_num,&amp;__pyx_n_s_width,&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,&amp;__pyx_n_s_pol,&amp;__pyx_n_s_cov,0};
    PyObject* values[6] = {0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_num)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_width)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("noise_rows", 0, 4, 6, 1); <span class='error_goto'>__PYX_ERR(0, 423, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("noise_rows", 0, 4, 6, 2); <span class='error_goto'>__PYX_ERR(0, 423, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("noise_rows", 0, 4, 6, 3); <span class='error_goto'>__PYX_ERR(0, 423, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_pol);
          if (value) { values[4] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_cov);
          if (value) { values[5] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "noise_rows") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 423, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_num = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]); if (unlikely((__pyx_v_num == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 423, __pyx_L3_error)</span>
    __pyx_v_width = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]); if (unlikely((__pyx_v_width == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 423, __pyx_L3_error)</span>
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 423, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 423, __pyx_L3_error)</span>
    if (values[4]) {
      __pyx_v_pol = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]); if (unlikely((__pyx_v_pol == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 424, __pyx_L3_error)</span>
    } else {
      __pyx_v_pol = ((int)1);
    }
    if (values[5]) {
      __pyx_v_cov = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[5]); if (unlikely((__pyx_v_cov == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 424, __pyx_L3_error)</span>
    } else {
      __pyx_v_cov = ((float)0.8);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("noise_rows", 0, 4, 6, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 423, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.noise_rows", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_30noise_rows(__pyx_self, __pyx_v_num, __pyx_v_width, __pyx_v_dim, __pyx_v_arr, __pyx_v_pol, __pyx_v_cov);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_30noise_rows(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_num, int __pyx_v_width, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, int __pyx_v_pol, float __pyx_v_cov) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("noise_rows", 0);
  <span class='trace'>__Pyx_TraceCall</span>("noise_rows (wrapper)", __pyx_f[0], 423, 0, <span class='error_goto'>__PYX_ERR(0, 423, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 423, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 423, __pyx_L1_error)</span> }
  __pyx_t_1.__pyx_n = 2;
  __pyx_t_1.pol = __pyx_v_pol;
  __pyx_t_1.cov = __pyx_v_cov;
  __pyx_f_6Cfuncs_noise_rows(__pyx_v_num, __pyx_v_width, __pyx_v_dim, __pyx_v_arr, 0, &amp;__pyx_t_1); 
  __pyx_t_2 = __Pyx_void_to_None(NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 423, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.noise_rows", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_opt_args_6Cfuncs_noise_rows {
  int __pyx_n;
  int pol;
  float cov;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">424</span>:                                 <span class="nb">int</span> <span class="n">pol</span> <span class="o">=</span> <span class="mf">1</span><span class="p">,</span> <span class="nb">float</span> <span class="n">cov</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">425</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">426</span>: <span class="sd">    Fills rows of arr with noise</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">427</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">428</span>: <span class="sd">    :param num:     (int) index of starting row</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">429</span>: <span class="sd">    :param width:   (int) number of rows to fill</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">430</span>: <span class="sd">    :param dim:     (pointer) dimensions of arr</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">431</span>: <span class="sd">    :param arr:   (2D pointer) arr</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">432</span>: <span class="sd">    :param polarity:    polarity of noise (1 additive, 0 normal, -1 subtractive)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">433</span>: <span class="sd">    :param coverage:    coverage of the line</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">434</span>: <span class="sd">    :return:        None</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">435</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">436</span>:     <span class="k">cdef</span> <span class="kt">Py_ssize_t</span> <span class="nf">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">437</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">width</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(437,0,<span class='error_goto'>__PYX_ERR(0, 437, __pyx_L1_error)</span>)
  __pyx_t_1 = __pyx_v_width;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">438</span>:         <span class="n">noise_row</span><span class="p">((</span><span class="n">num</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">pol</span><span class="p">,</span> <span class="n">cov</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>    <span class='trace'>__Pyx_TraceLine</span>(438,0,<span class='error_goto'>__PYX_ERR(0, 438, __pyx_L1_error)</span>)
    __pyx_t_4 = (__pyx_v_num + __pyx_v_i);
    __pyx_t_5 = 0;
    __pyx_t_6 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_dim.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 438, __pyx_L1_error)</span>
    }
    __pyx_t_6 = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_5 * __pyx_v_dim.strides[0]) )));
    if (unlikely(__pyx_t_6 == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
      <span class='error_goto'>__PYX_ERR(0, 438, __pyx_L1_error)</span>
    }
    __pyx_f_6Cfuncs_noise_row(__Pyx_mod_Py_ssize_t(__pyx_t_4, __pyx_t_6), __pyx_v_dim, __pyx_v_arr, __pyx_v_pol, __pyx_v_cov, 0);
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">439</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">440</span>: </pre>
<pre class="cython line score-82" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">441</span>: <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">noise_row</span><span class="p">(</span><span class="nb">int</span> <span class="n">pos</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">arr</span><span class="p">,</span> <span class="nb">int</span> <span class="n">polarity</span><span class="p">,</span> <span class="nb">float</span> <span class="n">coverage</span><span class="p">):</span></pre>
<pre class='cython code score-82 '>static PyObject *__pyx_pw_6Cfuncs_33noise_row(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static void __pyx_f_6Cfuncs_noise_row(int __pyx_v_pos, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, int __pyx_v_polarity, float __pyx_v_coverage, CYTHON_UNUSED int __pyx_skip_dispatch) {
  __Pyx_memviewslice __pyx_v_tdim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_tarr = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("noise_row", 0);
  <span class='trace'>__Pyx_TraceCall</span>("noise_row", __pyx_f[0], 441, 0, <span class='error_goto'>__PYX_ERR(0, 441, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("Cfuncs.noise_row", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_tdim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_tarr, 1);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_33noise_row(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_6Cfuncs_33noise_row(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_pos;
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_polarity;
  float __pyx_v_coverage;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("noise_row (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_pos,&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,&amp;__pyx_n_s_polarity,&amp;__pyx_n_s_coverage,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_pos)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("noise_row", 1, 5, 5, 1); <span class='error_goto'>__PYX_ERR(0, 441, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("noise_row", 1, 5, 5, 2); <span class='error_goto'>__PYX_ERR(0, 441, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_polarity)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("noise_row", 1, 5, 5, 3); <span class='error_goto'>__PYX_ERR(0, 441, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_coverage)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("noise_row", 1, 5, 5, 4); <span class='error_goto'>__PYX_ERR(0, 441, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "noise_row") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 441, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_pos = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]); if (unlikely((__pyx_v_pos == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 441, __pyx_L3_error)</span>
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 441, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 441, __pyx_L3_error)</span>
    __pyx_v_polarity = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]); if (unlikely((__pyx_v_polarity == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 441, __pyx_L3_error)</span>
    __pyx_v_coverage = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[4]); if (unlikely((__pyx_v_coverage == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 441, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("noise_row", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 441, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.noise_row", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_32noise_row(__pyx_self, __pyx_v_pos, __pyx_v_dim, __pyx_v_arr, __pyx_v_polarity, __pyx_v_coverage);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_32noise_row(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_pos, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, int __pyx_v_polarity, float __pyx_v_coverage) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("noise_row", 0);
  <span class='trace'>__Pyx_TraceCall</span>("noise_row (wrapper)", __pyx_f[0], 441, 0, <span class='error_goto'>__PYX_ERR(0, 441, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 441, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 441, __pyx_L1_error)</span> }
  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6Cfuncs_noise_row(__pyx_v_pos, __pyx_v_dim, __pyx_v_arr, __pyx_v_polarity, __pyx_v_coverage, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 441, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.noise_row", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">442</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:]</span> <span class="n">tdim</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]])</span></pre>
<pre class='cython code score-26 '>  <span class='trace'>__Pyx_TraceLine</span>(442,0,<span class='error_goto'>__PYX_ERR(0, 442, __pyx_L1_error)</span>)
  __pyx_t_1 = 1;
  __pyx_t_2 = -1;
  if (__pyx_t_1 &lt; 0) {
    __pyx_t_1 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_1 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_1 &gt;= __pyx_v_dim.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 442, __pyx_L1_error)</span>
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_1 * __pyx_v_dim.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 442, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 442, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 442, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 442, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 442, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_tdim = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">443</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">tarr</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">pos</span><span class="p">:</span> <span class="n">pos</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(443,0,<span class='error_goto'>__PYX_ERR(0, 443, __pyx_L1_error)</span>)
  __pyx_t_6.data = __pyx_v_arr.data;
  __pyx_t_6.memview = __pyx_v_arr.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_6, 0);
  __pyx_t_2 = -1;
  if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_6,
    __pyx_v_arr.shape[0], __pyx_v_arr.strides[0], __pyx_v_arr.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_2,
    __pyx_v_pos,
    (__pyx_v_pos + 1),
    0,
    1,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 443, __pyx_L1_error)</span>
}

__pyx_t_6.shape[1] = __pyx_v_arr.shape[1];
__pyx_t_6.strides[1] = __pyx_v_arr.strides[1];
    __pyx_t_6.suboffsets[1] = -1;

__pyx_v_tarr = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">444</span>:     <span class="n">add_stochastic_noise</span><span class="p">(</span><span class="n">coverage</span><span class="p">,</span> <span class="n">tdim</span><span class="p">,</span> <span class="n">tarr</span><span class="p">,</span> <span class="n">polarity</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>  <span class='trace'>__Pyx_TraceLine</span>(444,0,<span class='error_goto'>__PYX_ERR(0, 444, __pyx_L1_error)</span>)
  __pyx_t_7.__pyx_n = 1;
  __pyx_t_7.polarity = __pyx_v_polarity;
  __pyx_t_4 = __pyx_f_6Cfuncs_add_stochastic_noise(__pyx_v_coverage, __pyx_v_tdim, __pyx_v_tarr, 0, &amp;__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 444, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">445</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">446</span>: </pre>
<pre class="cython line score-89" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">447</span>: <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">noise_columns</span><span class="p">(</span><span class="nb">int</span> <span class="n">num</span><span class="p">,</span> <span class="nb">int</span> <span class="n">width</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">arr</span><span class="p">,</span></pre>
<pre class='cython code score-89 '>static PyObject *__pyx_pw_6Cfuncs_35noise_columns(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static void __pyx_f_6Cfuncs_noise_columns(int __pyx_v_num, int __pyx_v_width, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_6Cfuncs_noise_columns *__pyx_optional_args) {
  int __pyx_v_pol = ((int)1);
  float __pyx_v_cov = ((float)0.8);
  Py_ssize_t __pyx_v_i;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("noise_columns", 0);
  <span class='trace'>__Pyx_TraceCall</span>("noise_columns", __pyx_f[0], 447, 0, <span class='error_goto'>__PYX_ERR(0, 447, __pyx_L1_error)</span>);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_pol = __pyx_optional_args-&gt;pol;
      if (__pyx_optional_args-&gt;__pyx_n &gt; 1) {
        __pyx_v_cov = __pyx_optional_args-&gt;cov;
      }
    }
  }
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("Cfuncs.noise_columns", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_35noise_columns(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_34noise_columns[] = "\n    Fills columns of arr with noise\n\n    :param num:     (int) index of starting column\n    :param width:   (int) number of columns to fill\n    :param dim:     (pointer) dimensions of arr\n    :param arr:   (2D pointer) arr\n    :param polarity:    polarity of noise (1 additive, 0 normal, -1 subtractive)\n    :param coverage:    coverage of the line\n    :return:        None\n    ";
static PyObject *__pyx_pw_6Cfuncs_35noise_columns(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_num;
  int __pyx_v_width;
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_pol;
  float __pyx_v_cov;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("noise_columns (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_num,&amp;__pyx_n_s_width,&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,&amp;__pyx_n_s_pol,&amp;__pyx_n_s_cov,0};
    PyObject* values[6] = {0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_num)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_width)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("noise_columns", 0, 4, 6, 1); <span class='error_goto'>__PYX_ERR(0, 447, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("noise_columns", 0, 4, 6, 2); <span class='error_goto'>__PYX_ERR(0, 447, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("noise_columns", 0, 4, 6, 3); <span class='error_goto'>__PYX_ERR(0, 447, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_pol);
          if (value) { values[4] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_cov);
          if (value) { values[5] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "noise_columns") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 447, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_num = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]); if (unlikely((__pyx_v_num == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 447, __pyx_L3_error)</span>
    __pyx_v_width = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]); if (unlikely((__pyx_v_width == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 447, __pyx_L3_error)</span>
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 447, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 447, __pyx_L3_error)</span>
    if (values[4]) {
      __pyx_v_pol = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]); if (unlikely((__pyx_v_pol == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 448, __pyx_L3_error)</span>
    } else {
      __pyx_v_pol = ((int)1);
    }
    if (values[5]) {
      __pyx_v_cov = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[5]); if (unlikely((__pyx_v_cov == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 448, __pyx_L3_error)</span>
    } else {
      __pyx_v_cov = ((float)0.8);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("noise_columns", 0, 4, 6, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 447, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.noise_columns", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_34noise_columns(__pyx_self, __pyx_v_num, __pyx_v_width, __pyx_v_dim, __pyx_v_arr, __pyx_v_pol, __pyx_v_cov);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_34noise_columns(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_num, int __pyx_v_width, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, int __pyx_v_pol, float __pyx_v_cov) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("noise_columns", 0);
  <span class='trace'>__Pyx_TraceCall</span>("noise_columns (wrapper)", __pyx_f[0], 447, 0, <span class='error_goto'>__PYX_ERR(0, 447, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 447, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 447, __pyx_L1_error)</span> }
  __pyx_t_1.__pyx_n = 2;
  __pyx_t_1.pol = __pyx_v_pol;
  __pyx_t_1.cov = __pyx_v_cov;
  __pyx_f_6Cfuncs_noise_columns(__pyx_v_num, __pyx_v_width, __pyx_v_dim, __pyx_v_arr, 0, &amp;__pyx_t_1); 
  __pyx_t_2 = __Pyx_void_to_None(NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 447, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.noise_columns", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_opt_args_6Cfuncs_noise_columns {
  int __pyx_n;
  int pol;
  float cov;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">448</span>:                                 <span class="nb">int</span> <span class="n">pol</span> <span class="o">=</span> <span class="mf">1</span><span class="p">,</span> <span class="nb">float</span> <span class="n">cov</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">449</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">450</span>: <span class="sd">    Fills columns of arr with noise</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">451</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">452</span>: <span class="sd">    :param num:     (int) index of starting column</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">453</span>: <span class="sd">    :param width:   (int) number of columns to fill</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">454</span>: <span class="sd">    :param dim:     (pointer) dimensions of arr</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">455</span>: <span class="sd">    :param arr:   (2D pointer) arr</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">456</span>: <span class="sd">    :param polarity:    polarity of noise (1 additive, 0 normal, -1 subtractive)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">457</span>: <span class="sd">    :param coverage:    coverage of the line</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">458</span>: <span class="sd">    :return:        None</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">459</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">460</span>:     <span class="k">cdef</span> <span class="kt">Py_ssize_t</span> <span class="nf">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">461</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">width</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(461,0,<span class='error_goto'>__PYX_ERR(0, 461, __pyx_L1_error)</span>)
  __pyx_t_1 = __pyx_v_width;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">462</span>:         <span class="n">noise_column</span><span class="p">((</span><span class="n">num</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">pol</span><span class="p">,</span> <span class="n">cov</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>    <span class='trace'>__Pyx_TraceLine</span>(462,0,<span class='error_goto'>__PYX_ERR(0, 462, __pyx_L1_error)</span>)
    __pyx_t_4 = (__pyx_v_num + __pyx_v_i);
    __pyx_t_5 = 1;
    __pyx_t_6 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_dim.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 462, __pyx_L1_error)</span>
    }
    __pyx_t_6 = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_5 * __pyx_v_dim.strides[0]) )));
    if (unlikely(__pyx_t_6 == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
      <span class='error_goto'>__PYX_ERR(0, 462, __pyx_L1_error)</span>
    }
    __pyx_f_6Cfuncs_noise_column(__Pyx_mod_Py_ssize_t(__pyx_t_4, __pyx_t_6), __pyx_v_dim, __pyx_v_arr, __pyx_v_pol, __pyx_v_cov, 0);
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">463</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">464</span>: </pre>
<pre class="cython line score-82" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">465</span>: <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">noise_column</span><span class="p">(</span><span class="nb">int</span> <span class="n">pos</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">arr</span><span class="p">,</span> <span class="nb">int</span> <span class="n">polarity</span><span class="p">,</span> <span class="nb">float</span> <span class="n">coverage</span><span class="p">):</span></pre>
<pre class='cython code score-82 '>static PyObject *__pyx_pw_6Cfuncs_37noise_column(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static void __pyx_f_6Cfuncs_noise_column(int __pyx_v_pos, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, int __pyx_v_polarity, float __pyx_v_coverage, CYTHON_UNUSED int __pyx_skip_dispatch) {
  __Pyx_memviewslice __pyx_v_tdim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_tarr = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("noise_column", 0);
  <span class='trace'>__Pyx_TraceCall</span>("noise_column", __pyx_f[0], 465, 0, <span class='error_goto'>__PYX_ERR(0, 465, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("Cfuncs.noise_column", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_tdim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_tarr, 1);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_37noise_column(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_6Cfuncs_37noise_column(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_pos;
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_polarity;
  float __pyx_v_coverage;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("noise_column (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_pos,&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,&amp;__pyx_n_s_polarity,&amp;__pyx_n_s_coverage,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_pos)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("noise_column", 1, 5, 5, 1); <span class='error_goto'>__PYX_ERR(0, 465, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("noise_column", 1, 5, 5, 2); <span class='error_goto'>__PYX_ERR(0, 465, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_polarity)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("noise_column", 1, 5, 5, 3); <span class='error_goto'>__PYX_ERR(0, 465, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_coverage)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("noise_column", 1, 5, 5, 4); <span class='error_goto'>__PYX_ERR(0, 465, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "noise_column") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 465, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_pos = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]); if (unlikely((__pyx_v_pos == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 465, __pyx_L3_error)</span>
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 465, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 465, __pyx_L3_error)</span>
    __pyx_v_polarity = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]); if (unlikely((__pyx_v_polarity == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 465, __pyx_L3_error)</span>
    __pyx_v_coverage = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[4]); if (unlikely((__pyx_v_coverage == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 465, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("noise_column", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 465, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.noise_column", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_36noise_column(__pyx_self, __pyx_v_pos, __pyx_v_dim, __pyx_v_arr, __pyx_v_polarity, __pyx_v_coverage);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_36noise_column(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_pos, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, int __pyx_v_polarity, float __pyx_v_coverage) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("noise_column", 0);
  <span class='trace'>__Pyx_TraceCall</span>("noise_column (wrapper)", __pyx_f[0], 465, 0, <span class='error_goto'>__PYX_ERR(0, 465, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 465, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 465, __pyx_L1_error)</span> }
  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6Cfuncs_noise_column(__pyx_v_pos, __pyx_v_dim, __pyx_v_arr, __pyx_v_polarity, __pyx_v_coverage, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 465, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.noise_column", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">466</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:]</span> <span class="n">tdim</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="mf">1</span><span class="p">])</span></pre>
<pre class='cython code score-26 '>  <span class='trace'>__Pyx_TraceLine</span>(466,0,<span class='error_goto'>__PYX_ERR(0, 466, __pyx_L1_error)</span>)
  __pyx_t_1 = 0;
  __pyx_t_2 = -1;
  if (__pyx_t_1 &lt; 0) {
    __pyx_t_1 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_1 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_1 &gt;= __pyx_v_dim.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 466, __pyx_L1_error)</span>
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_1 * __pyx_v_dim.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 466, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 466, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_1);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 466, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 466, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 466, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_tdim = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">467</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">tarr</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">pos</span> <span class="o">+</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(467,0,<span class='error_goto'>__PYX_ERR(0, 467, __pyx_L1_error)</span>)
  __pyx_t_6.data = __pyx_v_arr.data;
  __pyx_t_6.memview = __pyx_v_arr.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_6, 0);
  __pyx_t_6.shape[0] = __pyx_v_arr.shape[0];
__pyx_t_6.strides[0] = __pyx_v_arr.strides[0];
    __pyx_t_6.suboffsets[0] = -1;

__pyx_t_2 = -1;
  if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_6,
    __pyx_v_arr.shape[1], __pyx_v_arr.strides[1], __pyx_v_arr.suboffsets[1],
    1,
    1,
    &amp;__pyx_t_2,
    __pyx_v_pos,
    (__pyx_v_pos + 1),
    0,
    1,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L1_error)</span>
}

__pyx_v_tarr = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">468</span>:     <span class="n">add_stochastic_noise</span><span class="p">(</span><span class="n">coverage</span><span class="p">,</span> <span class="n">tdim</span><span class="p">,</span> <span class="n">tarr</span><span class="p">,</span> <span class="n">polarity</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>  <span class='trace'>__Pyx_TraceLine</span>(468,0,<span class='error_goto'>__PYX_ERR(0, 468, __pyx_L1_error)</span>)
  __pyx_t_7.__pyx_n = 1;
  __pyx_t_7.polarity = __pyx_v_polarity;
  __pyx_t_4 = __pyx_f_6Cfuncs_add_stochastic_noise(__pyx_v_coverage, __pyx_v_tdim, __pyx_v_tarr, 0, &amp;__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 468, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">469</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">470</span>: <span class="c">#===============FANTASTIC STOCHASTIC===============</span></pre>
<pre class="cython line score-75" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">471</span>: <span class="k">cpdef</span> <span class="nf">randomize_center</span><span class="p">(</span><span class="nb">int</span> <span class="n">siz</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">arr</span><span class="p">,</span> <span class="nb">float</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.2</span><span class="p">):</span></pre>
<pre class='cython code score-75 '>static PyObject *__pyx_pw_6Cfuncs_39randomize_center(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_6Cfuncs_randomize_center(int __pyx_v_siz, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_6Cfuncs_randomize_center *__pyx_optional_args) {
  float __pyx_v_threshold = ((float)0.2);
  __Pyx_memviewslice __pyx_v_dim_v = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_offset_v = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr_v = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("randomize_center", 0);
  <span class='trace'>__Pyx_TraceCall</span>("randomize_center", __pyx_f[0], 471, 0, <span class='error_goto'>__PYX_ERR(0, 471, __pyx_L1_error)</span>);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_threshold = __pyx_optional_args-&gt;threshold;
    }
  }
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.randomize_center", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim_v, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_offset_v, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr_v, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_39randomize_center(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_38randomize_center[] = "\n    Puts a little random array in the center of the array\n\n    :param size:        (pointer) size of small array\n    :param dim:         (pointer) dimensions\n    :param arr:         (2D pointer) array\n    :return:            None\n    ";
static PyObject *__pyx_pw_6Cfuncs_39randomize_center(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_siz;
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_threshold;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("randomize_center (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_siz,&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,&amp;__pyx_n_s_threshold,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_siz)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("randomize_center", 0, 3, 4, 1); <span class='error_goto'>__PYX_ERR(0, 471, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("randomize_center", 0, 3, 4, 2); <span class='error_goto'>__PYX_ERR(0, 471, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_threshold);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "randomize_center") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 471, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_siz = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]); if (unlikely((__pyx_v_siz == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 471, __pyx_L3_error)</span>
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 471, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 471, __pyx_L3_error)</span>
    if (values[3]) {
      __pyx_v_threshold = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[3]); if (unlikely((__pyx_v_threshold == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 471, __pyx_L3_error)</span>
    } else {
      __pyx_v_threshold = ((float)0.2);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("randomize_center", 0, 3, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 471, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.randomize_center", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_38randomize_center(__pyx_self, __pyx_v_siz, __pyx_v_dim, __pyx_v_arr, __pyx_v_threshold);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_38randomize_center(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_siz, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, float __pyx_v_threshold) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("randomize_center", 0);
  <span class='trace'>__Pyx_TraceCall</span>("randomize_center (wrapper)", __pyx_f[0], 471, 0, <span class='error_goto'>__PYX_ERR(0, 471, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 471, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 471, __pyx_L1_error)</span> }
  __pyx_t_2.__pyx_n = 1;
  __pyx_t_2.threshold = __pyx_v_threshold;
  __pyx_t_1 = __pyx_f_6Cfuncs_randomize_center(__pyx_v_siz, __pyx_v_dim, __pyx_v_arr, 0, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 471, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.randomize_center", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_opt_args_6Cfuncs_randomize_center {
  int __pyx_n;
  float threshold;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">472</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">473</span>: <span class="sd">    Puts a little random array in the center of the array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">474</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">475</span>: <span class="sd">    :param size:        (pointer) size of small array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">476</span>: <span class="sd">    :param dim:         (pointer) dimensions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">477</span>: <span class="sd">    :param arr:         (2D pointer) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">478</span>: <span class="sd">    :return:            None</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">479</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">480</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:]</span> <span class="n">dim_v</span><span class="p">,</span> <span class="n">offset_v</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">481</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">arr_v</span></pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">482</span>:     <span class="n">dim_v</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">siz</span><span class="p">,</span> <span class="n">siz</span><span class="p">])</span></pre>
<pre class='cython code score-25 '>  <span class='trace'>__Pyx_TraceLine</span>(482,0,<span class='error_goto'>__PYX_ERR(0, 482, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_siz);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 482, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_siz);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 482, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 482, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 482, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 482, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 482, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_dim_v = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">483</span>:     <span class="n">arr_v</span> <span class="o">=</span> <span class="n">init_array</span><span class="p">(</span><span class="n">dim_v</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(483,0,<span class='error_goto'>__PYX_ERR(0, 483, __pyx_L1_error)</span>)
  __pyx_t_5 = __pyx_f_6Cfuncs_init_array(__pyx_v_dim_v, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 483, __pyx_L1_error)</span>
  __pyx_v_arr_v = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">484</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">485</span>:     <span class="n">add_global_noise</span><span class="p">(</span><span class="n">threshold</span><span class="p">,</span> <span class="n">dim_v</span><span class="p">,</span> <span class="n">arr_v</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>  <span class='trace'>__Pyx_TraceLine</span>(485,0,<span class='error_goto'>__PYX_ERR(0, 485, __pyx_L1_error)</span>)
  __pyx_t_3 = __pyx_f_6Cfuncs_add_global_noise(__pyx_v_threshold, __pyx_v_dim_v, __pyx_v_arr_v, 0, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 485, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">486</span>: </pre>
<pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">487</span>:     <span class="n">offset_v</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">dim_v</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span><span class="o">//</span><span class="mf">2</span><span class="p">,</span> <span class="p">(</span><span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dim_v</span><span class="p">[</span><span class="mf">1</span><span class="p">])</span><span class="o">//</span><span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-33 '>  <span class='trace'>__Pyx_TraceLine</span>(487,0,<span class='error_goto'>__PYX_ERR(0, 487, __pyx_L1_error)</span>)
  __pyx_t_6 = 0;
  __pyx_t_7 = -1;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_dim.shape[0])) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 487, __pyx_L1_error)</span>
  }
  __pyx_t_8 = 0;
  __pyx_t_7 = -1;
  if (__pyx_t_8 &lt; 0) {
    __pyx_t_8 += __pyx_v_dim_v.shape[0];
    if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_dim_v.shape[0])) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 487, __pyx_L1_error)</span>
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__Pyx_div_long(((*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_6 * __pyx_v_dim.strides[0]) ))) - (*((int *) ( /* dim=0 */ (__pyx_v_dim_v.data + __pyx_t_8 * __pyx_v_dim_v.strides[0]) )))), 2));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 487, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_9 = 1;
  __pyx_t_7 = -1;
  if (__pyx_t_9 &lt; 0) {
    __pyx_t_9 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_dim.shape[0])) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 487, __pyx_L1_error)</span>
  }
  __pyx_t_10 = 1;
  __pyx_t_7 = -1;
  if (__pyx_t_10 &lt; 0) {
    __pyx_t_10 += __pyx_v_dim_v.shape[0];
    if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_7 = 0;
  } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_dim_v.shape[0])) __pyx_t_7 = 0;
  if (unlikely(__pyx_t_7 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
    <span class='error_goto'>__PYX_ERR(0, 487, __pyx_L1_error)</span>
  }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__Pyx_div_long(((*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_9 * __pyx_v_dim.strides[0]) ))) - (*((int *) ( /* dim=0 */ (__pyx_v_dim_v.data + __pyx_t_10 * __pyx_v_dim_v.strides[0]) )))), 2));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 487, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 487, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_2);
  __pyx_t_3 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 487, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 487, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 487, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_offset_v = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
</pre><pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">488</span>:     <span class="n">cy</span><span class="o">.</span><span class="n">replace_array</span><span class="p">(</span><span class="n">offset_v</span><span class="p">,</span> <span class="n">dim_v</span><span class="p">,</span> <span class="n">arr_v</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-54 '>  <span class='trace'>__Pyx_TraceLine</span>(488,0,<span class='error_goto'>__PYX_ERR(0, 488, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_cy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 488, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_replace_array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 488, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_offset_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 488, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_11 = __pyx_memoryview_fromslice(__pyx_v_dim_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 488, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_12 = __pyx_memoryview_fromslice(__pyx_v_arr_v, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 488, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_v_dim, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 488, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_14 = __pyx_memoryview_fromslice(__pyx_v_arr, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 488, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_15 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_15 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_15)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_7 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[6] = {__pyx_t_15, __pyx_t_2, __pyx_t_11, __pyx_t_12, __pyx_t_13, __pyx_t_14};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 5+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 488, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[6] = {__pyx_t_15, __pyx_t_2, __pyx_t_11, __pyx_t_12, __pyx_t_13, __pyx_t_14};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 5+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 488, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  } else
  #endif
  {
    __pyx_t_16 = <span class='py_c_api'>PyTuple_New</span>(5+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 488, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
    if (__pyx_t_15) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 0, __pyx_t_15); __pyx_t_15 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 0+__pyx_t_7, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 1+__pyx_t_7, __pyx_t_11);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 2+__pyx_t_7, __pyx_t_12);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 3+__pyx_t_7, __pyx_t_13);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 4+__pyx_t_7, __pyx_t_14);
    __pyx_t_2 = 0;
    __pyx_t_11 = 0;
    __pyx_t_12 = 0;
    __pyx_t_13 = 0;
    __pyx_t_14 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_16, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 488, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">489</span>: </pre>
<pre class="cython line score-72" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">490</span>: <span class="k">cpdef</span> <span class="nf">add_global_noise</span><span class="p">(</span><span class="nb">float</span> <span class="n">threshold</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">arr</span><span class="p">,</span> <span class="nb">int</span> <span class="n">polarity</span><span class="o">=</span><span class="mf">0</span><span class="p">):</span></pre>
<pre class='cython code score-72 '>static PyObject *__pyx_pw_6Cfuncs_41add_global_noise(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_6Cfuncs_add_global_noise(float __pyx_v_threshold, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_6Cfuncs_add_global_noise *__pyx_optional_args) {
  int __pyx_v_polarity = ((int)0);
  __Pyx_memviewslice __pyx_v_narr = { 0, 0, { 0 }, { 0 }, { 0 } };
  Py_ssize_t __pyx_v_i;
  Py_ssize_t __pyx_v_j;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("add_global_noise", 0);
  <span class='trace'>__Pyx_TraceCall</span>("add_global_noise", __pyx_f[0], 490, 0, <span class='error_goto'>__PYX_ERR(0, 490, __pyx_L1_error)</span>);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_polarity = __pyx_optional_args-&gt;polarity;
    }
  }
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.add_global_noise", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_narr, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_41add_global_noise(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_40add_global_noise[] = "\n    Adds simple noise to an array.\n    NB: This is faster than add_stochastic_noise for large noise levels.\n\n    :param threshold: (float) Noise threshold (0-1)\n    :param dim:     (pointer) dimensions of array\n    :param array:   (2D pointer) array\n    :param polarity: (int) 1 is additive, 0 is normal and -1 is subtractive\n    :return: None\n    ";
static PyObject *__pyx_pw_6Cfuncs_41add_global_noise(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  float __pyx_v_threshold;
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_polarity;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("add_global_noise (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_threshold,&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,&amp;__pyx_n_s_polarity,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_threshold)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("add_global_noise", 0, 3, 4, 1); <span class='error_goto'>__PYX_ERR(0, 490, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("add_global_noise", 0, 3, 4, 2); <span class='error_goto'>__PYX_ERR(0, 490, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_polarity);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "add_global_noise") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 490, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_threshold = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[0]); if (unlikely((__pyx_v_threshold == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 490, __pyx_L3_error)</span>
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 490, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 490, __pyx_L3_error)</span>
    if (values[3]) {
      __pyx_v_polarity = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]); if (unlikely((__pyx_v_polarity == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 490, __pyx_L3_error)</span>
    } else {
      __pyx_v_polarity = ((int)0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("add_global_noise", 0, 3, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 490, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.add_global_noise", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_40add_global_noise(__pyx_self, __pyx_v_threshold, __pyx_v_dim, __pyx_v_arr, __pyx_v_polarity);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_40add_global_noise(CYTHON_UNUSED PyObject *__pyx_self, float __pyx_v_threshold, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, int __pyx_v_polarity) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("add_global_noise", 0);
  <span class='trace'>__Pyx_TraceCall</span>("add_global_noise (wrapper)", __pyx_f[0], 490, 0, <span class='error_goto'>__PYX_ERR(0, 490, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 490, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 490, __pyx_L1_error)</span> }
  __pyx_t_2.__pyx_n = 1;
  __pyx_t_2.polarity = __pyx_v_polarity;
  __pyx_t_1 = __pyx_f_6Cfuncs_add_global_noise(__pyx_v_threshold, __pyx_v_dim, __pyx_v_arr, 0, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.add_global_noise", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_opt_args_6Cfuncs_add_global_noise {
  int __pyx_n;
  int polarity;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">491</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">492</span>: <span class="sd">    Adds simple noise to an array.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">493</span>: <span class="sd">    NB: This is faster than add_stochastic_noise for large noise levels.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">494</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">495</span>: <span class="sd">    :param threshold: (float) Noise threshold (0-1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">496</span>: <span class="sd">    :param dim:     (pointer) dimensions of array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">497</span>: <span class="sd">    :param array:   (2D pointer) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">498</span>: <span class="sd">    :param polarity: (int) 1 is additive, 0 is normal and -1 is subtractive</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">499</span>: <span class="sd">    :return: None</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">500</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">501</span>:     <span class="k">if</span> <span class="n">threshold</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(501,0,<span class='error_goto'>__PYX_ERR(0, 501, __pyx_L1_error)</span>)
  __pyx_t_1 = ((__pyx_v_threshold == 0.0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">502</span>:         <span class="k">return</span></pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(502,0,<span class='error_goto'>__PYX_ERR(0, 502, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    goto __pyx_L0;
</pre><pre class="cython line score-87" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">503</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">narr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">intc</span><span class="p">)</span></pre>
<pre class='cython code score-87 '>  <span class='trace'>__Pyx_TraceLine</span>(503,0,<span class='error_goto'>__PYX_ERR(0, 503, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 503, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 503, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 503, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 503, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 503, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_dim, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 503, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_3 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_7, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 503, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_threshold);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 503, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_5, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 503, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 503, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 503, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_8 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_8 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
    PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_6, __pyx_t_3};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 503, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
    PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_6, __pyx_t_3};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 503, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else
  #endif
  {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 503, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (__pyx_t_5) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_8, __pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_8, __pyx_t_3);
    __pyx_t_6 = 0;
    __pyx_t_3 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 503, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 503, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_narr = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">504</span>:     <span class="k">cdef</span> <span class="kt">Py_ssize_t</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">505</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(505,0,<span class='error_goto'>__PYX_ERR(0, 505, __pyx_L1_error)</span>)
  __pyx_t_10 = 0;
  __pyx_t_8 = -1;
  if (__pyx_t_10 &lt; 0) {
    __pyx_t_10 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_8 = 0;
  } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_dim.shape[0])) __pyx_t_8 = 0;
  if (unlikely(__pyx_t_8 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
    <span class='error_goto'>__PYX_ERR(0, 505, __pyx_L1_error)</span>
  }
  __pyx_t_8 = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_10 * __pyx_v_dim.strides[0]) )));
  __pyx_t_11 = __pyx_t_8;
  for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
    __pyx_v_i = __pyx_t_12;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">506</span>:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(506,0,<span class='error_goto'>__PYX_ERR(0, 506, __pyx_L1_error)</span>)
    __pyx_t_13 = 1;
    __pyx_t_14 = -1;
    if (__pyx_t_13 &lt; 0) {
      __pyx_t_13 += __pyx_v_dim.shape[0];
      if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 0;
    } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_dim.shape[0])) __pyx_t_14 = 0;
    if (unlikely(__pyx_t_14 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
      <span class='error_goto'>__PYX_ERR(0, 506, __pyx_L1_error)</span>
    }
    __pyx_t_14 = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_13 * __pyx_v_dim.strides[0]) )));
    __pyx_t_15 = __pyx_t_14;
    for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_15; __pyx_t_16+=1) {
      __pyx_v_j = __pyx_t_16;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">507</span>:             <span class="k">if</span> <span class="n">polarity</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      <span class='trace'>__Pyx_TraceLine</span>(507,0,<span class='error_goto'>__PYX_ERR(0, 507, __pyx_L1_error)</span>)
      switch (__pyx_v_polarity) {
        case 1:
/* … */
        break;
        case -1L:
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">508</span>:                 <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">|</span> <span class="n">narr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-6 '>        <span class='trace'>__Pyx_TraceLine</span>(508,0,<span class='error_goto'>__PYX_ERR(0, 508, __pyx_L1_error)</span>)
        __pyx_t_17 = __pyx_v_i;
        __pyx_t_18 = __pyx_v_j;
        __pyx_t_19 = -1;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_v_arr.shape[0];
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_arr.shape[0])) __pyx_t_19 = 0;
        if (__pyx_t_18 &lt; 0) {
          __pyx_t_18 += __pyx_v_arr.shape[1];
          if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_19 = 1;
        } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_arr.shape[1])) __pyx_t_19 = 1;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
          <span class='error_goto'>__PYX_ERR(0, 508, __pyx_L1_error)</span>
        }
        __pyx_t_20 = __pyx_v_i;
        __pyx_t_21 = __pyx_v_j;
        __pyx_t_19 = -1;
        if (__pyx_t_20 &lt; 0) {
          __pyx_t_20 += __pyx_v_narr.shape[0];
          if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_narr.shape[0])) __pyx_t_19 = 0;
        if (__pyx_t_21 &lt; 0) {
          __pyx_t_21 += __pyx_v_narr.shape[1];
          if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_19 = 1;
        } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_narr.shape[1])) __pyx_t_19 = 1;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
          <span class='error_goto'>__PYX_ERR(0, 508, __pyx_L1_error)</span>
        }
        __pyx_t_22 = __pyx_v_i;
        __pyx_t_23 = __pyx_v_j;
        __pyx_t_19 = -1;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_v_arr.shape[0];
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_arr.shape[0])) __pyx_t_19 = 0;
        if (__pyx_t_23 &lt; 0) {
          __pyx_t_23 += __pyx_v_arr.shape[1];
          if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_19 = 1;
        } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_arr.shape[1])) __pyx_t_19 = 1;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
          <span class='error_goto'>__PYX_ERR(0, 508, __pyx_L1_error)</span>
        }
        *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_22 * __pyx_v_arr.strides[0]) ) + __pyx_t_23 * __pyx_v_arr.strides[1]) )) = ((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_17 * __pyx_v_arr.strides[0]) ) + __pyx_t_18 * __pyx_v_arr.strides[1]) ))) | (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_narr.data + __pyx_t_20 * __pyx_v_narr.strides[0]) ) + __pyx_t_21 * __pyx_v_narr.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">509</span>:             <span class="k">elif</span> <span class="n">polarity</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        break;
        default:
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">510</span>:                 <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">narr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span></pre>
<pre class='cython code score-6 '>        <span class='trace'>__Pyx_TraceLine</span>(510,0,<span class='error_goto'>__PYX_ERR(0, 510, __pyx_L1_error)</span>)
        __pyx_t_24 = __pyx_v_i;
        __pyx_t_25 = __pyx_v_j;
        __pyx_t_19 = -1;
        if (__pyx_t_24 &lt; 0) {
          __pyx_t_24 += __pyx_v_arr.shape[0];
          if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_arr.shape[0])) __pyx_t_19 = 0;
        if (__pyx_t_25 &lt; 0) {
          __pyx_t_25 += __pyx_v_arr.shape[1];
          if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_19 = 1;
        } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_arr.shape[1])) __pyx_t_19 = 1;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
          <span class='error_goto'>__PYX_ERR(0, 510, __pyx_L1_error)</span>
        }
        __pyx_t_26 = __pyx_v_i;
        __pyx_t_27 = __pyx_v_j;
        __pyx_t_19 = -1;
        if (__pyx_t_26 &lt; 0) {
          __pyx_t_26 += __pyx_v_narr.shape[0];
          if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_narr.shape[0])) __pyx_t_19 = 0;
        if (__pyx_t_27 &lt; 0) {
          __pyx_t_27 += __pyx_v_narr.shape[1];
          if (unlikely(__pyx_t_27 &lt; 0)) __pyx_t_19 = 1;
        } else if (unlikely(__pyx_t_27 &gt;= __pyx_v_narr.shape[1])) __pyx_t_19 = 1;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
          <span class='error_goto'>__PYX_ERR(0, 510, __pyx_L1_error)</span>
        }
        __pyx_t_28 = __pyx_v_i;
        __pyx_t_29 = __pyx_v_j;
        __pyx_t_19 = -1;
        if (__pyx_t_28 &lt; 0) {
          __pyx_t_28 += __pyx_v_arr.shape[0];
          if (unlikely(__pyx_t_28 &lt; 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_28 &gt;= __pyx_v_arr.shape[0])) __pyx_t_19 = 0;
        if (__pyx_t_29 &lt; 0) {
          __pyx_t_29 += __pyx_v_arr.shape[1];
          if (unlikely(__pyx_t_29 &lt; 0)) __pyx_t_19 = 1;
        } else if (unlikely(__pyx_t_29 &gt;= __pyx_v_arr.shape[1])) __pyx_t_19 = 1;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
          <span class='error_goto'>__PYX_ERR(0, 510, __pyx_L1_error)</span>
        }
        *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_28 * __pyx_v_arr.strides[0]) ) + __pyx_t_29 * __pyx_v_arr.strides[1]) )) = (~((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_24 * __pyx_v_arr.strides[0]) ) + __pyx_t_25 * __pyx_v_arr.strides[1]) ))) &amp; (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_narr.data + __pyx_t_26 * __pyx_v_narr.strides[0]) ) + __pyx_t_27 * __pyx_v_narr.strides[1]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">511</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">512</span>:                 <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">^</span> <span class="n">narr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-6 '>        <span class='trace'>__Pyx_TraceLine</span>(512,0,<span class='error_goto'>__PYX_ERR(0, 512, __pyx_L1_error)</span>)
        __pyx_t_30 = __pyx_v_i;
        __pyx_t_31 = __pyx_v_j;
        __pyx_t_19 = -1;
        if (__pyx_t_30 &lt; 0) {
          __pyx_t_30 += __pyx_v_arr.shape[0];
          if (unlikely(__pyx_t_30 &lt; 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_30 &gt;= __pyx_v_arr.shape[0])) __pyx_t_19 = 0;
        if (__pyx_t_31 &lt; 0) {
          __pyx_t_31 += __pyx_v_arr.shape[1];
          if (unlikely(__pyx_t_31 &lt; 0)) __pyx_t_19 = 1;
        } else if (unlikely(__pyx_t_31 &gt;= __pyx_v_arr.shape[1])) __pyx_t_19 = 1;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
          <span class='error_goto'>__PYX_ERR(0, 512, __pyx_L1_error)</span>
        }
        __pyx_t_32 = __pyx_v_i;
        __pyx_t_33 = __pyx_v_j;
        __pyx_t_19 = -1;
        if (__pyx_t_32 &lt; 0) {
          __pyx_t_32 += __pyx_v_narr.shape[0];
          if (unlikely(__pyx_t_32 &lt; 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_32 &gt;= __pyx_v_narr.shape[0])) __pyx_t_19 = 0;
        if (__pyx_t_33 &lt; 0) {
          __pyx_t_33 += __pyx_v_narr.shape[1];
          if (unlikely(__pyx_t_33 &lt; 0)) __pyx_t_19 = 1;
        } else if (unlikely(__pyx_t_33 &gt;= __pyx_v_narr.shape[1])) __pyx_t_19 = 1;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
          <span class='error_goto'>__PYX_ERR(0, 512, __pyx_L1_error)</span>
        }
        __pyx_t_34 = __pyx_v_i;
        __pyx_t_35 = __pyx_v_j;
        __pyx_t_19 = -1;
        if (__pyx_t_34 &lt; 0) {
          __pyx_t_34 += __pyx_v_arr.shape[0];
          if (unlikely(__pyx_t_34 &lt; 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_34 &gt;= __pyx_v_arr.shape[0])) __pyx_t_19 = 0;
        if (__pyx_t_35 &lt; 0) {
          __pyx_t_35 += __pyx_v_arr.shape[1];
          if (unlikely(__pyx_t_35 &lt; 0)) __pyx_t_19 = 1;
        } else if (unlikely(__pyx_t_35 &gt;= __pyx_v_arr.shape[1])) __pyx_t_19 = 1;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
          <span class='error_goto'>__PYX_ERR(0, 512, __pyx_L1_error)</span>
        }
        *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_34 * __pyx_v_arr.strides[0]) ) + __pyx_t_35 * __pyx_v_arr.strides[1]) )) = ((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_30 * __pyx_v_arr.strides[0]) ) + __pyx_t_31 * __pyx_v_arr.strides[1]) ))) ^ (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_narr.data + __pyx_t_32 * __pyx_v_narr.strides[0]) ) + __pyx_t_33 * __pyx_v_narr.strides[1]) ))));
        break;
      }
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">513</span>: </pre>
<pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">514</span>: <span class="k">cpdef</span> <span class="nf">add_stochastic_noise</span><span class="p">(</span><span class="nb">float</span> <span class="n">coverage</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">arr</span><span class="p">,</span> <span class="nb">int</span> <span class="n">polarity</span><span class="o">=</span><span class="mf">0</span><span class="p">):</span></pre>
<pre class='cython code score-73 '>static PyObject *__pyx_pw_6Cfuncs_43add_stochastic_noise(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_6Cfuncs_add_stochastic_noise(float __pyx_v_coverage, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_6Cfuncs_add_stochastic_noise *__pyx_optional_args) {
  int __pyx_v_polarity = ((int)0);
  __Pyx_memviewslice __pyx_v_vex = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vey = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vecs = { 0, 0, { 0 }, { 0 }, { 0 } };
  Py_ssize_t __pyx_v_i;
  int __pyx_v_a;
  int __pyx_v_b;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("add_stochastic_noise", 0);
  <span class='trace'>__Pyx_TraceCall</span>("add_stochastic_noise", __pyx_f[0], 514, 0, <span class='error_goto'>__PYX_ERR(0, 514, __pyx_L1_error)</span>);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_polarity = __pyx_optional_args-&gt;polarity;
    }
  }
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.add_stochastic_noise", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vex, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vey, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vecs, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_43add_stochastic_noise(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_42add_stochastic_noise[] = "\n    Adds simple noise to an array.\n    NB: This is slower than add_global_noise for large noise levels.\n    Use the 'additive' setting to make the most of the speed if you want a fuller array.\n\n    :param threshold: (float) Noise threshold (0-1)\n    :param dim:     (pointer) dimensions of array\n    :param array:   (2D pointer) array\n    :param polarity (int) 1 is additive, 0 is normal and -1 is subtractive\n    :return: None\n    ";
static PyObject *__pyx_pw_6Cfuncs_43add_stochastic_noise(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  float __pyx_v_coverage;
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_polarity;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("add_stochastic_noise (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_coverage,&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,&amp;__pyx_n_s_polarity,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_coverage)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("add_stochastic_noise", 0, 3, 4, 1); <span class='error_goto'>__PYX_ERR(0, 514, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("add_stochastic_noise", 0, 3, 4, 2); <span class='error_goto'>__PYX_ERR(0, 514, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_polarity);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "add_stochastic_noise") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 514, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_coverage = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[0]); if (unlikely((__pyx_v_coverage == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 514, __pyx_L3_error)</span>
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 514, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 514, __pyx_L3_error)</span>
    if (values[3]) {
      __pyx_v_polarity = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]); if (unlikely((__pyx_v_polarity == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 514, __pyx_L3_error)</span>
    } else {
      __pyx_v_polarity = ((int)0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("add_stochastic_noise", 0, 3, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 514, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.add_stochastic_noise", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_42add_stochastic_noise(__pyx_self, __pyx_v_coverage, __pyx_v_dim, __pyx_v_arr, __pyx_v_polarity);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_42add_stochastic_noise(CYTHON_UNUSED PyObject *__pyx_self, float __pyx_v_coverage, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, int __pyx_v_polarity) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("add_stochastic_noise", 0);
  <span class='trace'>__Pyx_TraceCall</span>("add_stochastic_noise (wrapper)", __pyx_f[0], 514, 0, <span class='error_goto'>__PYX_ERR(0, 514, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 514, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 514, __pyx_L1_error)</span> }
  __pyx_t_2.__pyx_n = 1;
  __pyx_t_2.polarity = __pyx_v_polarity;
  __pyx_t_1 = __pyx_f_6Cfuncs_add_stochastic_noise(__pyx_v_coverage, __pyx_v_dim, __pyx_v_arr, 0, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 514, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.add_stochastic_noise", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_opt_args_6Cfuncs_add_stochastic_noise {
  int __pyx_n;
  int polarity;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">515</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">516</span>: <span class="sd">    Adds simple noise to an array.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">517</span>: <span class="sd">    NB: This is slower than add_global_noise for large noise levels.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">518</span>: <span class="sd">    Use the &#39;additive&#39; setting to make the most of the speed if you want a fuller array.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">519</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">520</span>: <span class="sd">    :param threshold: (float) Noise threshold (0-1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">521</span>: <span class="sd">    :param dim:     (pointer) dimensions of array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">522</span>: <span class="sd">    :param array:   (2D pointer) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">523</span>: <span class="sd">    :param polarity (int) 1 is additive, 0 is normal and -1 is subtractive</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">524</span>: <span class="sd">    :return: None</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">525</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">526</span>:     <span class="k">if</span> <span class="n">coverage</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(526,0,<span class='error_goto'>__PYX_ERR(0, 526, __pyx_L1_error)</span>)
  __pyx_t_1 = ((__pyx_v_coverage == 0.0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">527</span>:         <span class="k">return</span></pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(527,0,<span class='error_goto'>__PYX_ERR(0, 527, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    goto __pyx_L0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">528</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">vex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">coverage</span> <span class="o">*</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]),</span> <span class="mf">1</span><span class="p">),</span></pre>
<pre class='cython code score-29 '>  <span class='trace'>__Pyx_TraceLine</span>(528,0,<span class='error_goto'>__PYX_ERR(0, 528, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_randint);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_6 = -1;
  if (__pyx_t_5 &lt; 0) {
    __pyx_t_5 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 528, __pyx_L1_error)</span>
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_5 * __pyx_v_dim.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_7 = 0;
  __pyx_t_6 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 528, __pyx_L1_error)</span>
  }
  __pyx_t_8 = 1;
  __pyx_t_6 = -1;
  if (__pyx_t_8 &lt; 0) {
    __pyx_t_8 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 528, __pyx_L1_error)</span>
  }
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_FromDouble</span>(((__pyx_v_coverage * (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_7 * __pyx_v_dim.strides[0]) )))) * (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_8 * __pyx_v_dim.strides[0]) )))));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_int_1);
  __pyx_t_9 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(528,0,<span class='error_goto'>__PYX_ERR(0, 528, __pyx_L1_error)</span>)
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_vex = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">529</span>:                                            <span class="n">np</span><span class="o">.</span><span class="n">intc</span><span class="p">)</span></pre>
<pre class='cython code score-49 '>  <span class='trace'>__Pyx_TraceLine</span>(529,0,<span class='error_goto'>__PYX_ERR(0, 529, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 529, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 529, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_9)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[5] = {__pyx_t_9, __pyx_int_0, __pyx_t_4, __pyx_t_10, __pyx_t_11};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 4+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[5] = {__pyx_t_9, __pyx_int_0, __pyx_t_4, __pyx_t_10, __pyx_t_11};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 4+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  } else
  #endif
  {
    __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    if (__pyx_t_9) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_9); __pyx_t_9 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0+__pyx_t_6, __pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1+__pyx_t_6, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 2+__pyx_t_6, __pyx_t_10);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 3+__pyx_t_6, __pyx_t_11);
    __pyx_t_4 = 0;
    __pyx_t_10 = 0;
    __pyx_t_11 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">530</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">vey</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">coverage</span> <span class="o">*</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]),</span> <span class="mf">1</span><span class="p">),</span></pre>
<pre class='cython code score-29 '>  <span class='trace'>__Pyx_TraceLine</span>(530,0,<span class='error_goto'>__PYX_ERR(0, 530, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_randint);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_14 = 1;
  __pyx_t_6 = -1;
  if (__pyx_t_14 &lt; 0) {
    __pyx_t_14 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 530, __pyx_L1_error)</span>
  }
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_14 * __pyx_v_dim.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_15 = 0;
  __pyx_t_6 = -1;
  if (__pyx_t_15 &lt; 0) {
    __pyx_t_15 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 530, __pyx_L1_error)</span>
  }
  __pyx_t_16 = 1;
  __pyx_t_6 = -1;
  if (__pyx_t_16 &lt; 0) {
    __pyx_t_16 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 530, __pyx_L1_error)</span>
  }
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_FromDouble</span>(((__pyx_v_coverage * (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_15 * __pyx_v_dim.strides[0]) )))) * (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_16 * __pyx_v_dim.strides[0]) )))));<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_int_1);
  __pyx_t_11 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(530,0,<span class='error_goto'>__PYX_ERR(0, 530, __pyx_L1_error)</span>)
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 530, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_vey = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">531</span>:                                            <span class="n">np</span><span class="o">.</span><span class="n">intc</span><span class="p">)</span></pre>
<pre class='cython code score-49 '>  <span class='trace'>__Pyx_TraceLine</span>(531,0,<span class='error_goto'>__PYX_ERR(0, 531, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 531, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 531, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_11)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[5] = {__pyx_t_11, __pyx_int_0, __pyx_t_12, __pyx_t_10, __pyx_t_4};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 4+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 530, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[5] = {__pyx_t_11, __pyx_int_0, __pyx_t_12, __pyx_t_10, __pyx_t_4};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 4+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 530, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else
  #endif
  {
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 530, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (__pyx_t_11) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_11); __pyx_t_11 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_6, __pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_6, __pyx_t_12);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2+__pyx_t_6, __pyx_t_10);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 3+__pyx_t_6, __pyx_t_4);
    __pyx_t_12 = 0;
    __pyx_t_10 = 0;
    __pyx_t_4 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 530, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">532</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">vex</span><span class="p">,</span> <span class="n">vey</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-33 '>  <span class='trace'>__Pyx_TraceLine</span>(532,0,<span class='error_goto'>__PYX_ERR(0, 532, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 532, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_concatenate);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 532, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_vex, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 532, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_9 = __pyx_memoryview_fromslice(__pyx_v_vey, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 532, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 532, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_9);
  __pyx_t_2 = 0;
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 532, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 532, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_axis, __pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 532, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_9, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 532, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 532, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_vecs = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">533</span>:     <span class="k">cdef</span> <span class="kt">Py_ssize_t</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">534</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">a</span><span class="p">,</span> <span class="nf">b</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">535</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">coverage</span> <span class="o">*</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">])):</span></pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(535,0,<span class='error_goto'>__PYX_ERR(0, 535, __pyx_L1_error)</span>)
  __pyx_t_17 = 0;
  __pyx_t_6 = -1;
  if (__pyx_t_17 &lt; 0) {
    __pyx_t_17 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 535, __pyx_L1_error)</span>
  }
  __pyx_t_18 = 1;
  __pyx_t_6 = -1;
  if (__pyx_t_18 &lt; 0) {
    __pyx_t_18 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 535, __pyx_L1_error)</span>
  }
  __pyx_t_19 = ((long)((__pyx_v_coverage * (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_17 * __pyx_v_dim.strides[0]) )))) * (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_18 * __pyx_v_dim.strides[0]) )))));
  __pyx_t_20 = __pyx_t_19;
  for (__pyx_t_21 = 0; __pyx_t_21 &lt; __pyx_t_20; __pyx_t_21+=1) {
    __pyx_v_i = __pyx_t_21;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">536</span>:         <span class="n">a</span> <span class="o">=</span> <span class="n">vecs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(536,0,<span class='error_goto'>__PYX_ERR(0, 536, __pyx_L1_error)</span>)
    __pyx_t_22 = __pyx_v_i;
    __pyx_t_23 = 0;
    __pyx_t_6 = -1;
    if (__pyx_t_22 &lt; 0) {
      __pyx_t_22 += __pyx_v_vecs.shape[0];
      if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_vecs.shape[0])) __pyx_t_6 = 0;
    if (__pyx_t_23 &lt; 0) {
      __pyx_t_23 += __pyx_v_vecs.shape[1];
      if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_6 = 1;
    } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_vecs.shape[1])) __pyx_t_6 = 1;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 536, __pyx_L1_error)</span>
    }
    __pyx_v_a = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vecs.data + __pyx_t_22 * __pyx_v_vecs.strides[0]) ) + __pyx_t_23 * __pyx_v_vecs.strides[1]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">537</span>:         <span class="n">b</span> <span class="o">=</span> <span class="n">vecs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(537,0,<span class='error_goto'>__PYX_ERR(0, 537, __pyx_L1_error)</span>)
    __pyx_t_24 = __pyx_v_i;
    __pyx_t_25 = 1;
    __pyx_t_6 = -1;
    if (__pyx_t_24 &lt; 0) {
      __pyx_t_24 += __pyx_v_vecs.shape[0];
      if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_vecs.shape[0])) __pyx_t_6 = 0;
    if (__pyx_t_25 &lt; 0) {
      __pyx_t_25 += __pyx_v_vecs.shape[1];
      if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_6 = 1;
    } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_vecs.shape[1])) __pyx_t_6 = 1;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 537, __pyx_L1_error)</span>
    }
    __pyx_v_b = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vecs.data + __pyx_t_24 * __pyx_v_vecs.strides[0]) ) + __pyx_t_25 * __pyx_v_vecs.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">538</span>:         <span class="k">if</span> <span class="n">polarity</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(538,0,<span class='error_goto'>__PYX_ERR(0, 538, __pyx_L1_error)</span>)
    switch (__pyx_v_polarity) {
      case 1:
/* … */
      break;
      case -1L:
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">539</span>:             <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(539,0,<span class='error_goto'>__PYX_ERR(0, 539, __pyx_L1_error)</span>)
      __pyx_t_26 = __pyx_v_a;
      __pyx_t_27 = __pyx_v_b;
      __pyx_t_6 = -1;
      if (__pyx_t_26 &lt; 0) {
        __pyx_t_26 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
      if (__pyx_t_27 &lt; 0) {
        __pyx_t_27 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_27 &lt; 0)) __pyx_t_6 = 1;
      } else if (unlikely(__pyx_t_27 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 539, __pyx_L1_error)</span>
      }
      *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_26 * __pyx_v_arr.strides[0]) ) + __pyx_t_27 * __pyx_v_arr.strides[1]) )) = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">540</span>:         <span class="k">elif</span> <span class="n">polarity</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      default:
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">541</span>:             <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(541,0,<span class='error_goto'>__PYX_ERR(0, 541, __pyx_L1_error)</span>)
      __pyx_t_28 = __pyx_v_a;
      __pyx_t_29 = __pyx_v_b;
      __pyx_t_6 = -1;
      if (__pyx_t_28 &lt; 0) {
        __pyx_t_28 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_28 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_28 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
      if (__pyx_t_29 &lt; 0) {
        __pyx_t_29 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_29 &lt; 0)) __pyx_t_6 = 1;
      } else if (unlikely(__pyx_t_29 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 541, __pyx_L1_error)</span>
      }
      *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_28 * __pyx_v_arr.strides[0]) ) + __pyx_t_29 * __pyx_v_arr.strides[1]) )) = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">542</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">543</span>:             <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span> <span class="o">-</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span></pre>
<pre class='cython code score-4 '>      <span class='trace'>__Pyx_TraceLine</span>(543,0,<span class='error_goto'>__PYX_ERR(0, 543, __pyx_L1_error)</span>)
      __pyx_t_30 = __pyx_v_a;
      __pyx_t_31 = __pyx_v_b;
      __pyx_t_6 = -1;
      if (__pyx_t_30 &lt; 0) {
        __pyx_t_30 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_30 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_30 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
      if (__pyx_t_31 &lt; 0) {
        __pyx_t_31 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_31 &lt; 0)) __pyx_t_6 = 1;
      } else if (unlikely(__pyx_t_31 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 543, __pyx_L1_error)</span>
      }
      __pyx_t_32 = __pyx_v_a;
      __pyx_t_33 = __pyx_v_b;
      __pyx_t_6 = -1;
      if (__pyx_t_32 &lt; 0) {
        __pyx_t_32 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_32 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_32 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
      if (__pyx_t_33 &lt; 0) {
        __pyx_t_33 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_33 &lt; 0)) __pyx_t_6 = 1;
      } else if (unlikely(__pyx_t_33 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 543, __pyx_L1_error)</span>
      }
      *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_32 * __pyx_v_arr.strides[0]) ) + __pyx_t_33 * __pyx_v_arr.strides[1]) )) = (1 - (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_30 * __pyx_v_arr.strides[0]) ) + __pyx_t_31 * __pyx_v_arr.strides[1]) ))));
      break;
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">544</span>: </pre>
<pre class="cython line score-76" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">545</span>: <span class="k">cpdef</span> <span class="nf">ising_process_moore</span><span class="p">(</span><span class="nb">float</span> <span class="n">updates</span><span class="p">,</span> <span class="nb">float</span> <span class="n">beta</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">arr</span><span class="p">):</span></pre>
<pre class='cython code score-76 '>static PyObject *__pyx_pw_6Cfuncs_45ising_process_moore(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_6Cfuncs_ising_process_moore(float __pyx_v_updates, float __pyx_v_beta, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, CYTHON_UNUSED int __pyx_skip_dispatch) {
  __Pyx_memviewslice __pyx_v_cost = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_N;
  int __pyx_v_D;
  CYTHON_UNUSED Py_ssize_t __pyx_v__;
  int __pyx_v_nb;
  __Pyx_memviewslice __pyx_v_pos = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ising_process_moore", 0);
  <span class='trace'>__Pyx_TraceCall</span>("ising_process_moore", __pyx_f[0], 545, 0, <span class='error_goto'>__PYX_ERR(0, 545, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_20, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.ising_process_moore", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_cost, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pos, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_45ising_process_moore(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_44ising_process_moore[] = "\n    Performs ising updates on the array.\n\n    :param updates:     (float) ising updates (as percentage of all positions, 0 is off)\n    :param beta:    (float) Inverse temperature (&gt;1/8 --&gt; pure noise)\n    :param dim:     (pointer) dimensions of array\n    :param array:   (2D pointer) array\n    :return:        None\n    ";
static PyObject *__pyx_pw_6Cfuncs_45ising_process_moore(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  float __pyx_v_updates;
  float __pyx_v_beta;
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ising_process_moore (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_updates,&amp;__pyx_n_s_beta,&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_updates)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_beta)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ising_process_moore", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 545, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ising_process_moore", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 545, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ising_process_moore", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 545, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ising_process_moore") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 545, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_updates = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[0]); if (unlikely((__pyx_v_updates == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 545, __pyx_L3_error)</span>
    __pyx_v_beta = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[1]); if (unlikely((__pyx_v_beta == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 545, __pyx_L3_error)</span>
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 545, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_int</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 545, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ising_process_moore", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 545, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.ising_process_moore", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_44ising_process_moore(__pyx_self, __pyx_v_updates, __pyx_v_beta, __pyx_v_dim, __pyx_v_arr);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_44ising_process_moore(CYTHON_UNUSED PyObject *__pyx_self, float __pyx_v_updates, float __pyx_v_beta, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ising_process_moore", 0);
  <span class='trace'>__Pyx_TraceCall</span>("ising_process_moore (wrapper)", __pyx_f[0], 545, 0, <span class='error_goto'>__PYX_ERR(0, 545, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 545, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 545, __pyx_L1_error)</span> }
  __pyx_t_1 = __pyx_f_6Cfuncs_ising_process_moore(__pyx_v_updates, __pyx_v_beta, __pyx_v_dim, __pyx_v_arr, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 545, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.ising_process_moore", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">546</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">547</span>: <span class="sd">    Performs ising updates on the array.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">548</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">549</span>: <span class="sd">    :param updates:     (float) ising updates (as percentage of all positions, 0 is off)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">550</span>: <span class="sd">    :param beta:    (float) Inverse temperature (&gt;1/8 --&gt; pure noise)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">551</span>: <span class="sd">    :param dim:     (pointer) dimensions of array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">552</span>: <span class="sd">    :param array:   (2D pointer) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">553</span>: <span class="sd">    :return:        None</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">554</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">555</span>:     <span class="k">if</span> <span class="n">updates</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(555,0,<span class='error_goto'>__PYX_ERR(0, 555, __pyx_L1_error)</span>)
  __pyx_t_1 = ((__pyx_v_updates == 0.0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">556</span>:         <span class="k">return</span></pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(556,0,<span class='error_goto'>__PYX_ERR(0, 556, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    goto __pyx_L0;
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">557</span>:     <span class="k">cdef</span> <span class="kt">float</span>[<span class="p">:]</span> <span class="n">cost</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-51 '>  <span class='trace'>__Pyx_TraceLine</span>(557,0,<span class='error_goto'>__PYX_ERR(0, 557, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 557, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 557, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 557, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 557, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_int_3, __pyx_t_5};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 557, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_int_3, __pyx_t_5};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 557, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else
  #endif
  {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 557, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (__pyx_t_3) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_6, __pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_6, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 557, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 557, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_cost = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">558</span>:     <span class="n">cost</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">4</span> <span class="o">*</span> <span class="n">beta</span><span class="p">)</span></pre>
<pre class='cython code score-38 '>  <span class='trace'>__Pyx_TraceLine</span>(558,0,<span class='error_goto'>__PYX_ERR(0, 558, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 558, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_exp);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 558, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((-4.0 * __pyx_v_beta));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 558, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
    }
  }
  __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_5, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 558, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_2); if (unlikely((__pyx_t_9 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 558, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_10 = 1;
  __pyx_t_6 = -1;
  if (__pyx_t_10 &lt; 0) {
    __pyx_t_10 += __pyx_v_cost.shape[0];
    if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_cost.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 558, __pyx_L1_error)</span>
  }
  *((float *) ( /* dim=0 */ (__pyx_v_cost.data + __pyx_t_10 * __pyx_v_cost.strides[0]) )) = __pyx_t_9;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">559</span>:     <span class="n">cost</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">cost</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">**</span> <span class="mf">2</span></pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(559,0,<span class='error_goto'>__PYX_ERR(0, 559, __pyx_L1_error)</span>)
  __pyx_t_11 = 1;
  __pyx_t_6 = -1;
  if (__pyx_t_11 &lt; 0) {
    __pyx_t_11 += __pyx_v_cost.shape[0];
    if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_cost.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 559, __pyx_L1_error)</span>
  }
  __pyx_t_12 = 2;
  __pyx_t_6 = -1;
  if (__pyx_t_12 &lt; 0) {
    __pyx_t_12 += __pyx_v_cost.shape[0];
    if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_cost.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 559, __pyx_L1_error)</span>
  }
  *((float *) ( /* dim=0 */ (__pyx_v_cost.data + __pyx_t_12 * __pyx_v_cost.strides[0]) )) = powf((*((float *) ( /* dim=0 */ (__pyx_v_cost.data + __pyx_t_11 * __pyx_v_cost.strides[0]) ))), 2.0);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">560</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">N</span> <span class="o">=</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(560,0,<span class='error_goto'>__PYX_ERR(0, 560, __pyx_L1_error)</span>)
  __pyx_t_13 = 0;
  __pyx_t_6 = -1;
  if (__pyx_t_13 &lt; 0) {
    __pyx_t_13 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 560, __pyx_L1_error)</span>
  }
  __pyx_v_N = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_13 * __pyx_v_dim.strides[0]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">561</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">D</span> <span class="o">=</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(561,0,<span class='error_goto'>__PYX_ERR(0, 561, __pyx_L1_error)</span>)
  __pyx_t_14 = 1;
  __pyx_t_6 = -1;
  if (__pyx_t_14 &lt; 0) {
    __pyx_t_14 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 561, __pyx_L1_error)</span>
  }
  __pyx_v_D = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_14 * __pyx_v_dim.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">562</span>:     <span class="k">cdef</span> <span class="kt">Py_ssize_t</span> <span class="nf">_</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">563</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">nb</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">564</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:]</span> <span class="n">pos</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">565</span>:     <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">updates</span> <span class="o">*</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">])):</span></pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(565,0,<span class='error_goto'>__PYX_ERR(0, 565, __pyx_L1_error)</span>)
  __pyx_t_15 = 0;
  __pyx_t_6 = -1;
  if (__pyx_t_15 &lt; 0) {
    __pyx_t_15 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 565, __pyx_L1_error)</span>
  }
  __pyx_t_16 = 1;
  __pyx_t_6 = -1;
  if (__pyx_t_16 &lt; 0) {
    __pyx_t_16 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 565, __pyx_L1_error)</span>
  }
  __pyx_t_17 = ((long)((__pyx_v_updates * (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_15 * __pyx_v_dim.strides[0]) )))) * (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_16 * __pyx_v_dim.strides[0]) )))));
  __pyx_t_18 = __pyx_t_17;
  for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
    __pyx_v__ = __pyx_t_19;
</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">566</span>:         <span class="n">pos</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="n">N</span><span class="p">,</span> <span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="n">D</span><span class="p">])</span></pre>
<pre class='cython code score-35 '>    <span class='trace'>__Pyx_TraceLine</span>(566,0,<span class='error_goto'>__PYX_ERR(0, 566, __pyx_L1_error)</span>)
    __pyx_t_6 = rand();
    if (unlikely(__pyx_v_N == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
      <span class='error_goto'>__PYX_ERR(0, 566, __pyx_L1_error)</span>
    }
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__Pyx_mod_int(__pyx_t_6, __pyx_v_N));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_6 = rand();
    if (unlikely(__pyx_v_D == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
      <span class='error_goto'>__PYX_ERR(0, 566, __pyx_L1_error)</span>
    }
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__Pyx_mod_int(__pyx_t_6, __pyx_v_D));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_7);
    __pyx_t_2 = 0;
    __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_n_u_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pos, 1);
    __pyx_v_pos = __pyx_t_20;
    __pyx_t_20.memview = NULL;
    __pyx_t_20.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">567</span>:         <span class="n">nb</span> <span class="o">=</span> <span class="n">moore_neighbors_same</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(567,0,<span class='error_goto'>__PYX_ERR(0, 567, __pyx_L1_error)</span>)
    __pyx_v_nb = __pyx_f_6Cfuncs_moore_neighbors_same(__pyx_v_pos, __pyx_v_dim, __pyx_v_arr, 0);
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">568</span>:         <span class="k">if</span> <span class="n">nb</span> <span class="o">-</span> <span class="mf">2</span> <span class="o">&lt;=</span> <span class="mf">0</span> <span class="ow">or</span> <span class="p">(</span><span class="n">rand</span><span class="p">()</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">RAND_MAX</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">cost</span><span class="p">[</span><span class="n">nb</span> <span class="o">-</span> <span class="mf">2</span><span class="p">]:</span></pre>
<pre class='cython code score-7 '>    <span class='trace'>__Pyx_TraceLine</span>(568,0,<span class='error_goto'>__PYX_ERR(0, 568, __pyx_L1_error)</span>)
    __pyx_t_21 = (((__pyx_v_nb - 2) &lt;= 0) != 0);
    if (!__pyx_t_21) {
    } else {
      __pyx_t_1 = __pyx_t_21;
      goto __pyx_L7_bool_binop_done;
    }
    __pyx_t_6 = rand();
    if (unlikely(((double)RAND_MAX) == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 568, __pyx_L1_error)</span>
    }
    __pyx_t_22 = (__pyx_v_nb - 2);
    __pyx_t_23 = -1;
    if (__pyx_t_22 &lt; 0) {
      __pyx_t_22 += __pyx_v_cost.shape[0];
      if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_23 = 0;
    } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_cost.shape[0])) __pyx_t_23 = 0;
    if (unlikely(__pyx_t_23 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_23);
      <span class='error_goto'>__PYX_ERR(0, 568, __pyx_L1_error)</span>
    }
    __pyx_t_21 = (((((double)__pyx_t_6) / ((double)RAND_MAX)) &lt; (*((float *) ( /* dim=0 */ (__pyx_v_cost.data + __pyx_t_22 * __pyx_v_cost.strides[0]) )))) != 0);
    __pyx_t_1 = __pyx_t_21;
    __pyx_L7_bool_binop_done:;
    if (__pyx_t_1) {
/* … */
    }
  }
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">569</span>:             <span class="n">arr</span><span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mf">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1</span> <span class="o">-</span> <span class="n">arr</span><span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mf">1</span><span class="p">]]</span></pre>
<pre class='cython code score-12 '>      <span class='trace'>__Pyx_TraceLine</span>(569,0,<span class='error_goto'>__PYX_ERR(0, 569, __pyx_L1_error)</span>)
      __pyx_t_24 = 0;
      __pyx_t_6 = -1;
      if (__pyx_t_24 &lt; 0) {
        __pyx_t_24 += __pyx_v_pos.shape[0];
        if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_pos.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 569, __pyx_L1_error)</span>
      }
      __pyx_t_25 = 1;
      __pyx_t_6 = -1;
      if (__pyx_t_25 &lt; 0) {
        __pyx_t_25 += __pyx_v_pos.shape[0];
        if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_pos.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 569, __pyx_L1_error)</span>
      }
      __pyx_t_26 = (*((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_24 * __pyx_v_pos.strides[0]) )));
      __pyx_t_27 = (*((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_25 * __pyx_v_pos.strides[0]) )));
      __pyx_t_6 = -1;
      if (__pyx_t_26 &lt; 0) {
        __pyx_t_26 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
      if (__pyx_t_27 &lt; 0) {
        __pyx_t_27 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_27 &lt; 0)) __pyx_t_6 = 1;
      } else if (unlikely(__pyx_t_27 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 569, __pyx_L1_error)</span>
      }
      __pyx_t_28 = 0;
      __pyx_t_6 = -1;
      if (__pyx_t_28 &lt; 0) {
        __pyx_t_28 += __pyx_v_pos.shape[0];
        if (unlikely(__pyx_t_28 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_28 &gt;= __pyx_v_pos.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 569, __pyx_L1_error)</span>
      }
      __pyx_t_29 = 1;
      __pyx_t_6 = -1;
      if (__pyx_t_29 &lt; 0) {
        __pyx_t_29 += __pyx_v_pos.shape[0];
        if (unlikely(__pyx_t_29 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_29 &gt;= __pyx_v_pos.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 569, __pyx_L1_error)</span>
      }
      __pyx_t_30 = (*((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_28 * __pyx_v_pos.strides[0]) )));
      __pyx_t_31 = (*((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_29 * __pyx_v_pos.strides[0]) )));
      __pyx_t_6 = -1;
      if (__pyx_t_30 &lt; 0) {
        __pyx_t_30 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_30 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_30 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
      if (__pyx_t_31 &lt; 0) {
        __pyx_t_31 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_31 &lt; 0)) __pyx_t_6 = 1;
      } else if (unlikely(__pyx_t_31 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 569, __pyx_L1_error)</span>
      }
      *((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_30 * __pyx_v_arr.strides[0]) )) + __pyx_t_31)) )) = (1 - (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_26 * __pyx_v_arr.strides[0]) )) + __pyx_t_27)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">570</span>: </pre>
<pre class="cython line score-76" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">571</span>: <span class="k">cpdef</span> <span class="nf">ising_process</span><span class="p">(</span><span class="nb">float</span> <span class="n">updates</span><span class="p">,</span> <span class="nb">float</span> <span class="n">beta</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">arr</span><span class="p">):</span></pre>
<pre class='cython code score-76 '>static PyObject *__pyx_pw_6Cfuncs_47ising_process(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_6Cfuncs_ising_process(float __pyx_v_updates, float __pyx_v_beta, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, CYTHON_UNUSED int __pyx_skip_dispatch) {
  __Pyx_memviewslice __pyx_v_cost = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_N;
  int __pyx_v_D;
  CYTHON_UNUSED Py_ssize_t __pyx_v__;
  int __pyx_v_a;
  int __pyx_v_b;
  int __pyx_v_l;
  int __pyx_v_r;
  int __pyx_v_u;
  int __pyx_v_d;
  int __pyx_v_nb;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ising_process", 0);
  <span class='trace'>__Pyx_TraceCall</span>("ising_process", __pyx_f[0], 571, 0, <span class='error_goto'>__PYX_ERR(0, 571, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.ising_process", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_cost, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_47ising_process(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_46ising_process[] = "\n    Performs ising updates on the array.\n\n    :param updates:     (float) ising updates (as percentage of all positions, 0 is off)\n    :param beta:    (float) Inverse temperature (&gt;1/8 --&gt; pure noise)\n    :param dim:     (pointer) dimensions of array\n    :param array:   (2D pointer) array\n    :return:        None\n    ";
static PyObject *__pyx_pw_6Cfuncs_47ising_process(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  float __pyx_v_updates;
  float __pyx_v_beta;
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ising_process (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_updates,&amp;__pyx_n_s_beta,&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_updates)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_beta)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ising_process", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 571, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ising_process", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 571, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ising_process", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 571, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "ising_process") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 571, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_updates = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[0]); if (unlikely((__pyx_v_updates == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 571, __pyx_L3_error)</span>
    __pyx_v_beta = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[1]); if (unlikely((__pyx_v_beta == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 571, __pyx_L3_error)</span>
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 571, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 571, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ising_process", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 571, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.ising_process", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_46ising_process(__pyx_self, __pyx_v_updates, __pyx_v_beta, __pyx_v_dim, __pyx_v_arr);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_46ising_process(CYTHON_UNUSED PyObject *__pyx_self, float __pyx_v_updates, float __pyx_v_beta, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ising_process", 0);
  <span class='trace'>__Pyx_TraceCall</span>("ising_process (wrapper)", __pyx_f[0], 571, 0, <span class='error_goto'>__PYX_ERR(0, 571, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 571, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 571, __pyx_L1_error)</span> }
  __pyx_t_1 = __pyx_f_6Cfuncs_ising_process(__pyx_v_updates, __pyx_v_beta, __pyx_v_dim, __pyx_v_arr, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 571, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.ising_process", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">572</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">573</span>: <span class="sd">    Performs ising updates on the array.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">574</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">575</span>: <span class="sd">    :param updates:     (float) ising updates (as percentage of all positions, 0 is off)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">576</span>: <span class="sd">    :param beta:    (float) Inverse temperature (&gt;1/8 --&gt; pure noise)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">577</span>: <span class="sd">    :param dim:     (pointer) dimensions of array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">578</span>: <span class="sd">    :param array:   (2D pointer) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">579</span>: <span class="sd">    :return:        None</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">580</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">581</span>:     <span class="k">if</span> <span class="n">updates</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(581,0,<span class='error_goto'>__PYX_ERR(0, 581, __pyx_L1_error)</span>)
  __pyx_t_1 = ((__pyx_v_updates == 0.0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">582</span>:         <span class="k">return</span></pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(582,0,<span class='error_goto'>__PYX_ERR(0, 582, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    goto __pyx_L0;
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">583</span>:     <span class="k">cdef</span> <span class="kt">float</span>[<span class="p">:]</span> <span class="n">cost</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-51 '>  <span class='trace'>__Pyx_TraceLine</span>(583,0,<span class='error_goto'>__PYX_ERR(0, 583, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 583, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 583, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 583, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 583, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_int_3, __pyx_t_5};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 583, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_int_3, __pyx_t_5};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 583, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else
  #endif
  {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 583, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (__pyx_t_3) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_6, __pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_6, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 583, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 583, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_cost = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">584</span>:     <span class="n">cost</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">4</span> <span class="o">*</span> <span class="n">beta</span><span class="p">)</span></pre>
<pre class='cython code score-38 '>  <span class='trace'>__Pyx_TraceLine</span>(584,0,<span class='error_goto'>__PYX_ERR(0, 584, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 584, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_exp);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 584, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((-4.0 * __pyx_v_beta));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 584, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
    }
  }
  __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_5, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 584, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_2); if (unlikely((__pyx_t_9 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 584, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_10 = 1;
  __pyx_t_6 = -1;
  if (__pyx_t_10 &lt; 0) {
    __pyx_t_10 += __pyx_v_cost.shape[0];
    if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_cost.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 584, __pyx_L1_error)</span>
  }
  *((float *) ( /* dim=0 */ (__pyx_v_cost.data + __pyx_t_10 * __pyx_v_cost.strides[0]) )) = __pyx_t_9;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">585</span>:     <span class="n">cost</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">cost</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">**</span> <span class="mf">2</span></pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(585,0,<span class='error_goto'>__PYX_ERR(0, 585, __pyx_L1_error)</span>)
  __pyx_t_11 = 1;
  __pyx_t_6 = -1;
  if (__pyx_t_11 &lt; 0) {
    __pyx_t_11 += __pyx_v_cost.shape[0];
    if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_cost.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 585, __pyx_L1_error)</span>
  }
  __pyx_t_12 = 2;
  __pyx_t_6 = -1;
  if (__pyx_t_12 &lt; 0) {
    __pyx_t_12 += __pyx_v_cost.shape[0];
    if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_cost.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 585, __pyx_L1_error)</span>
  }
  *((float *) ( /* dim=0 */ (__pyx_v_cost.data + __pyx_t_12 * __pyx_v_cost.strides[0]) )) = powf((*((float *) ( /* dim=0 */ (__pyx_v_cost.data + __pyx_t_11 * __pyx_v_cost.strides[0]) ))), 2.0);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">586</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">N</span> <span class="o">=</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(586,0,<span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>)
  __pyx_t_13 = 0;
  __pyx_t_6 = -1;
  if (__pyx_t_13 &lt; 0) {
    __pyx_t_13 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>
  }
  __pyx_v_N = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_13 * __pyx_v_dim.strides[0]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">587</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">D</span> <span class="o">=</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(587,0,<span class='error_goto'>__PYX_ERR(0, 587, __pyx_L1_error)</span>)
  __pyx_t_14 = 1;
  __pyx_t_6 = -1;
  if (__pyx_t_14 &lt; 0) {
    __pyx_t_14 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 587, __pyx_L1_error)</span>
  }
  __pyx_v_D = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_14 * __pyx_v_dim.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">588</span>:     <span class="k">cdef</span> <span class="kt">Py_ssize_t</span> <span class="nf">_</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">589</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">a</span><span class="p">,</span> <span class="nf">b</span><span class="p">,</span> <span class="nf">l</span><span class="p">,</span> <span class="nf">r</span><span class="p">,</span> <span class="nf">u</span><span class="p">,</span> <span class="nf">d</span><span class="p">,</span> <span class="nf">nb</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">590</span>:     <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">updates</span> <span class="o">*</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">])):</span></pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(590,0,<span class='error_goto'>__PYX_ERR(0, 590, __pyx_L1_error)</span>)
  __pyx_t_15 = 0;
  __pyx_t_6 = -1;
  if (__pyx_t_15 &lt; 0) {
    __pyx_t_15 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 590, __pyx_L1_error)</span>
  }
  __pyx_t_16 = 1;
  __pyx_t_6 = -1;
  if (__pyx_t_16 &lt; 0) {
    __pyx_t_16 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 590, __pyx_L1_error)</span>
  }
  __pyx_t_17 = ((long)((__pyx_v_updates * (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_15 * __pyx_v_dim.strides[0]) )))) * (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_16 * __pyx_v_dim.strides[0]) )))));
  __pyx_t_18 = __pyx_t_17;
  for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
    __pyx_v__ = __pyx_t_19;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">591</span>:         <span class="n">a</span> <span class="o">=</span> <span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="n">N</span></pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(591,0,<span class='error_goto'>__PYX_ERR(0, 591, __pyx_L1_error)</span>)
    __pyx_t_6 = rand();
    if (unlikely(__pyx_v_N == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
      <span class='error_goto'>__PYX_ERR(0, 591, __pyx_L1_error)</span>
    }
    __pyx_v_a = __Pyx_mod_int(__pyx_t_6, __pyx_v_N);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">592</span>:         <span class="n">b</span> <span class="o">=</span> <span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="n">D</span></pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(592,0,<span class='error_goto'>__PYX_ERR(0, 592, __pyx_L1_error)</span>)
    __pyx_t_6 = rand();
    if (unlikely(__pyx_v_D == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
      <span class='error_goto'>__PYX_ERR(0, 592, __pyx_L1_error)</span>
    }
    __pyx_v_b = __Pyx_mod_int(__pyx_t_6, __pyx_v_D);
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">593</span>:         <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">b</span> <span class="o">==</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">a</span> <span class="o">==</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">-</span><span class="mf">1</span> <span class="ow">or</span> <span class="n">b</span> <span class="o">==</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-4 '>    <span class='trace'>__Pyx_TraceLine</span>(593,0,<span class='error_goto'>__PYX_ERR(0, 593, __pyx_L1_error)</span>)
    __pyx_t_20 = ((__pyx_v_a == 0) != 0);
    if (!__pyx_t_20) {
    } else {
      __pyx_t_1 = __pyx_t_20;
      goto __pyx_L7_bool_binop_done;
    }
    __pyx_t_20 = ((__pyx_v_b == 0) != 0);
    if (!__pyx_t_20) {
    } else {
      __pyx_t_1 = __pyx_t_20;
      goto __pyx_L7_bool_binop_done;
    }
    __pyx_t_21 = 0;
    __pyx_t_6 = -1;
    if (__pyx_t_21 &lt; 0) {
      __pyx_t_21 += __pyx_v_dim.shape[0];
      if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 593, __pyx_L1_error)</span>
    }
    __pyx_t_20 = ((__pyx_v_a == ((*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_21 * __pyx_v_dim.strides[0]) ))) - 1)) != 0);
    if (!__pyx_t_20) {
    } else {
      __pyx_t_1 = __pyx_t_20;
      goto __pyx_L7_bool_binop_done;
    }
    __pyx_t_22 = 1;
    __pyx_t_6 = -1;
    if (__pyx_t_22 &lt; 0) {
      __pyx_t_22 += __pyx_v_dim.shape[0];
      if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 593, __pyx_L1_error)</span>
    }
    __pyx_t_20 = ((__pyx_v_b == ((*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_22 * __pyx_v_dim.strides[0]) ))) - 1)) != 0);
    __pyx_t_1 = __pyx_t_20;
    __pyx_L7_bool_binop_done:;
    if (__pyx_t_1) {
/* … */
      goto __pyx_L6;
    }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">594</span>:             <span class="n">l</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">N</span><span class="p">][</span><span class="n">b</span><span class="p">])</span></pre>
<pre class='cython code score-4 '>      <span class='trace'>__Pyx_TraceLine</span>(594,0,<span class='error_goto'>__PYX_ERR(0, 594, __pyx_L1_error)</span>)
      __pyx_t_23 = __pyx_v_a;
      __pyx_t_24 = __pyx_v_b;
      __pyx_t_6 = -1;
      if (__pyx_t_23 &lt; 0) {
        __pyx_t_23 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
      if (__pyx_t_24 &lt; 0) {
        __pyx_t_24 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_6 = 1;
      } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 594, __pyx_L1_error)</span>
      }
      __pyx_t_25 = (__pyx_v_a + 1);
      __pyx_t_26 = __Pyx_mod_long(__pyx_t_25, __pyx_v_N);
      __pyx_t_27 = __pyx_v_b;
      __pyx_t_6 = -1;
      if (__pyx_t_26 &lt; 0) {
        __pyx_t_26 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
      if (__pyx_t_27 &lt; 0) {
        __pyx_t_27 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_27 &lt; 0)) __pyx_t_6 = 1;
      } else if (unlikely(__pyx_t_27 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 594, __pyx_L1_error)</span>
      }
      __pyx_v_l = ((int)((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_23 * __pyx_v_arr.strides[0]) ) + __pyx_t_24 * __pyx_v_arr.strides[1]) ))) == (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_26 * __pyx_v_arr.strides[0]) ) + __pyx_t_27 * __pyx_v_arr.strides[1]) )))));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">595</span>:             <span class="n">r</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">N</span><span class="p">][</span><span class="n">b</span><span class="p">])</span></pre>
<pre class='cython code score-4 '>      <span class='trace'>__Pyx_TraceLine</span>(595,0,<span class='error_goto'>__PYX_ERR(0, 595, __pyx_L1_error)</span>)
      __pyx_t_28 = __pyx_v_a;
      __pyx_t_29 = __pyx_v_b;
      __pyx_t_6 = -1;
      if (__pyx_t_28 &lt; 0) {
        __pyx_t_28 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_28 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_28 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
      if (__pyx_t_29 &lt; 0) {
        __pyx_t_29 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_29 &lt; 0)) __pyx_t_6 = 1;
      } else if (unlikely(__pyx_t_29 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 595, __pyx_L1_error)</span>
      }
      __pyx_t_25 = (__pyx_v_a - 1);
      __pyx_t_30 = __Pyx_mod_long(__pyx_t_25, __pyx_v_N);
      __pyx_t_31 = __pyx_v_b;
      __pyx_t_6 = -1;
      if (__pyx_t_30 &lt; 0) {
        __pyx_t_30 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_30 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_30 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
      if (__pyx_t_31 &lt; 0) {
        __pyx_t_31 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_31 &lt; 0)) __pyx_t_6 = 1;
      } else if (unlikely(__pyx_t_31 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 595, __pyx_L1_error)</span>
      }
      __pyx_v_r = ((int)((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_28 * __pyx_v_arr.strides[0]) ) + __pyx_t_29 * __pyx_v_arr.strides[1]) ))) == (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_30 * __pyx_v_arr.strides[0]) ) + __pyx_t_31 * __pyx_v_arr.strides[1]) )))));
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">596</span>:             <span class="n">u</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][(</span><span class="n">b</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">D</span><span class="p">])</span></pre>
<pre class='cython code score-9 '>      <span class='trace'>__Pyx_TraceLine</span>(596,0,<span class='error_goto'>__PYX_ERR(0, 596, __pyx_L1_error)</span>)
      __pyx_t_32 = __pyx_v_a;
      __pyx_t_33 = __pyx_v_b;
      __pyx_t_6 = -1;
      if (__pyx_t_32 &lt; 0) {
        __pyx_t_32 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_32 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_32 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
      if (__pyx_t_33 &lt; 0) {
        __pyx_t_33 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_33 &lt; 0)) __pyx_t_6 = 1;
      } else if (unlikely(__pyx_t_33 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 596, __pyx_L1_error)</span>
      }
      __pyx_t_25 = (__pyx_v_b + 1);
      if (unlikely(__pyx_v_D == 0)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
        <span class='error_goto'>__PYX_ERR(0, 596, __pyx_L1_error)</span>
      }
      __pyx_t_34 = __pyx_v_a;
      __pyx_t_35 = __Pyx_mod_long(__pyx_t_25, __pyx_v_D);
      __pyx_t_6 = -1;
      if (__pyx_t_34 &lt; 0) {
        __pyx_t_34 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_34 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_34 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
      if (__pyx_t_35 &lt; 0) {
        __pyx_t_35 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_35 &lt; 0)) __pyx_t_6 = 1;
      } else if (unlikely(__pyx_t_35 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 596, __pyx_L1_error)</span>
      }
      __pyx_v_u = ((int)((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_32 * __pyx_v_arr.strides[0]) ) + __pyx_t_33 * __pyx_v_arr.strides[1]) ))) == (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_34 * __pyx_v_arr.strides[0]) ) + __pyx_t_35 * __pyx_v_arr.strides[1]) )))));
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">597</span>:             <span class="n">d</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][(</span><span class="n">b</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">D</span><span class="p">])</span></pre>
<pre class='cython code score-9 '>      <span class='trace'>__Pyx_TraceLine</span>(597,0,<span class='error_goto'>__PYX_ERR(0, 597, __pyx_L1_error)</span>)
      __pyx_t_36 = __pyx_v_a;
      __pyx_t_37 = __pyx_v_b;
      __pyx_t_6 = -1;
      if (__pyx_t_36 &lt; 0) {
        __pyx_t_36 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_36 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_36 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
      if (__pyx_t_37 &lt; 0) {
        __pyx_t_37 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_37 &lt; 0)) __pyx_t_6 = 1;
      } else if (unlikely(__pyx_t_37 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 597, __pyx_L1_error)</span>
      }
      __pyx_t_25 = (__pyx_v_b - 1);
      if (unlikely(__pyx_v_D == 0)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
        <span class='error_goto'>__PYX_ERR(0, 597, __pyx_L1_error)</span>
      }
      __pyx_t_38 = __pyx_v_a;
      __pyx_t_39 = __Pyx_mod_long(__pyx_t_25, __pyx_v_D);
      __pyx_t_6 = -1;
      if (__pyx_t_38 &lt; 0) {
        __pyx_t_38 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_38 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_38 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
      if (__pyx_t_39 &lt; 0) {
        __pyx_t_39 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_39 &lt; 0)) __pyx_t_6 = 1;
      } else if (unlikely(__pyx_t_39 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 597, __pyx_L1_error)</span>
      }
      __pyx_v_d = ((int)((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_36 * __pyx_v_arr.strides[0]) ) + __pyx_t_37 * __pyx_v_arr.strides[1]) ))) == (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_38 * __pyx_v_arr.strides[0]) ) + __pyx_t_39 * __pyx_v_arr.strides[1]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">598</span>:             <span class="n">nb</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">u</span> <span class="o">+</span> <span class="n">d</span> <span class="o">+</span> <span class="n">r</span> <span class="o">-</span> <span class="mf">2</span></pre>
<pre class='cython code score-0 '>      <span class='trace'>__Pyx_TraceLine</span>(598,0,<span class='error_goto'>__PYX_ERR(0, 598, __pyx_L1_error)</span>)
      __pyx_v_nb = ((((__pyx_v_l + __pyx_v_u) + __pyx_v_d) + __pyx_v_r) - 2);
</pre><pre class="cython line score-0">&#xA0;<span class="">599</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">600</span>:             <span class="n">l</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)][</span><span class="n">b</span><span class="p">])</span></pre>
<pre class='cython code score-4 '>    <span class='trace'>__Pyx_TraceLine</span>(600,0,<span class='error_goto'>__PYX_ERR(0, 600, __pyx_L1_error)</span>)
    /*else*/ {
      __pyx_t_40 = __pyx_v_a;
      __pyx_t_41 = __pyx_v_b;
      __pyx_t_6 = -1;
      if (__pyx_t_40 &lt; 0) {
        __pyx_t_40 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_40 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_40 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
      if (__pyx_t_41 &lt; 0) {
        __pyx_t_41 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_41 &lt; 0)) __pyx_t_6 = 1;
      } else if (unlikely(__pyx_t_41 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 600, __pyx_L1_error)</span>
      }
      __pyx_t_42 = (__pyx_v_a + 1);
      __pyx_t_43 = __pyx_v_b;
      __pyx_t_6 = -1;
      if (__pyx_t_42 &lt; 0) {
        __pyx_t_42 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_42 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_42 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
      if (__pyx_t_43 &lt; 0) {
        __pyx_t_43 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_43 &lt; 0)) __pyx_t_6 = 1;
      } else if (unlikely(__pyx_t_43 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 600, __pyx_L1_error)</span>
      }
      __pyx_v_l = ((int)((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_40 * __pyx_v_arr.strides[0]) ) + __pyx_t_41 * __pyx_v_arr.strides[1]) ))) == (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_42 * __pyx_v_arr.strides[0]) ) + __pyx_t_43 * __pyx_v_arr.strides[1]) )))));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">601</span>:             <span class="n">r</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)][</span><span class="n">b</span><span class="p">])</span></pre>
<pre class='cython code score-4 '>      <span class='trace'>__Pyx_TraceLine</span>(601,0,<span class='error_goto'>__PYX_ERR(0, 601, __pyx_L1_error)</span>)
      __pyx_t_44 = __pyx_v_a;
      __pyx_t_45 = __pyx_v_b;
      __pyx_t_6 = -1;
      if (__pyx_t_44 &lt; 0) {
        __pyx_t_44 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_44 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_44 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
      if (__pyx_t_45 &lt; 0) {
        __pyx_t_45 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_45 &lt; 0)) __pyx_t_6 = 1;
      } else if (unlikely(__pyx_t_45 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 601, __pyx_L1_error)</span>
      }
      __pyx_t_46 = (__pyx_v_a - 1);
      __pyx_t_47 = __pyx_v_b;
      __pyx_t_6 = -1;
      if (__pyx_t_46 &lt; 0) {
        __pyx_t_46 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_46 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_46 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
      if (__pyx_t_47 &lt; 0) {
        __pyx_t_47 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_47 &lt; 0)) __pyx_t_6 = 1;
      } else if (unlikely(__pyx_t_47 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 601, __pyx_L1_error)</span>
      }
      __pyx_v_r = ((int)((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_44 * __pyx_v_arr.strides[0]) ) + __pyx_t_45 * __pyx_v_arr.strides[1]) ))) == (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_46 * __pyx_v_arr.strides[0]) ) + __pyx_t_47 * __pyx_v_arr.strides[1]) )))));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">602</span>:             <span class="n">u</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][(</span><span class="n">b</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)])</span></pre>
<pre class='cython code score-4 '>      <span class='trace'>__Pyx_TraceLine</span>(602,0,<span class='error_goto'>__PYX_ERR(0, 602, __pyx_L1_error)</span>)
      __pyx_t_48 = __pyx_v_a;
      __pyx_t_49 = __pyx_v_b;
      __pyx_t_6 = -1;
      if (__pyx_t_48 &lt; 0) {
        __pyx_t_48 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_48 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_48 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
      if (__pyx_t_49 &lt; 0) {
        __pyx_t_49 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_49 &lt; 0)) __pyx_t_6 = 1;
      } else if (unlikely(__pyx_t_49 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 602, __pyx_L1_error)</span>
      }
      __pyx_t_50 = __pyx_v_a;
      __pyx_t_51 = (__pyx_v_b + 1);
      __pyx_t_6 = -1;
      if (__pyx_t_50 &lt; 0) {
        __pyx_t_50 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_50 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_50 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
      if (__pyx_t_51 &lt; 0) {
        __pyx_t_51 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_51 &lt; 0)) __pyx_t_6 = 1;
      } else if (unlikely(__pyx_t_51 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 602, __pyx_L1_error)</span>
      }
      __pyx_v_u = ((int)((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_48 * __pyx_v_arr.strides[0]) ) + __pyx_t_49 * __pyx_v_arr.strides[1]) ))) == (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_50 * __pyx_v_arr.strides[0]) ) + __pyx_t_51 * __pyx_v_arr.strides[1]) )))));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">603</span>:             <span class="n">d</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][(</span><span class="n">b</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)])</span></pre>
<pre class='cython code score-4 '>      <span class='trace'>__Pyx_TraceLine</span>(603,0,<span class='error_goto'>__PYX_ERR(0, 603, __pyx_L1_error)</span>)
      __pyx_t_52 = __pyx_v_a;
      __pyx_t_53 = __pyx_v_b;
      __pyx_t_6 = -1;
      if (__pyx_t_52 &lt; 0) {
        __pyx_t_52 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_52 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_52 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
      if (__pyx_t_53 &lt; 0) {
        __pyx_t_53 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_53 &lt; 0)) __pyx_t_6 = 1;
      } else if (unlikely(__pyx_t_53 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 603, __pyx_L1_error)</span>
      }
      __pyx_t_54 = __pyx_v_a;
      __pyx_t_55 = (__pyx_v_b - 1);
      __pyx_t_6 = -1;
      if (__pyx_t_54 &lt; 0) {
        __pyx_t_54 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_54 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_54 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
      if (__pyx_t_55 &lt; 0) {
        __pyx_t_55 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_55 &lt; 0)) __pyx_t_6 = 1;
      } else if (unlikely(__pyx_t_55 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 603, __pyx_L1_error)</span>
      }
      __pyx_v_d = ((int)((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_52 * __pyx_v_arr.strides[0]) ) + __pyx_t_53 * __pyx_v_arr.strides[1]) ))) == (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_54 * __pyx_v_arr.strides[0]) ) + __pyx_t_55 * __pyx_v_arr.strides[1]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">604</span>:             <span class="n">nb</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">u</span> <span class="o">+</span> <span class="n">d</span> <span class="o">+</span> <span class="n">r</span> <span class="o">-</span> <span class="mf">2</span></pre>
<pre class='cython code score-0 '>      <span class='trace'>__Pyx_TraceLine</span>(604,0,<span class='error_goto'>__PYX_ERR(0, 604, __pyx_L1_error)</span>)
      __pyx_v_nb = ((((__pyx_v_l + __pyx_v_u) + __pyx_v_d) + __pyx_v_r) - 2);
    }
    __pyx_L6:;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">605</span>:         <span class="k">if</span> <span class="n">nb</span> <span class="o">&lt;=</span> <span class="mf">0</span> <span class="ow">or</span> <span class="p">(</span><span class="n">rand</span><span class="p">()</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">RAND_MAX</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">cost</span><span class="p">[</span><span class="n">nb</span><span class="p">]:</span></pre>
<pre class='cython code score-7 '>    <span class='trace'>__Pyx_TraceLine</span>(605,0,<span class='error_goto'>__PYX_ERR(0, 605, __pyx_L1_error)</span>)
    __pyx_t_20 = ((__pyx_v_nb &lt;= 0) != 0);
    if (!__pyx_t_20) {
    } else {
      __pyx_t_1 = __pyx_t_20;
      goto __pyx_L12_bool_binop_done;
    }
    __pyx_t_6 = rand();
    if (unlikely(((double)RAND_MAX) == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 605, __pyx_L1_error)</span>
    }
    __pyx_t_56 = __pyx_v_nb;
    __pyx_t_57 = -1;
    if (__pyx_t_56 &lt; 0) {
      __pyx_t_56 += __pyx_v_cost.shape[0];
      if (unlikely(__pyx_t_56 &lt; 0)) __pyx_t_57 = 0;
    } else if (unlikely(__pyx_t_56 &gt;= __pyx_v_cost.shape[0])) __pyx_t_57 = 0;
    if (unlikely(__pyx_t_57 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_57);
      <span class='error_goto'>__PYX_ERR(0, 605, __pyx_L1_error)</span>
    }
    __pyx_t_20 = (((((double)__pyx_t_6) / ((double)RAND_MAX)) &lt; (*((float *) ( /* dim=0 */ (__pyx_v_cost.data + __pyx_t_56 * __pyx_v_cost.strides[0]) )))) != 0);
    __pyx_t_1 = __pyx_t_20;
    __pyx_L12_bool_binop_done:;
    if (__pyx_t_1) {
/* … */
    }
  }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">606</span>:             <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span> <span class="o">-</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span></pre>
<pre class='cython code score-4 '>      <span class='trace'>__Pyx_TraceLine</span>(606,0,<span class='error_goto'>__PYX_ERR(0, 606, __pyx_L1_error)</span>)
      __pyx_t_58 = __pyx_v_a;
      __pyx_t_59 = __pyx_v_b;
      __pyx_t_6 = -1;
      if (__pyx_t_58 &lt; 0) {
        __pyx_t_58 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_58 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_58 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
      if (__pyx_t_59 &lt; 0) {
        __pyx_t_59 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_59 &lt; 0)) __pyx_t_6 = 1;
      } else if (unlikely(__pyx_t_59 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 606, __pyx_L1_error)</span>
      }
      __pyx_t_60 = __pyx_v_a;
      __pyx_t_61 = __pyx_v_b;
      __pyx_t_6 = -1;
      if (__pyx_t_60 &lt; 0) {
        __pyx_t_60 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_60 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_60 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
      if (__pyx_t_61 &lt; 0) {
        __pyx_t_61 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_61 &lt; 0)) __pyx_t_6 = 1;
      } else if (unlikely(__pyx_t_61 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 606, __pyx_L1_error)</span>
      }
      *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_60 * __pyx_v_arr.strides[0]) ) + __pyx_t_61 * __pyx_v_arr.strides[1]) )) = (1 - (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_58 * __pyx_v_arr.strides[0]) ) + __pyx_t_59 * __pyx_v_arr.strides[1]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">607</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">608</span>: <span class="c">#===================CONWAY=================</span></pre>
<pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">609</span>: <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">conway_process_old</span><span class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">rule</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">arr</span><span class="p">):</span></pre>
<pre class='cython code score-54 '>static PyObject *__pyx_pw_6Cfuncs_49conway_process_old(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static void __pyx_f_6Cfuncs_conway_process_old(__Pyx_memviewslice __pyx_v_rule, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, CYTHON_UNUSED int __pyx_skip_dispatch) {
  __Pyx_memviewslice __pyx_v_l = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_u = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_d = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_ul = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dl = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_ur = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dr = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_NB;
  int __pyx_v_n;
  int __pyx_v_dd;
  Py_ssize_t __pyx_v_i;
  Py_ssize_t __pyx_v_j;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("conway_process_old", 0);
  <span class='trace'>__Pyx_TraceCall</span>("conway_process_old", __pyx_f[0], 609, 0, <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("Cfuncs.conway_process_old", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_l, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_r, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_u, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_d, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ul, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dl, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ur, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr, 1);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_49conway_process_old(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_48conway_process_old[] = "\n    Performs conway update on the array.\n\n    :param rule:    (pointer) update rule for this frame\n    :param dim:     (pointer) dimensions of array\n    :param array:   (2D pointer) array\n    :return:        None\n    ";
static PyObject *__pyx_pw_6Cfuncs_49conway_process_old(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_rule = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("conway_process_old (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_rule,&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_rule)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("conway_process_old", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("conway_process_old", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "conway_process_old") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_rule = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_rule.memview)) __PYX_ERR(0, 609, __pyx_L3_error)</span>
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 609, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 609, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("conway_process_old", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.conway_process_old", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_48conway_process_old(__pyx_self, __pyx_v_rule, __pyx_v_dim, __pyx_v_arr);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_48conway_process_old(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_rule, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("conway_process_old", 0);
  <span class='trace'>__Pyx_TraceCall</span>("conway_process_old (wrapper)", __pyx_f[0], 609, 0, <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_rule.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("rule"); <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L1_error)</span> }
  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6Cfuncs_conway_process_old(__pyx_v_rule, __pyx_v_dim, __pyx_v_arr, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 609, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.conway_process_old", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_rule, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">610</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">611</span>: <span class="sd">    Performs conway update on the array.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">612</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">613</span>: <span class="sd">    :param rule:    (pointer) update rule for this frame</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">614</span>: <span class="sd">    :param dim:     (pointer) dimensions of array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">615</span>: <span class="sd">    :param array:   (2D pointer) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">616</span>: <span class="sd">    :return:        None</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">617</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">618</span>:     <span class="k">if</span> <span class="n">rule</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(618,0,<span class='error_goto'>__PYX_ERR(0, 618, __pyx_L1_error)</span>)
  __pyx_t_1 = 0;
  __pyx_t_2 = -1;
  if (__pyx_t_1 &lt; 0) {
    __pyx_t_1 += __pyx_v_rule.shape[0];
    if (unlikely(__pyx_t_1 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_1 &gt;= __pyx_v_rule.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L1_error)</span>
  }
  __pyx_t_3 = (((*((int *) ( /* dim=0 */ (__pyx_v_rule.data + __pyx_t_1 * __pyx_v_rule.strides[0]) ))) == -1L) != 0);
  if (__pyx_t_3) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">619</span>:         <span class="k">return</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(619,0,<span class='error_goto'>__PYX_ERR(0, 619, __pyx_L1_error)</span>)
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">620</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">ul</span><span class="p">,</span> <span class="n">dl</span><span class="p">,</span> <span class="n">ur</span><span class="p">,</span> <span class="n">dr</span></pre>
<pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">621</span>:     <span class="n">l</span> <span class="o">=</span> <span class="n">cy</span><span class="o">.</span><span class="n">roll_columns</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-49 '>  <span class='trace'>__Pyx_TraceLine</span>(621,0,<span class='error_goto'>__PYX_ERR(0, 621, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_cy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 621, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_roll_columns);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 621, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_dim, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 621, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_arr, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 621, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_8 = NULL;
  __pyx_t_2 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_2 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_6)) {
    PyObject *__pyx_temp[4] = {__pyx_t_8, __pyx_int_1, __pyx_t_5, __pyx_t_7};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_6, __pyx_temp+1-__pyx_t_2, 3+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 621, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_6)) {
    PyObject *__pyx_temp[4] = {__pyx_t_8, __pyx_int_1, __pyx_t_5, __pyx_t_7};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_6, __pyx_temp+1-__pyx_t_2, 3+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 621, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  {
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 621, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (__pyx_t_8) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8); __pyx_t_8 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_2, __pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_2, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2+__pyx_t_2, __pyx_t_7);
    __pyx_t_5 = 0;
    __pyx_t_7 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 621, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 621, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_l = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">622</span>:     <span class="n">r</span> <span class="o">=</span> <span class="n">cy</span><span class="o">.</span><span class="n">roll_columns</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-49 '>  <span class='trace'>__Pyx_TraceLine</span>(622,0,<span class='error_goto'>__PYX_ERR(0, 622, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_cy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 622, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_roll_columns);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 622, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_dim, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 622, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_arr, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 622, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_5 = NULL;
  __pyx_t_2 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      __pyx_t_2 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_9)) {
    PyObject *__pyx_temp[4] = {__pyx_t_5, __pyx_int_neg_1, __pyx_t_6, __pyx_t_7};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_9, __pyx_temp+1-__pyx_t_2, 3+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 622, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_9)) {
    PyObject *__pyx_temp[4] = {__pyx_t_5, __pyx_int_neg_1, __pyx_t_6, __pyx_t_7};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_9, __pyx_temp+1-__pyx_t_2, 3+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 622, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  {
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 622, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    if (__pyx_t_5) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_5); __pyx_t_5 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_2, __pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_2, __pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2+__pyx_t_2, __pyx_t_7);
    __pyx_t_6 = 0;
    __pyx_t_7 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 622, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 622, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_r = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">623</span>:     <span class="n">u</span> <span class="o">=</span> <span class="n">cy</span><span class="o">.</span><span class="n">roll_rows</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-49 '>  <span class='trace'>__Pyx_TraceLine</span>(623,0,<span class='error_goto'>__PYX_ERR(0, 623, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_cy);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 623, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_roll_rows);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 623, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = __pyx_memoryview_fromslice(__pyx_v_dim, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 623, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_arr, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 623, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_6 = NULL;
  __pyx_t_2 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      __pyx_t_2 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_8)) {
    PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_int_1, __pyx_t_9, __pyx_t_7};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_8, __pyx_temp+1-__pyx_t_2, 3+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 623, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_8)) {
    PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_int_1, __pyx_t_9, __pyx_t_7};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_8, __pyx_temp+1-__pyx_t_2, 3+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 623, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 623, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (__pyx_t_6) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6); __pyx_t_6 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_2, __pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_2, __pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2+__pyx_t_2, __pyx_t_7);
    __pyx_t_9 = 0;
    __pyx_t_7 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 623, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 623, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_u = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">624</span>:     <span class="n">d</span> <span class="o">=</span> <span class="n">cy</span><span class="o">.</span><span class="n">roll_rows</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-49 '>  <span class='trace'>__Pyx_TraceLine</span>(624,0,<span class='error_goto'>__PYX_ERR(0, 624, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_cy);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 624, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_roll_rows);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 624, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_dim, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 624, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_arr, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 624, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = NULL;
  __pyx_t_2 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_9)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_2 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
    PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_int_neg_1, __pyx_t_8, __pyx_t_7};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_2, 3+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 624, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
    PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_int_neg_1, __pyx_t_8, __pyx_t_7};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_2, 3+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 624, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  {
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 624, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (__pyx_t_9) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_9); __pyx_t_9 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_2, __pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_2, __pyx_t_8);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2+__pyx_t_2, __pyx_t_7);
    __pyx_t_8 = 0;
    __pyx_t_7 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 624, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 624, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_d = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">625</span>:     <span class="n">ul</span> <span class="o">=</span> <span class="n">cy</span><span class="o">.</span><span class="n">roll_rows</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span></pre>
<pre class='cython code score-49 '>  <span class='trace'>__Pyx_TraceLine</span>(625,0,<span class='error_goto'>__PYX_ERR(0, 625, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_cy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 625, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_roll_rows);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 625, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_dim, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 625, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_l, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 625, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_8 = NULL;
  __pyx_t_2 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_2 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_6)) {
    PyObject *__pyx_temp[4] = {__pyx_t_8, __pyx_int_1, __pyx_t_5, __pyx_t_7};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_6, __pyx_temp+1-__pyx_t_2, 3+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 625, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_6)) {
    PyObject *__pyx_temp[4] = {__pyx_t_8, __pyx_int_1, __pyx_t_5, __pyx_t_7};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_6, __pyx_temp+1-__pyx_t_2, 3+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 625, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  {
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 625, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (__pyx_t_8) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8); __pyx_t_8 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_2, __pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_2, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2+__pyx_t_2, __pyx_t_7);
    __pyx_t_5 = 0;
    __pyx_t_7 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 625, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 625, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_ul = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">626</span>:     <span class="n">dl</span> <span class="o">=</span> <span class="n">cy</span><span class="o">.</span><span class="n">roll_rows</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span></pre>
<pre class='cython code score-49 '>  <span class='trace'>__Pyx_TraceLine</span>(626,0,<span class='error_goto'>__PYX_ERR(0, 626, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_cy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_roll_rows);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_dim, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_l, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_5 = NULL;
  __pyx_t_2 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      __pyx_t_2 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_9)) {
    PyObject *__pyx_temp[4] = {__pyx_t_5, __pyx_int_neg_1, __pyx_t_6, __pyx_t_7};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_9, __pyx_temp+1-__pyx_t_2, 3+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_9)) {
    PyObject *__pyx_temp[4] = {__pyx_t_5, __pyx_int_neg_1, __pyx_t_6, __pyx_t_7};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_9, __pyx_temp+1-__pyx_t_2, 3+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  {
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    if (__pyx_t_5) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_5); __pyx_t_5 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_2, __pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_2, __pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2+__pyx_t_2, __pyx_t_7);
    __pyx_t_6 = 0;
    __pyx_t_7 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_dl = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">627</span>:     <span class="n">ur</span> <span class="o">=</span> <span class="n">cy</span><span class="o">.</span><span class="n">roll_rows</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span></pre>
<pre class='cython code score-49 '>  <span class='trace'>__Pyx_TraceLine</span>(627,0,<span class='error_goto'>__PYX_ERR(0, 627, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_cy);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 627, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_roll_rows);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 627, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = __pyx_memoryview_fromslice(__pyx_v_dim, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 627, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_r, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 627, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_6 = NULL;
  __pyx_t_2 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      __pyx_t_2 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_8)) {
    PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_int_1, __pyx_t_9, __pyx_t_7};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_8, __pyx_temp+1-__pyx_t_2, 3+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 627, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_8)) {
    PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_int_1, __pyx_t_9, __pyx_t_7};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_8, __pyx_temp+1-__pyx_t_2, 3+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 627, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 627, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (__pyx_t_6) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6); __pyx_t_6 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_2, __pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_2, __pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2+__pyx_t_2, __pyx_t_7);
    __pyx_t_9 = 0;
    __pyx_t_7 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 627, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 627, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_ur = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">628</span>:     <span class="n">dr</span> <span class="o">=</span> <span class="n">cy</span><span class="o">.</span><span class="n">roll_rows</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span></pre>
<pre class='cython code score-49 '>  <span class='trace'>__Pyx_TraceLine</span>(628,0,<span class='error_goto'>__PYX_ERR(0, 628, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_cy);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 628, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_roll_rows);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 628, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_dim, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 628, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_r, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 628, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = NULL;
  __pyx_t_2 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_9)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_2 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
    PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_int_neg_1, __pyx_t_8, __pyx_t_7};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_2, 3+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 628, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
    PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_int_neg_1, __pyx_t_8, __pyx_t_7};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_2, 3+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 628, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  {
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 628, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (__pyx_t_9) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_9); __pyx_t_9 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_2, __pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_2, __pyx_t_8);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2+__pyx_t_2, __pyx_t_7);
    __pyx_t_8 = 0;
    __pyx_t_7 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 628, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 628, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_dr = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">629</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">NB</span><span class="p">,</span> <span class="nf">n</span><span class="p">,</span> <span class="nf">dd</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">630</span>:     <span class="n">n</span> <span class="o">=</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(630,0,<span class='error_goto'>__PYX_ERR(0, 630, __pyx_L1_error)</span>)
  __pyx_t_11 = 0;
  __pyx_t_2 = -1;
  if (__pyx_t_11 &lt; 0) {
    __pyx_t_11 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_dim.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 630, __pyx_L1_error)</span>
  }
  __pyx_v_n = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_11 * __pyx_v_dim.strides[0]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">631</span>:     <span class="n">dd</span> <span class="o">=</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(631,0,<span class='error_goto'>__PYX_ERR(0, 631, __pyx_L1_error)</span>)
  __pyx_t_12 = 1;
  __pyx_t_2 = -1;
  if (__pyx_t_12 &lt; 0) {
    __pyx_t_12 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_dim.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 631, __pyx_L1_error)</span>
  }
  __pyx_v_dd = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_12 * __pyx_v_dim.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">632</span>:     <span class="k">cdef</span> <span class="kt">Py_ssize_t</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">633</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(633,0,<span class='error_goto'>__PYX_ERR(0, 633, __pyx_L1_error)</span>)
  __pyx_t_2 = __pyx_v_n;
  __pyx_t_13 = __pyx_t_2;
  for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
    __pyx_v_i = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">634</span>:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dd</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(634,0,<span class='error_goto'>__PYX_ERR(0, 634, __pyx_L1_error)</span>)
    __pyx_t_15 = __pyx_v_dd;
    __pyx_t_16 = __pyx_t_15;
    for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
      __pyx_v_j = __pyx_t_17;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">635</span>:             <span class="n">NB</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>      <span class='trace'>__Pyx_TraceLine</span>(635,0,<span class='error_goto'>__PYX_ERR(0, 635, __pyx_L1_error)</span>)
      __pyx_v_NB = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">636</span>:             <span class="n">NB</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">ul</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">ur</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>\</pre>
<pre class='cython code score-12 '>      <span class='trace'>__Pyx_TraceLine</span>(636,0,<span class='error_goto'>__PYX_ERR(0, 636, __pyx_L1_error)</span>)
      __pyx_t_18 = __pyx_v_i;
      __pyx_t_19 = __pyx_v_j;
      __pyx_t_20 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_l.shape[0];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_20 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_l.shape[0])) __pyx_t_20 = 0;
      if (__pyx_t_19 &lt; 0) {
        __pyx_t_19 += __pyx_v_l.shape[1];
        if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_20 = 1;
      } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_l.shape[1])) __pyx_t_20 = 1;
      if (unlikely(__pyx_t_20 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
        <span class='error_goto'>__PYX_ERR(0, 636, __pyx_L1_error)</span>
      }
      __pyx_t_21 = __pyx_v_i;
      __pyx_t_22 = __pyx_v_j;
      __pyx_t_20 = -1;
      if (__pyx_t_21 &lt; 0) {
        __pyx_t_21 += __pyx_v_r.shape[0];
        if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_20 = 0;
      } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_r.shape[0])) __pyx_t_20 = 0;
      if (__pyx_t_22 &lt; 0) {
        __pyx_t_22 += __pyx_v_r.shape[1];
        if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_20 = 1;
      } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_r.shape[1])) __pyx_t_20 = 1;
      if (unlikely(__pyx_t_20 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
        <span class='error_goto'>__PYX_ERR(0, 636, __pyx_L1_error)</span>
      }
      __pyx_t_23 = __pyx_v_i;
      __pyx_t_24 = __pyx_v_j;
      __pyx_t_20 = -1;
      if (__pyx_t_23 &lt; 0) {
        __pyx_t_23 += __pyx_v_u.shape[0];
        if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_20 = 0;
      } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_u.shape[0])) __pyx_t_20 = 0;
      if (__pyx_t_24 &lt; 0) {
        __pyx_t_24 += __pyx_v_u.shape[1];
        if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_20 = 1;
      } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_u.shape[1])) __pyx_t_20 = 1;
      if (unlikely(__pyx_t_20 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
        <span class='error_goto'>__PYX_ERR(0, 636, __pyx_L1_error)</span>
      }
      __pyx_t_25 = __pyx_v_i;
      __pyx_t_26 = __pyx_v_j;
      __pyx_t_20 = -1;
      if (__pyx_t_25 &lt; 0) {
        __pyx_t_25 += __pyx_v_d.shape[0];
        if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_20 = 0;
      } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_d.shape[0])) __pyx_t_20 = 0;
      if (__pyx_t_26 &lt; 0) {
        __pyx_t_26 += __pyx_v_d.shape[1];
        if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_20 = 1;
      } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_d.shape[1])) __pyx_t_20 = 1;
      if (unlikely(__pyx_t_20 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
        <span class='error_goto'>__PYX_ERR(0, 636, __pyx_L1_error)</span>
      }
      __pyx_t_27 = __pyx_v_i;
      __pyx_t_28 = __pyx_v_j;
      __pyx_t_20 = -1;
      if (__pyx_t_27 &lt; 0) {
        __pyx_t_27 += __pyx_v_ul.shape[0];
        if (unlikely(__pyx_t_27 &lt; 0)) __pyx_t_20 = 0;
      } else if (unlikely(__pyx_t_27 &gt;= __pyx_v_ul.shape[0])) __pyx_t_20 = 0;
      if (__pyx_t_28 &lt; 0) {
        __pyx_t_28 += __pyx_v_ul.shape[1];
        if (unlikely(__pyx_t_28 &lt; 0)) __pyx_t_20 = 1;
      } else if (unlikely(__pyx_t_28 &gt;= __pyx_v_ul.shape[1])) __pyx_t_20 = 1;
      if (unlikely(__pyx_t_20 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
        <span class='error_goto'>__PYX_ERR(0, 636, __pyx_L1_error)</span>
      }
      __pyx_t_29 = __pyx_v_i;
      __pyx_t_30 = __pyx_v_j;
      __pyx_t_20 = -1;
      if (__pyx_t_29 &lt; 0) {
        __pyx_t_29 += __pyx_v_ur.shape[0];
        if (unlikely(__pyx_t_29 &lt; 0)) __pyx_t_20 = 0;
      } else if (unlikely(__pyx_t_29 &gt;= __pyx_v_ur.shape[0])) __pyx_t_20 = 0;
      if (__pyx_t_30 &lt; 0) {
        __pyx_t_30 += __pyx_v_ur.shape[1];
        if (unlikely(__pyx_t_30 &lt; 0)) __pyx_t_20 = 1;
      } else if (unlikely(__pyx_t_30 &gt;= __pyx_v_ur.shape[1])) __pyx_t_20 = 1;
      if (unlikely(__pyx_t_20 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
        <span class='error_goto'>__PYX_ERR(0, 636, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">637</span>:                 <span class="o">+</span> <span class="n">dl</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">dr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-4 '>      <span class='trace'>__Pyx_TraceLine</span>(637,0,<span class='error_goto'>__PYX_ERR(0, 637, __pyx_L1_error)</span>)
      __pyx_t_31 = __pyx_v_i;
      __pyx_t_32 = __pyx_v_j;
      __pyx_t_20 = -1;
      if (__pyx_t_31 &lt; 0) {
        __pyx_t_31 += __pyx_v_dl.shape[0];
        if (unlikely(__pyx_t_31 &lt; 0)) __pyx_t_20 = 0;
      } else if (unlikely(__pyx_t_31 &gt;= __pyx_v_dl.shape[0])) __pyx_t_20 = 0;
      if (__pyx_t_32 &lt; 0) {
        __pyx_t_32 += __pyx_v_dl.shape[1];
        if (unlikely(__pyx_t_32 &lt; 0)) __pyx_t_20 = 1;
      } else if (unlikely(__pyx_t_32 &gt;= __pyx_v_dl.shape[1])) __pyx_t_20 = 1;
      if (unlikely(__pyx_t_20 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
        <span class='error_goto'>__PYX_ERR(0, 637, __pyx_L1_error)</span>
      }
      __pyx_t_33 = __pyx_v_i;
      __pyx_t_34 = __pyx_v_j;
      __pyx_t_20 = -1;
      if (__pyx_t_33 &lt; 0) {
        __pyx_t_33 += __pyx_v_dr.shape[0];
        if (unlikely(__pyx_t_33 &lt; 0)) __pyx_t_20 = 0;
      } else if (unlikely(__pyx_t_33 &gt;= __pyx_v_dr.shape[0])) __pyx_t_20 = 0;
      if (__pyx_t_34 &lt; 0) {
        __pyx_t_34 += __pyx_v_dr.shape[1];
        if (unlikely(__pyx_t_34 &lt; 0)) __pyx_t_20 = 1;
      } else if (unlikely(__pyx_t_34 &gt;= __pyx_v_dr.shape[1])) __pyx_t_20 = 1;
      if (unlikely(__pyx_t_20 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
        <span class='error_goto'>__PYX_ERR(0, 637, __pyx_L1_error)</span>
      }
      __pyx_v_NB = ((((((((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_l.data + __pyx_t_18 * __pyx_v_l.strides[0]) ) + __pyx_t_19 * __pyx_v_l.strides[1]) ))) + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_21 * __pyx_v_r.strides[0]) ) + __pyx_t_22 * __pyx_v_r.strides[1]) )))) + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_23 * __pyx_v_u.strides[0]) ) + __pyx_t_24 * __pyx_v_u.strides[1]) )))) + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_d.data + __pyx_t_25 * __pyx_v_d.strides[0]) ) + __pyx_t_26 * __pyx_v_d.strides[1]) )))) + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ul.data + __pyx_t_27 * __pyx_v_ul.strides[0]) ) + __pyx_t_28 * __pyx_v_ul.strides[1]) )))) + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ur.data + __pyx_t_29 * __pyx_v_ur.strides[0]) ) + __pyx_t_30 * __pyx_v_ur.strides[1]) )))) + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_dl.data + __pyx_t_31 * __pyx_v_dl.strides[0]) ) + __pyx_t_32 * __pyx_v_dl.strides[1]) )))) + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_dr.data + __pyx_t_33 * __pyx_v_dr.strides[0]) ) + __pyx_t_34 * __pyx_v_dr.strides[1]) ))));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">638</span>:             <span class="k">if</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(638,0,<span class='error_goto'>__PYX_ERR(0, 638, __pyx_L1_error)</span>)
      __pyx_t_35 = __pyx_v_i;
      __pyx_t_36 = __pyx_v_j;
      __pyx_t_20 = -1;
      if (__pyx_t_35 &lt; 0) {
        __pyx_t_35 += __pyx_v_arr.shape[0];
        if (unlikely(__pyx_t_35 &lt; 0)) __pyx_t_20 = 0;
      } else if (unlikely(__pyx_t_35 &gt;= __pyx_v_arr.shape[0])) __pyx_t_20 = 0;
      if (__pyx_t_36 &lt; 0) {
        __pyx_t_36 += __pyx_v_arr.shape[1];
        if (unlikely(__pyx_t_36 &lt; 0)) __pyx_t_20 = 1;
      } else if (unlikely(__pyx_t_36 &gt;= __pyx_v_arr.shape[1])) __pyx_t_20 = 1;
      if (unlikely(__pyx_t_20 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
        <span class='error_goto'>__PYX_ERR(0, 638, __pyx_L1_error)</span>
      }
      __pyx_t_3 = (((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_35 * __pyx_v_arr.strides[0]) ) + __pyx_t_36 * __pyx_v_arr.strides[1]) ))) == 1) != 0);
      if (__pyx_t_3) {
/* … */
        goto __pyx_L8;
      }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">639</span>:                 <span class="k">if</span> <span class="ow">not</span> <span class="n">rule</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">NB</span> <span class="o">&lt;=</span> <span class="n">rule</span><span class="p">[</span><span class="mf">1</span><span class="p">]:</span></pre>
<pre class='cython code score-4 '>        <span class='trace'>__Pyx_TraceLine</span>(639,0,<span class='error_goto'>__PYX_ERR(0, 639, __pyx_L1_error)</span>)
        __pyx_t_37 = 0;
        __pyx_t_20 = -1;
        if (__pyx_t_37 &lt; 0) {
          __pyx_t_37 += __pyx_v_rule.shape[0];
          if (unlikely(__pyx_t_37 &lt; 0)) __pyx_t_20 = 0;
        } else if (unlikely(__pyx_t_37 &gt;= __pyx_v_rule.shape[0])) __pyx_t_20 = 0;
        if (unlikely(__pyx_t_20 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
          <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L1_error)</span>
        }
        __pyx_t_3 = ((*((int *) ( /* dim=0 */ (__pyx_v_rule.data + __pyx_t_37 * __pyx_v_rule.strides[0]) ))) &lt;= __pyx_v_NB);
        if (__pyx_t_3) {
          __pyx_t_38 = 1;
          __pyx_t_20 = -1;
          if (__pyx_t_38 &lt; 0) {
            __pyx_t_38 += __pyx_v_rule.shape[0];
            if (unlikely(__pyx_t_38 &lt; 0)) __pyx_t_20 = 0;
          } else if (unlikely(__pyx_t_38 &gt;= __pyx_v_rule.shape[0])) __pyx_t_20 = 0;
          if (unlikely(__pyx_t_20 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
            <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L1_error)</span>
          }
          __pyx_t_3 = (__pyx_v_NB &lt;= (*((int *) ( /* dim=0 */ (__pyx_v_rule.data + __pyx_t_38 * __pyx_v_rule.strides[0]) ))));
        }
        __pyx_t_39 = ((!(__pyx_t_3 != 0)) != 0);
        if (__pyx_t_39) {
/* … */
        }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">640</span>:                     <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-2 '>          <span class='trace'>__Pyx_TraceLine</span>(640,0,<span class='error_goto'>__PYX_ERR(0, 640, __pyx_L1_error)</span>)
          __pyx_t_40 = __pyx_v_i;
          __pyx_t_41 = __pyx_v_j;
          __pyx_t_20 = -1;
          if (__pyx_t_40 &lt; 0) {
            __pyx_t_40 += __pyx_v_arr.shape[0];
            if (unlikely(__pyx_t_40 &lt; 0)) __pyx_t_20 = 0;
          } else if (unlikely(__pyx_t_40 &gt;= __pyx_v_arr.shape[0])) __pyx_t_20 = 0;
          if (__pyx_t_41 &lt; 0) {
            __pyx_t_41 += __pyx_v_arr.shape[1];
            if (unlikely(__pyx_t_41 &lt; 0)) __pyx_t_20 = 1;
          } else if (unlikely(__pyx_t_41 &gt;= __pyx_v_arr.shape[1])) __pyx_t_20 = 1;
          if (unlikely(__pyx_t_20 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
            <span class='error_goto'>__PYX_ERR(0, 640, __pyx_L1_error)</span>
          }
          *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_40 * __pyx_v_arr.strides[0]) ) + __pyx_t_41 * __pyx_v_arr.strides[1]) )) = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">641</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">642</span>:                 <span class="k">if</span> <span class="n">rule</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">NB</span> <span class="o">&lt;=</span> <span class="n">rule</span><span class="p">[</span><span class="mf">3</span><span class="p">]:</span></pre>
<pre class='cython code score-4 '>      <span class='trace'>__Pyx_TraceLine</span>(642,0,<span class='error_goto'>__PYX_ERR(0, 642, __pyx_L1_error)</span>)
      /*else*/ {
        __pyx_t_42 = 2;
        __pyx_t_20 = -1;
        if (__pyx_t_42 &lt; 0) {
          __pyx_t_42 += __pyx_v_rule.shape[0];
          if (unlikely(__pyx_t_42 &lt; 0)) __pyx_t_20 = 0;
        } else if (unlikely(__pyx_t_42 &gt;= __pyx_v_rule.shape[0])) __pyx_t_20 = 0;
        if (unlikely(__pyx_t_20 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
          <span class='error_goto'>__PYX_ERR(0, 642, __pyx_L1_error)</span>
        }
        __pyx_t_39 = ((*((int *) ( /* dim=0 */ (__pyx_v_rule.data + __pyx_t_42 * __pyx_v_rule.strides[0]) ))) &lt;= __pyx_v_NB);
        if (__pyx_t_39) {
          __pyx_t_43 = 3;
          __pyx_t_20 = -1;
          if (__pyx_t_43 &lt; 0) {
            __pyx_t_43 += __pyx_v_rule.shape[0];
            if (unlikely(__pyx_t_43 &lt; 0)) __pyx_t_20 = 0;
          } else if (unlikely(__pyx_t_43 &gt;= __pyx_v_rule.shape[0])) __pyx_t_20 = 0;
          if (unlikely(__pyx_t_20 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
            <span class='error_goto'>__PYX_ERR(0, 642, __pyx_L1_error)</span>
          }
          __pyx_t_39 = (__pyx_v_NB &lt;= (*((int *) ( /* dim=0 */ (__pyx_v_rule.data + __pyx_t_43 * __pyx_v_rule.strides[0]) ))));
        }
        __pyx_t_3 = (__pyx_t_39 != 0);
        if (__pyx_t_3) {
/* … */
        }
      }
      __pyx_L8:;
    }
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">643</span>:                     <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-2 '>          <span class='trace'>__Pyx_TraceLine</span>(643,0,<span class='error_goto'>__PYX_ERR(0, 643, __pyx_L1_error)</span>)
          __pyx_t_44 = __pyx_v_i;
          __pyx_t_45 = __pyx_v_j;
          __pyx_t_20 = -1;
          if (__pyx_t_44 &lt; 0) {
            __pyx_t_44 += __pyx_v_arr.shape[0];
            if (unlikely(__pyx_t_44 &lt; 0)) __pyx_t_20 = 0;
          } else if (unlikely(__pyx_t_44 &gt;= __pyx_v_arr.shape[0])) __pyx_t_20 = 0;
          if (__pyx_t_45 &lt; 0) {
            __pyx_t_45 += __pyx_v_arr.shape[1];
            if (unlikely(__pyx_t_45 &lt; 0)) __pyx_t_20 = 1;
          } else if (unlikely(__pyx_t_45 &gt;= __pyx_v_arr.shape[1])) __pyx_t_20 = 1;
          if (unlikely(__pyx_t_20 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_20);
            <span class='error_goto'>__PYX_ERR(0, 643, __pyx_L1_error)</span>
          }
          *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_44 * __pyx_v_arr.strides[0]) ) + __pyx_t_45 * __pyx_v_arr.strides[1]) )) = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">644</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">645</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">646</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">647</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">648</span>: <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">conway_process</span><span class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">rule</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">arr</span><span class="p">):</span></pre>
<pre class='cython code score-50 '>static PyObject *__pyx_pw_6Cfuncs_51conway_process(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static void __pyx_f_6Cfuncs_conway_process(__Pyx_memviewslice __pyx_v_rule, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, CYTHON_UNUSED int __pyx_skip_dispatch) {
  int __pyx_v_NB;
  int __pyx_v_n;
  int __pyx_v_d;
  __Pyx_memviewslice __pyx_v_pos = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr_c = { 0, 0, { 0 }, { 0 }, { 0 } };
  Py_ssize_t __pyx_v_i;
  Py_ssize_t __pyx_v_j;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("conway_process", 0);
  <span class='trace'>__Pyx_TraceCall</span>("conway_process", __pyx_f[0], 648, 0, <span class='error_goto'>__PYX_ERR(0, 648, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("Cfuncs.conway_process", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pos, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr_c, 1);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_51conway_process(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_50conway_process[] = "\n    Performs conway update on the array.\n\n    :param rule:    (pointer) update rule for this frame\n    :param dim:     (pointer) dimensions of array\n    :param array:   (2D pointer) array\n    :return:        None\n    ";
static PyObject *__pyx_pw_6Cfuncs_51conway_process(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_rule = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("conway_process (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_rule,&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_rule)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("conway_process", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 648, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("conway_process", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 648, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "conway_process") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 648, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_rule = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_rule.memview)) __PYX_ERR(0, 648, __pyx_L3_error)</span>
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 648, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 648, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("conway_process", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 648, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.conway_process", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_50conway_process(__pyx_self, __pyx_v_rule, __pyx_v_dim, __pyx_v_arr);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_50conway_process(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_rule, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("conway_process", 0);
  <span class='trace'>__Pyx_TraceCall</span>("conway_process (wrapper)", __pyx_f[0], 648, 0, <span class='error_goto'>__PYX_ERR(0, 648, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_rule.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("rule"); <span class='error_goto'>__PYX_ERR(0, 648, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 648, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 648, __pyx_L1_error)</span> }
  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6Cfuncs_conway_process(__pyx_v_rule, __pyx_v_dim, __pyx_v_arr, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 648, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.conway_process", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_rule, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">649</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">650</span>: <span class="sd">    Performs conway update on the array.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">651</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">652</span>: <span class="sd">    :param rule:    (pointer) update rule for this frame</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">653</span>: <span class="sd">    :param dim:     (pointer) dimensions of array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">654</span>: <span class="sd">    :param array:   (2D pointer) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">655</span>: <span class="sd">    :return:        None</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">656</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">657</span>:     <span class="k">if</span> <span class="n">rule</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(657,0,<span class='error_goto'>__PYX_ERR(0, 657, __pyx_L1_error)</span>)
  __pyx_t_1 = 0;
  __pyx_t_2 = (((*((int *) ( /* dim=0 */ (__pyx_v_rule.data + __pyx_t_1 * __pyx_v_rule.strides[0]) ))) == -1L) != 0);
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">658</span>:         <span class="k">return</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(658,0,<span class='error_goto'>__PYX_ERR(0, 658, __pyx_L1_error)</span>)
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">659</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">NB</span><span class="p">,</span> <span class="nf">n</span><span class="p">,</span> <span class="nf">d</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">660</span>:     <span class="n">n</span> <span class="o">=</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(660,0,<span class='error_goto'>__PYX_ERR(0, 660, __pyx_L1_error)</span>)
  __pyx_t_3 = 0;
  __pyx_v_n = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_3 * __pyx_v_dim.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">661</span>:     <span class="n">d</span> <span class="o">=</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(661,0,<span class='error_goto'>__PYX_ERR(0, 661, __pyx_L1_error)</span>)
  __pyx_t_4 = 1;
  __pyx_v_d = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_4 * __pyx_v_dim.strides[0]) )));
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">662</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:]</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-23 '>  <span class='trace'>__Pyx_TraceLine</span>(662,0,<span class='error_goto'>__PYX_ERR(0, 662, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 662, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_0);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 662, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 662, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 662, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_pos = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">663</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">arr_c</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(663,0,<span class='error_goto'>__PYX_ERR(0, 663, __pyx_L1_error)</span>)
  __pyx_t_8 = __pyx_memoryview_copy_slice_d_dc_int_c(__pyx_v_arr);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 663, __pyx_L1_error)</span>
  __pyx_v_arr_c = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">664</span>:     <span class="k">cdef</span> <span class="kt">Py_ssize_t</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">665</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(665,0,<span class='error_goto'>__PYX_ERR(0, 665, __pyx_L1_error)</span>)
  __pyx_t_9 = __pyx_v_n;
  __pyx_t_10 = __pyx_t_9;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">666</span>:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(666,0,<span class='error_goto'>__PYX_ERR(0, 666, __pyx_L1_error)</span>)
    __pyx_t_12 = __pyx_v_d;
    __pyx_t_13 = __pyx_t_12;
    for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
      __pyx_v_j = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">667</span>:             <span class="n">pos</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span></pre>
<pre class='cython code score-0 '>      <span class='trace'>__Pyx_TraceLine</span>(667,0,<span class='error_goto'>__PYX_ERR(0, 667, __pyx_L1_error)</span>)
      __pyx_t_15 = 0;
      *((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_15 * __pyx_v_pos.strides[0]) )) = __pyx_v_i;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">668</span>:             <span class="n">pos</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span></pre>
<pre class='cython code score-0 '>      <span class='trace'>__Pyx_TraceLine</span>(668,0,<span class='error_goto'>__PYX_ERR(0, 668, __pyx_L1_error)</span>)
      __pyx_t_16 = 1;
      *((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_16 * __pyx_v_pos.strides[0]) )) = __pyx_v_j;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">669</span>:             <span class="n">NB</span> <span class="o">=</span> <span class="n">neumann_neighbors_sum</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr_c</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      <span class='trace'>__Pyx_TraceLine</span>(669,0,<span class='error_goto'>__PYX_ERR(0, 669, __pyx_L1_error)</span>)
      __pyx_v_NB = __pyx_f_6Cfuncs_neumann_neighbors_sum(__pyx_v_pos, __pyx_v_dim, __pyx_v_arr_c);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">670</span>:             <span class="k">if</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      <span class='trace'>__Pyx_TraceLine</span>(670,0,<span class='error_goto'>__PYX_ERR(0, 670, __pyx_L1_error)</span>)
      __pyx_t_17 = __pyx_v_i;
      __pyx_t_18 = __pyx_v_j;
      __pyx_t_2 = (((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_17 * __pyx_v_arr.strides[0]) )) + __pyx_t_18)) ))) == 1) != 0);
      if (__pyx_t_2) {
/* … */
        goto __pyx_L8;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">671</span>:                 <span class="k">if</span> <span class="ow">not</span> <span class="n">rule</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">NB</span> <span class="o">&lt;=</span> <span class="n">rule</span><span class="p">[</span><span class="mf">1</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>        <span class='trace'>__Pyx_TraceLine</span>(671,0,<span class='error_goto'>__PYX_ERR(0, 671, __pyx_L1_error)</span>)
        __pyx_t_19 = 0;
        __pyx_t_2 = ((*((int *) ( /* dim=0 */ (__pyx_v_rule.data + __pyx_t_19 * __pyx_v_rule.strides[0]) ))) &lt;= __pyx_v_NB);
        if (__pyx_t_2) {
          __pyx_t_20 = 1;
          __pyx_t_2 = (__pyx_v_NB &lt;= (*((int *) ( /* dim=0 */ (__pyx_v_rule.data + __pyx_t_20 * __pyx_v_rule.strides[0]) ))));
        }
        __pyx_t_21 = ((!(__pyx_t_2 != 0)) != 0);
        if (__pyx_t_21) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">672</span>:                     <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>          <span class='trace'>__Pyx_TraceLine</span>(672,0,<span class='error_goto'>__PYX_ERR(0, 672, __pyx_L1_error)</span>)
          __pyx_t_22 = __pyx_v_i;
          __pyx_t_23 = __pyx_v_j;
          *((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_22 * __pyx_v_arr.strides[0]) )) + __pyx_t_23)) )) = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">673</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">674</span>:                 <span class="k">if</span> <span class="n">rule</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">NB</span> <span class="o">&lt;=</span> <span class="n">rule</span><span class="p">[</span><span class="mf">3</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>      <span class='trace'>__Pyx_TraceLine</span>(674,0,<span class='error_goto'>__PYX_ERR(0, 674, __pyx_L1_error)</span>)
      /*else*/ {
        __pyx_t_24 = 2;
        __pyx_t_21 = ((*((int *) ( /* dim=0 */ (__pyx_v_rule.data + __pyx_t_24 * __pyx_v_rule.strides[0]) ))) &lt;= __pyx_v_NB);
        if (__pyx_t_21) {
          __pyx_t_25 = 3;
          __pyx_t_21 = (__pyx_v_NB &lt;= (*((int *) ( /* dim=0 */ (__pyx_v_rule.data + __pyx_t_25 * __pyx_v_rule.strides[0]) ))));
        }
        __pyx_t_2 = (__pyx_t_21 != 0);
        if (__pyx_t_2) {
/* … */
        }
      }
      __pyx_L8:;
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">675</span>:                     <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>          <span class='trace'>__Pyx_TraceLine</span>(675,0,<span class='error_goto'>__PYX_ERR(0, 675, __pyx_L1_error)</span>)
          __pyx_t_26 = __pyx_v_i;
          __pyx_t_27 = __pyx_v_j;
          *((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_26 * __pyx_v_arr.strides[0]) )) + __pyx_t_27)) )) = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">676</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">677</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">678</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">679</span>: <span class="c">#TODO: figure out why this is so much slower</span></pre>
<pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">680</span>: <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">conway_process_nogil</span><span class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">rule</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">arr</span><span class="p">):</span></pre>
<pre class='cython code score-50 '>static PyObject *__pyx_pw_6Cfuncs_53conway_process_nogil(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static void __pyx_f_6Cfuncs_conway_process_nogil(__Pyx_memviewslice __pyx_v_rule, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, CYTHON_UNUSED int __pyx_skip_dispatch) {
  int __pyx_v_NB;
  CYTHON_UNUSED int __pyx_v_n;
  int __pyx_v_d;
  __Pyx_memviewslice __pyx_v_pos = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr_c = { 0, 0, { 0 }, { 0 }, { 0 } };
  Py_ssize_t __pyx_v_i;
  Py_ssize_t __pyx_v_j;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("conway_process_nogil", 0);
  <span class='trace'>__Pyx_TraceCall</span>("conway_process_nogil", __pyx_f[0], 680, 0, <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("Cfuncs.conway_process_nogil", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pos, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr_c, 1);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_53conway_process_nogil(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_52conway_process_nogil[] = "\n    Performs conway update on the array.\n\n    :param rule:    (pointer) update rule for this frame\n    :param dim:     (pointer) dimensions of array\n    :param array:   (2D pointer) array\n    :return:        None\n    ";
static PyObject *__pyx_pw_6Cfuncs_53conway_process_nogil(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_rule = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("conway_process_nogil (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_rule,&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_rule)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("conway_process_nogil", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("conway_process_nogil", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "conway_process_nogil") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_rule = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_rule.memview)) __PYX_ERR(0, 680, __pyx_L3_error)</span>
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 680, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 680, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("conway_process_nogil", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.conway_process_nogil", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_52conway_process_nogil(__pyx_self, __pyx_v_rule, __pyx_v_dim, __pyx_v_arr);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_52conway_process_nogil(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_rule, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("conway_process_nogil", 0);
  <span class='trace'>__Pyx_TraceCall</span>("conway_process_nogil (wrapper)", __pyx_f[0], 680, 0, <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_rule.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("rule"); <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L1_error)</span> }
  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6Cfuncs_conway_process_nogil(__pyx_v_rule, __pyx_v_dim, __pyx_v_arr, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 680, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.conway_process_nogil", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_rule, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">681</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">682</span>: <span class="sd">    Performs conway update on the array.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">683</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">684</span>: <span class="sd">    :param rule:    (pointer) update rule for this frame</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">685</span>: <span class="sd">    :param dim:     (pointer) dimensions of array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">686</span>: <span class="sd">    :param array:   (2D pointer) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">687</span>: <span class="sd">    :return:        None</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">688</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">689</span>:     <span class="k">if</span> <span class="n">rule</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(689,0,<span class='error_goto'>__PYX_ERR(0, 689, __pyx_L1_error)</span>)
  __pyx_t_1 = 0;
  __pyx_t_2 = (((*((int *) ( /* dim=0 */ (__pyx_v_rule.data + __pyx_t_1 * __pyx_v_rule.strides[0]) ))) == -1L) != 0);
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">690</span>:         <span class="k">return</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(690,0,<span class='error_goto'>__PYX_ERR(0, 690, __pyx_L1_error)</span>)
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">691</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">NB</span><span class="p">,</span> <span class="nf">n</span><span class="p">,</span> <span class="nf">d</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">692</span>:     <span class="n">n</span> <span class="o">=</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(692,0,<span class='error_goto'>__PYX_ERR(0, 692, __pyx_L1_error)</span>)
  __pyx_t_3 = 0;
  __pyx_v_n = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_3 * __pyx_v_dim.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">693</span>:     <span class="n">d</span> <span class="o">=</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(693,0,<span class='error_goto'>__PYX_ERR(0, 693, __pyx_L1_error)</span>)
  __pyx_t_4 = 1;
  __pyx_v_d = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_4 * __pyx_v_dim.strides[0]) )));
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">694</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:]</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-23 '>  <span class='trace'>__Pyx_TraceLine</span>(694,0,<span class='error_goto'>__PYX_ERR(0, 694, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 694, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_0);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 694, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 694, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 694, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_pos = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">695</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">arr_c</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(695,0,<span class='error_goto'>__PYX_ERR(0, 695, __pyx_L1_error)</span>)
  __pyx_t_8 = __pyx_memoryview_copy_slice_d_dc_int_c(__pyx_v_arr);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 695, __pyx_L1_error)</span>
  __pyx_v_arr_c = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">696</span>:     <span class="k">cdef</span> <span class="kt">Py_ssize_t</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">697</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="k">nogil</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span></pre>
<pre class='cython code score-6 '>  <span class='trace'>__Pyx_TraceLine</span>(697,0,<span class='error_goto'>__PYX_ERR(0, 697, __pyx_L1_error)</span>)
  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_9 = __pyx_v_n;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_11 = (__pyx_t_9 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_11 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_NB) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) lastprivate(__pyx_v_j)
                    #endif /* _OPENMP */
                    for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_11; __pyx_t_10++){
                        {
                            __pyx_v_i = (Py_ssize_t)(0 + 1 * __pyx_t_10);
                            /* Initialize private variables to invalid values */
                            __pyx_v_NB = ((int)0xbad0bad0);
                            __pyx_v_j = ((Py_ssize_t)0xbad0bad0);
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(697,1,<span class='error_goto'>__PYX_ERR(0, 697, __pyx_L1_error)</span>)
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L6;
        }
        __pyx_L5_error: {
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L1_error;
        }
        __pyx_L6:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">698</span>:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>                            <span class='trace'>__Pyx_TraceLine</span>(698,1,<span class='error_goto'>__PYX_ERR(0, 698, __pyx_L9_error)</span>)
                            __pyx_t_12 = __pyx_v_d;
                            __pyx_t_13 = __pyx_t_12;
                            for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
                              __pyx_v_j = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">699</span>:             <span class="n">pos</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span></pre>
<pre class='cython code score-0 '>                              <span class='trace'>__Pyx_TraceLine</span>(699,1,<span class='error_goto'>__PYX_ERR(0, 699, __pyx_L9_error)</span>)
                              __pyx_t_15 = 0;
                              *((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_15 * __pyx_v_pos.strides[0]) )) = __pyx_v_i;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">700</span>:             <span class="n">pos</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span></pre>
<pre class='cython code score-0 '>                              <span class='trace'>__Pyx_TraceLine</span>(700,1,<span class='error_goto'>__PYX_ERR(0, 700, __pyx_L9_error)</span>)
                              __pyx_t_16 = 1;
                              *((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_16 * __pyx_v_pos.strides[0]) )) = __pyx_v_j;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">701</span>:             <span class="n">NB</span> <span class="o">=</span> <span class="n">neumann_neighbors_sum</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr_c</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>                              <span class='trace'>__Pyx_TraceLine</span>(701,1,<span class='error_goto'>__PYX_ERR(0, 701, __pyx_L9_error)</span>)
                              __pyx_v_NB = __pyx_f_6Cfuncs_neumann_neighbors_sum(__pyx_v_pos, __pyx_v_dim, __pyx_v_arr_c);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">702</span>:             <span class="k">if</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>                              <span class='trace'>__Pyx_TraceLine</span>(702,1,<span class='error_goto'>__PYX_ERR(0, 702, __pyx_L9_error)</span>)
                              __pyx_t_17 = __pyx_v_i;
                              __pyx_t_18 = __pyx_v_j;
                              __pyx_t_2 = (((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_17 * __pyx_v_arr.strides[0]) )) + __pyx_t_18)) ))) == 1) != 0);
                              if (__pyx_t_2) {
/* … */
                                goto __pyx_L13;
                              }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">703</span>:                 <span class="k">if</span> <span class="ow">not</span> <span class="n">rule</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">NB</span> <span class="o">&lt;=</span> <span class="n">rule</span><span class="p">[</span><span class="mf">1</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>                                <span class='trace'>__Pyx_TraceLine</span>(703,1,<span class='error_goto'>__PYX_ERR(0, 703, __pyx_L9_error)</span>)
                                __pyx_t_19 = 0;
                                __pyx_t_2 = ((*((int *) ( /* dim=0 */ (__pyx_v_rule.data + __pyx_t_19 * __pyx_v_rule.strides[0]) ))) &lt;= __pyx_v_NB);
                                if (__pyx_t_2) {
                                  __pyx_t_20 = 1;
                                  __pyx_t_2 = (__pyx_v_NB &lt;= (*((int *) ( /* dim=0 */ (__pyx_v_rule.data + __pyx_t_20 * __pyx_v_rule.strides[0]) ))));
                                }
                                __pyx_t_21 = ((!(__pyx_t_2 != 0)) != 0);
                                if (__pyx_t_21) {
/* … */
                                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">704</span>:                     <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>                                  <span class='trace'>__Pyx_TraceLine</span>(704,1,<span class='error_goto'>__PYX_ERR(0, 704, __pyx_L9_error)</span>)
                                  __pyx_t_22 = __pyx_v_i;
                                  __pyx_t_23 = __pyx_v_j;
                                  *((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_22 * __pyx_v_arr.strides[0]) )) + __pyx_t_23)) )) = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">705</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">706</span>:                 <span class="k">if</span> <span class="n">rule</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">NB</span> <span class="o">&lt;=</span> <span class="n">rule</span><span class="p">[</span><span class="mf">3</span><span class="p">]:</span></pre>
<pre class='cython code score-16 '>                              <span class='trace'>__Pyx_TraceLine</span>(706,1,<span class='error_goto'>__PYX_ERR(0, 706, __pyx_L9_error)</span>)
                              /*else*/ {
                                __pyx_t_24 = 2;
                                __pyx_t_21 = ((*((int *) ( /* dim=0 */ (__pyx_v_rule.data + __pyx_t_24 * __pyx_v_rule.strides[0]) ))) &lt;= __pyx_v_NB);
                                if (__pyx_t_21) {
                                  __pyx_t_25 = 3;
                                  __pyx_t_21 = (__pyx_v_NB &lt;= (*((int *) ( /* dim=0 */ (__pyx_v_rule.data + __pyx_t_25 * __pyx_v_rule.strides[0]) ))));
                                }
                                __pyx_t_2 = (__pyx_t_21 != 0);
                                if (__pyx_t_2) {
/* … */
                                }
                              }
                              __pyx_L13:;
                            }
                            goto __pyx_L17;
                            __pyx_L9_error:;
                            {
                                #ifdef WITH_THREAD
                                PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                                #endif
                                #ifdef _OPENMP
                                #pragma omp flush(__pyx_parallel_exc_type)
                                #endif /* _OPENMP */
                                if (!__pyx_parallel_exc_type) {
                                  <span class='pyx_c_api'>__Pyx_ErrFetchWithState</span>(&amp;__pyx_parallel_exc_type, &amp;__pyx_parallel_exc_value, &amp;__pyx_parallel_exc_tb);
                                  __pyx_parallel_filename = __pyx_filename; __pyx_parallel_lineno = __pyx_lineno; __pyx_parallel_clineno = __pyx_clineno;
                                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_parallel_exc_type);
                                }
                                #ifdef WITH_THREAD
                                <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                                #endif
                            }
                            __pyx_parallel_why = 4;
                            goto __pyx_L16;
                            __pyx_L16:;
                            #ifdef _OPENMP
                            #pragma omp critical(__pyx_parallel_lastprivates0)
                            #endif /* _OPENMP */
                            {
                                __pyx_parallel_temp0 = __pyx_v_NB;
                                __pyx_parallel_temp1 = __pyx_v_i;
                                __pyx_parallel_temp2 = __pyx_v_j;
                            }
                            __pyx_L17:;
                            #ifdef _OPENMP
                            #pragma omp flush(__pyx_parallel_why)
                            #endif /* _OPENMP */
                        }
                    }
                    #ifdef _OPENMP
                    Py_END_ALLOW_THREADS
                    #else
{
#ifdef WITH_THREAD
                    PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                    #endif
                    #endif /* _OPENMP */
                    /* Clean up any temporaries */
                    #ifdef WITH_THREAD
                    <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                    #endif
                    #ifndef _OPENMP
}
#endif /* _OPENMP */
                }
            }
            if (__pyx_parallel_exc_type) {
              /* This may have been overridden by a continue, break or return in another thread. Prefer the error. */
              __pyx_parallel_why = 4;
            }
            if (__pyx_parallel_why) {
              __pyx_v_NB = __pyx_parallel_temp0;
              __pyx_v_i = __pyx_parallel_temp1;
              __pyx_v_j = __pyx_parallel_temp2;
              switch (__pyx_parallel_why) {
                    case 4:
                {
                    #ifdef WITH_THREAD
                    PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                    #endif
                    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_parallel_exc_type);
                    <span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_parallel_exc_type, __pyx_parallel_exc_value, __pyx_parallel_exc_tb);
                    __pyx_filename = __pyx_parallel_filename; __pyx_lineno = __pyx_parallel_lineno; __pyx_clineno = __pyx_parallel_clineno;
                    #ifdef WITH_THREAD
                    <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                    #endif
                }
                goto __pyx_L5_error;
              }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">707</span>:                     <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>                                  <span class='trace'>__Pyx_TraceLine</span>(707,1,<span class='error_goto'>__PYX_ERR(0, 707, __pyx_L9_error)</span>)
                                  __pyx_t_26 = __pyx_v_i;
                                  __pyx_t_27 = __pyx_v_j;
                                  *((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_26 * __pyx_v_arr.strides[0]) )) + __pyx_t_27)) )) = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">708</span>: </pre>
<pre class="cython line score-71" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">709</span>: <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">stochastic_conway</span><span class="p">(</span><span class="nb">float</span> <span class="n">coverage</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">rule</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">arr</span><span class="p">):</span></pre>
<pre class='cython code score-71 '>static PyObject *__pyx_pw_6Cfuncs_55stochastic_conway(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static void __pyx_f_6Cfuncs_stochastic_conway(float __pyx_v_coverage, __Pyx_memviewslice __pyx_v_rule, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, CYTHON_UNUSED int __pyx_skip_dispatch) {
  __Pyx_memviewslice __pyx_v_vex = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vey = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vecs = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_pos = { 0, 0, { 0 }, { 0 }, { 0 } };
  Py_ssize_t __pyx_v_i;
  int __pyx_v_a;
  int __pyx_v_b;
  int __pyx_v_nb;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("stochastic_conway", 0);
  <span class='trace'>__Pyx_TraceCall</span>("stochastic_conway", __pyx_f[0], 709, 0, <span class='error_goto'>__PYX_ERR(0, 709, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("Cfuncs.stochastic_conway", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vex, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vey, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vecs, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pos, 1);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_55stochastic_conway(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_54stochastic_conway[] = "\n    Performs conway updates at random positions in the array.\n\n    :param coverage:(float) percentage of the array to cover\n    :param rule:    (pointer) update rule for this frame\n    :param dim:     (pointer) dimensions of array\n    :param array:   (2D pointer) array\n    :return:        None\n    ";
static PyObject *__pyx_pw_6Cfuncs_55stochastic_conway(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  float __pyx_v_coverage;
  __Pyx_memviewslice __pyx_v_rule = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("stochastic_conway (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_coverage,&amp;__pyx_n_s_rule,&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_coverage)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_rule)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("stochastic_conway", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 709, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("stochastic_conway", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 709, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("stochastic_conway", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 709, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "stochastic_conway") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 709, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_coverage = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[0]); if (unlikely((__pyx_v_coverage == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 709, __pyx_L3_error)</span>
    __pyx_v_rule = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_rule.memview)) __PYX_ERR(0, 709, __pyx_L3_error)</span>
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 709, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_int</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 709, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("stochastic_conway", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 709, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.stochastic_conway", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_54stochastic_conway(__pyx_self, __pyx_v_coverage, __pyx_v_rule, __pyx_v_dim, __pyx_v_arr);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_54stochastic_conway(CYTHON_UNUSED PyObject *__pyx_self, float __pyx_v_coverage, __Pyx_memviewslice __pyx_v_rule, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("stochastic_conway", 0);
  <span class='trace'>__Pyx_TraceCall</span>("stochastic_conway (wrapper)", __pyx_f[0], 709, 0, <span class='error_goto'>__PYX_ERR(0, 709, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_rule.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("rule"); <span class='error_goto'>__PYX_ERR(0, 709, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 709, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 709, __pyx_L1_error)</span> }
  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6Cfuncs_stochastic_conway(__pyx_v_coverage, __pyx_v_rule, __pyx_v_dim, __pyx_v_arr, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 709, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.stochastic_conway", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_rule, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">710</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">711</span>: <span class="sd">    Performs conway updates at random positions in the array.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">712</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">713</span>: <span class="sd">    :param coverage:(float) percentage of the array to cover</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">714</span>: <span class="sd">    :param rule:    (pointer) update rule for this frame</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">715</span>: <span class="sd">    :param dim:     (pointer) dimensions of array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">716</span>: <span class="sd">    :param array:   (2D pointer) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">717</span>: <span class="sd">    :return:        None</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">718</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">719</span>:     <span class="k">if</span> <span class="n">coverage</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(719,0,<span class='error_goto'>__PYX_ERR(0, 719, __pyx_L1_error)</span>)
  __pyx_t_1 = ((__pyx_v_coverage == 0.0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">720</span>:         <span class="k">return</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(720,0,<span class='error_goto'>__PYX_ERR(0, 720, __pyx_L1_error)</span>)
    goto __pyx_L0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">721</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">vex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">coverage</span> <span class="o">*</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]),</span> <span class="mf">1</span><span class="p">),</span></pre>
<pre class='cython code score-29 '>  <span class='trace'>__Pyx_TraceLine</span>(721,0,<span class='error_goto'>__PYX_ERR(0, 721, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 721, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 721, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_randint);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 721, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_6 = -1;
  if (__pyx_t_5 &lt; 0) {
    __pyx_t_5 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 721, __pyx_L1_error)</span>
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_5 * __pyx_v_dim.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 721, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_7 = 0;
  __pyx_t_6 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 721, __pyx_L1_error)</span>
  }
  __pyx_t_8 = 1;
  __pyx_t_6 = -1;
  if (__pyx_t_8 &lt; 0) {
    __pyx_t_8 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 721, __pyx_L1_error)</span>
  }
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_FromDouble</span>(((__pyx_v_coverage * (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_7 * __pyx_v_dim.strides[0]) )))) * (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_8 * __pyx_v_dim.strides[0]) )))));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 721, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 721, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_int_1);
  __pyx_t_9 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(721,0,<span class='error_goto'>__PYX_ERR(0, 721, __pyx_L1_error)</span>)
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 721, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_vex = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">722</span>:                                            <span class="n">np</span><span class="o">.</span><span class="n">intc</span><span class="p">)</span></pre>
<pre class='cython code score-49 '>  <span class='trace'>__Pyx_TraceLine</span>(722,0,<span class='error_goto'>__PYX_ERR(0, 722, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 722, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 722, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_9)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[5] = {__pyx_t_9, __pyx_int_0, __pyx_t_4, __pyx_t_10, __pyx_t_11};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 4+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 721, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[5] = {__pyx_t_9, __pyx_int_0, __pyx_t_4, __pyx_t_10, __pyx_t_11};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 4+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 721, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  } else
  #endif
  {
    __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 721, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    if (__pyx_t_9) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_9); __pyx_t_9 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0+__pyx_t_6, __pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1+__pyx_t_6, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 2+__pyx_t_6, __pyx_t_10);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 3+__pyx_t_6, __pyx_t_11);
    __pyx_t_4 = 0;
    __pyx_t_10 = 0;
    __pyx_t_11 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 721, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">723</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">vey</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">coverage</span> <span class="o">*</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]),</span> <span class="mf">1</span><span class="p">),</span></pre>
<pre class='cython code score-29 '>  <span class='trace'>__Pyx_TraceLine</span>(723,0,<span class='error_goto'>__PYX_ERR(0, 723, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 723, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 723, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_randint);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 723, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_14 = 1;
  __pyx_t_6 = -1;
  if (__pyx_t_14 &lt; 0) {
    __pyx_t_14 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 723, __pyx_L1_error)</span>
  }
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_14 * __pyx_v_dim.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 723, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_15 = 0;
  __pyx_t_6 = -1;
  if (__pyx_t_15 &lt; 0) {
    __pyx_t_15 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 723, __pyx_L1_error)</span>
  }
  __pyx_t_16 = 1;
  __pyx_t_6 = -1;
  if (__pyx_t_16 &lt; 0) {
    __pyx_t_16 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 723, __pyx_L1_error)</span>
  }
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_FromDouble</span>(((__pyx_v_coverage * (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_15 * __pyx_v_dim.strides[0]) )))) * (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_16 * __pyx_v_dim.strides[0]) )))));<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 723, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 723, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_int_1);
  __pyx_t_11 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(723,0,<span class='error_goto'>__PYX_ERR(0, 723, __pyx_L1_error)</span>)
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 723, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_vey = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">724</span>:                                            <span class="n">np</span><span class="o">.</span><span class="n">intc</span><span class="p">)</span></pre>
<pre class='cython code score-49 '>  <span class='trace'>__Pyx_TraceLine</span>(724,0,<span class='error_goto'>__PYX_ERR(0, 724, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 724, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 724, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_11)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[5] = {__pyx_t_11, __pyx_int_0, __pyx_t_12, __pyx_t_10, __pyx_t_4};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 4+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 723, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[5] = {__pyx_t_11, __pyx_int_0, __pyx_t_12, __pyx_t_10, __pyx_t_4};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 4+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 723, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else
  #endif
  {
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 723, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (__pyx_t_11) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_11); __pyx_t_11 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_6, __pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_6, __pyx_t_12);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2+__pyx_t_6, __pyx_t_10);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 3+__pyx_t_6, __pyx_t_4);
    __pyx_t_12 = 0;
    __pyx_t_10 = 0;
    __pyx_t_4 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 723, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">725</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">vex</span><span class="p">,</span> <span class="n">vey</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-33 '>  <span class='trace'>__Pyx_TraceLine</span>(725,0,<span class='error_goto'>__PYX_ERR(0, 725, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 725, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_concatenate);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 725, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_vex, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 725, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_9 = __pyx_memoryview_fromslice(__pyx_v_vey, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 725, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 725, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_9);
  __pyx_t_2 = 0;
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 725, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 725, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_axis, __pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 725, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_9, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 725, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 725, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_vecs = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">726</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:]</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-23 '>  <span class='trace'>__Pyx_TraceLine</span>(726,0,<span class='error_goto'>__PYX_ERR(0, 726, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 726, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_0);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 726, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 726, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 726, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_pos = __pyx_t_17;
  __pyx_t_17.memview = NULL;
  __pyx_t_17.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">727</span>:     <span class="k">cdef</span> <span class="kt">Py_ssize_t</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">728</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">a</span><span class="p">,</span> <span class="nf">b</span><span class="p">,</span> <span class="nf">nb</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">729</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">coverage</span> <span class="o">*</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">])):</span></pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(729,0,<span class='error_goto'>__PYX_ERR(0, 729, __pyx_L1_error)</span>)
  __pyx_t_18 = 0;
  __pyx_t_6 = -1;
  if (__pyx_t_18 &lt; 0) {
    __pyx_t_18 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 729, __pyx_L1_error)</span>
  }
  __pyx_t_19 = 1;
  __pyx_t_6 = -1;
  if (__pyx_t_19 &lt; 0) {
    __pyx_t_19 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_6 = 0;
  } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_dim.shape[0])) __pyx_t_6 = 0;
  if (unlikely(__pyx_t_6 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
    <span class='error_goto'>__PYX_ERR(0, 729, __pyx_L1_error)</span>
  }
  __pyx_t_20 = ((long)((__pyx_v_coverage * (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_18 * __pyx_v_dim.strides[0]) )))) * (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_19 * __pyx_v_dim.strides[0]) )))));
  __pyx_t_21 = __pyx_t_20;
  for (__pyx_t_22 = 0; __pyx_t_22 &lt; __pyx_t_21; __pyx_t_22+=1) {
    __pyx_v_i = __pyx_t_22;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">730</span>:         <span class="n">pos</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">vecs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">vecs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]])</span></pre>
<pre class='cython code score-29 '>    <span class='trace'>__Pyx_TraceLine</span>(730,0,<span class='error_goto'>__PYX_ERR(0, 730, __pyx_L1_error)</span>)
    __pyx_t_23 = __pyx_v_i;
    __pyx_t_24 = 0;
    __pyx_t_6 = -1;
    if (__pyx_t_23 &lt; 0) {
      __pyx_t_23 += __pyx_v_vecs.shape[0];
      if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_vecs.shape[0])) __pyx_t_6 = 0;
    if (__pyx_t_24 &lt; 0) {
      __pyx_t_24 += __pyx_v_vecs.shape[1];
      if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_6 = 1;
    } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_vecs.shape[1])) __pyx_t_6 = 1;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 730, __pyx_L1_error)</span>
    }
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vecs.data + __pyx_t_23 * __pyx_v_vecs.strides[0]) ) + __pyx_t_24 * __pyx_v_vecs.strides[1]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 730, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_25 = __pyx_v_i;
    __pyx_t_26 = 1;
    __pyx_t_6 = -1;
    if (__pyx_t_25 &lt; 0) {
      __pyx_t_25 += __pyx_v_vecs.shape[0];
      if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_vecs.shape[0])) __pyx_t_6 = 0;
    if (__pyx_t_26 &lt; 0) {
      __pyx_t_26 += __pyx_v_vecs.shape[1];
      if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_6 = 1;
    } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_vecs.shape[1])) __pyx_t_6 = 1;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 730, __pyx_L1_error)</span>
    }
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vecs.data + __pyx_t_25 * __pyx_v_vecs.strides[0]) ) + __pyx_t_26 * __pyx_v_vecs.strides[1]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 730, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_9 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 730, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_4);
    __pyx_t_2 = 0;
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 730, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_n_u_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_9);
    __pyx_t_9 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 730, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_9, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 730, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pos, 1);
    __pyx_v_pos = __pyx_t_17;
    __pyx_t_17.memview = NULL;
    __pyx_t_17.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">731</span>:         <span class="n">nb</span> <span class="o">=</span> <span class="n">neumann_neighbors_sum</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(731,0,<span class='error_goto'>__PYX_ERR(0, 731, __pyx_L1_error)</span>)
    __pyx_v_nb = __pyx_f_6Cfuncs_neumann_neighbors_sum(__pyx_v_pos, __pyx_v_dim, __pyx_v_arr);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">732</span>:         <span class="n">a</span> <span class="o">=</span> <span class="n">vecs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(732,0,<span class='error_goto'>__PYX_ERR(0, 732, __pyx_L1_error)</span>)
    __pyx_t_27 = __pyx_v_i;
    __pyx_t_28 = 0;
    __pyx_t_6 = -1;
    if (__pyx_t_27 &lt; 0) {
      __pyx_t_27 += __pyx_v_vecs.shape[0];
      if (unlikely(__pyx_t_27 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_27 &gt;= __pyx_v_vecs.shape[0])) __pyx_t_6 = 0;
    if (__pyx_t_28 &lt; 0) {
      __pyx_t_28 += __pyx_v_vecs.shape[1];
      if (unlikely(__pyx_t_28 &lt; 0)) __pyx_t_6 = 1;
    } else if (unlikely(__pyx_t_28 &gt;= __pyx_v_vecs.shape[1])) __pyx_t_6 = 1;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 732, __pyx_L1_error)</span>
    }
    __pyx_v_a = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vecs.data + __pyx_t_27 * __pyx_v_vecs.strides[0]) ) + __pyx_t_28 * __pyx_v_vecs.strides[1]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">733</span>:         <span class="n">b</span> <span class="o">=</span> <span class="n">vecs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(733,0,<span class='error_goto'>__PYX_ERR(0, 733, __pyx_L1_error)</span>)
    __pyx_t_29 = __pyx_v_i;
    __pyx_t_30 = 1;
    __pyx_t_6 = -1;
    if (__pyx_t_29 &lt; 0) {
      __pyx_t_29 += __pyx_v_vecs.shape[0];
      if (unlikely(__pyx_t_29 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_29 &gt;= __pyx_v_vecs.shape[0])) __pyx_t_6 = 0;
    if (__pyx_t_30 &lt; 0) {
      __pyx_t_30 += __pyx_v_vecs.shape[1];
      if (unlikely(__pyx_t_30 &lt; 0)) __pyx_t_6 = 1;
    } else if (unlikely(__pyx_t_30 &gt;= __pyx_v_vecs.shape[1])) __pyx_t_6 = 1;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 733, __pyx_L1_error)</span>
    }
    __pyx_v_b = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_vecs.data + __pyx_t_29 * __pyx_v_vecs.strides[0]) ) + __pyx_t_30 * __pyx_v_vecs.strides[1]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">734</span>:         <span class="k">if</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(734,0,<span class='error_goto'>__PYX_ERR(0, 734, __pyx_L1_error)</span>)
    __pyx_t_31 = __pyx_v_a;
    __pyx_t_32 = __pyx_v_b;
    __pyx_t_6 = -1;
    if (__pyx_t_31 &lt; 0) {
      __pyx_t_31 += __pyx_v_arr.shape[0];
      if (unlikely(__pyx_t_31 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_31 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
    if (__pyx_t_32 &lt; 0) {
      __pyx_t_32 += __pyx_v_arr.shape[1];
      if (unlikely(__pyx_t_32 &lt; 0)) __pyx_t_6 = 1;
    } else if (unlikely(__pyx_t_32 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 734, __pyx_L1_error)</span>
    }
    __pyx_t_1 = (((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_31 * __pyx_v_arr.strides[0]) )) + __pyx_t_32)) ))) == 1) != 0);
    if (__pyx_t_1) {
/* … */
      goto __pyx_L6;
    }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">735</span>:             <span class="k">if</span> <span class="ow">not</span> <span class="n">rule</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">nb</span> <span class="o">&lt;=</span> <span class="n">rule</span><span class="p">[</span><span class="mf">1</span><span class="p">]:</span></pre>
<pre class='cython code score-4 '>      <span class='trace'>__Pyx_TraceLine</span>(735,0,<span class='error_goto'>__PYX_ERR(0, 735, __pyx_L1_error)</span>)
      __pyx_t_33 = 0;
      __pyx_t_6 = -1;
      if (__pyx_t_33 &lt; 0) {
        __pyx_t_33 += __pyx_v_rule.shape[0];
        if (unlikely(__pyx_t_33 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_33 &gt;= __pyx_v_rule.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 735, __pyx_L1_error)</span>
      }
      __pyx_t_1 = ((*((int *) ( /* dim=0 */ (__pyx_v_rule.data + __pyx_t_33 * __pyx_v_rule.strides[0]) ))) &lt;= __pyx_v_nb);
      if (__pyx_t_1) {
        __pyx_t_34 = 1;
        __pyx_t_6 = -1;
        if (__pyx_t_34 &lt; 0) {
          __pyx_t_34 += __pyx_v_rule.shape[0];
          if (unlikely(__pyx_t_34 &lt; 0)) __pyx_t_6 = 0;
        } else if (unlikely(__pyx_t_34 &gt;= __pyx_v_rule.shape[0])) __pyx_t_6 = 0;
        if (unlikely(__pyx_t_6 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
          <span class='error_goto'>__PYX_ERR(0, 735, __pyx_L1_error)</span>
        }
        __pyx_t_1 = (__pyx_v_nb &lt;= (*((int *) ( /* dim=0 */ (__pyx_v_rule.data + __pyx_t_34 * __pyx_v_rule.strides[0]) ))));
      }
      __pyx_t_35 = ((!(__pyx_t_1 != 0)) != 0);
      if (__pyx_t_35) {
/* … */
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">736</span>:                 <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-2 '>        <span class='trace'>__Pyx_TraceLine</span>(736,0,<span class='error_goto'>__PYX_ERR(0, 736, __pyx_L1_error)</span>)
        __pyx_t_36 = __pyx_v_a;
        __pyx_t_37 = __pyx_v_b;
        __pyx_t_6 = -1;
        if (__pyx_t_36 &lt; 0) {
          __pyx_t_36 += __pyx_v_arr.shape[0];
          if (unlikely(__pyx_t_36 &lt; 0)) __pyx_t_6 = 0;
        } else if (unlikely(__pyx_t_36 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
        if (__pyx_t_37 &lt; 0) {
          __pyx_t_37 += __pyx_v_arr.shape[1];
          if (unlikely(__pyx_t_37 &lt; 0)) __pyx_t_6 = 1;
        } else if (unlikely(__pyx_t_37 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
        if (unlikely(__pyx_t_6 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
          <span class='error_goto'>__PYX_ERR(0, 736, __pyx_L1_error)</span>
        }
        *((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_36 * __pyx_v_arr.strides[0]) )) + __pyx_t_37)) )) = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">737</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">738</span>:             <span class="k">if</span> <span class="n">rule</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">nb</span> <span class="o">&lt;=</span> <span class="n">rule</span><span class="p">[</span><span class="mf">3</span><span class="p">]:</span></pre>
<pre class='cython code score-4 '>    <span class='trace'>__Pyx_TraceLine</span>(738,0,<span class='error_goto'>__PYX_ERR(0, 738, __pyx_L1_error)</span>)
    /*else*/ {
      __pyx_t_38 = 2;
      __pyx_t_6 = -1;
      if (__pyx_t_38 &lt; 0) {
        __pyx_t_38 += __pyx_v_rule.shape[0];
        if (unlikely(__pyx_t_38 &lt; 0)) __pyx_t_6 = 0;
      } else if (unlikely(__pyx_t_38 &gt;= __pyx_v_rule.shape[0])) __pyx_t_6 = 0;
      if (unlikely(__pyx_t_6 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
        <span class='error_goto'>__PYX_ERR(0, 738, __pyx_L1_error)</span>
      }
      __pyx_t_35 = ((*((int *) ( /* dim=0 */ (__pyx_v_rule.data + __pyx_t_38 * __pyx_v_rule.strides[0]) ))) &lt;= __pyx_v_nb);
      if (__pyx_t_35) {
        __pyx_t_39 = 3;
        __pyx_t_6 = -1;
        if (__pyx_t_39 &lt; 0) {
          __pyx_t_39 += __pyx_v_rule.shape[0];
          if (unlikely(__pyx_t_39 &lt; 0)) __pyx_t_6 = 0;
        } else if (unlikely(__pyx_t_39 &gt;= __pyx_v_rule.shape[0])) __pyx_t_6 = 0;
        if (unlikely(__pyx_t_6 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
          <span class='error_goto'>__PYX_ERR(0, 738, __pyx_L1_error)</span>
        }
        __pyx_t_35 = (__pyx_v_nb &lt;= (*((int *) ( /* dim=0 */ (__pyx_v_rule.data + __pyx_t_39 * __pyx_v_rule.strides[0]) ))));
      }
      __pyx_t_1 = (__pyx_t_35 != 0);
      if (__pyx_t_1) {
/* … */
      }
    }
    __pyx_L6:;
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">739</span>:                 <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-2 '>        <span class='trace'>__Pyx_TraceLine</span>(739,0,<span class='error_goto'>__PYX_ERR(0, 739, __pyx_L1_error)</span>)
        __pyx_t_40 = __pyx_v_a;
        __pyx_t_41 = __pyx_v_b;
        __pyx_t_6 = -1;
        if (__pyx_t_40 &lt; 0) {
          __pyx_t_40 += __pyx_v_arr.shape[0];
          if (unlikely(__pyx_t_40 &lt; 0)) __pyx_t_6 = 0;
        } else if (unlikely(__pyx_t_40 &gt;= __pyx_v_arr.shape[0])) __pyx_t_6 = 0;
        if (__pyx_t_41 &lt; 0) {
          __pyx_t_41 += __pyx_v_arr.shape[1];
          if (unlikely(__pyx_t_41 &lt; 0)) __pyx_t_6 = 1;
        } else if (unlikely(__pyx_t_41 &gt;= __pyx_v_arr.shape[1])) __pyx_t_6 = 1;
        if (unlikely(__pyx_t_6 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
          <span class='error_goto'>__PYX_ERR(0, 739, __pyx_L1_error)</span>
        }
        *((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_40 * __pyx_v_arr.strides[0]) )) + __pyx_t_41)) )) = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">740</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">741</span>: <span class="c">#=====NEIGHBOR CALCULATIONS===========</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">742</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">743</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">744</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">745</span>: <span class="k">cpdef</span> <span class="kt">int</span> <span class="nf">moore_neighbors_same</span><span class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">pos</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">arr</span><span class="p">):</span></pre>
<pre class='cython code score-50 '>static PyObject *__pyx_pw_6Cfuncs_57moore_neighbors_same(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_6Cfuncs_moore_neighbors_same(__Pyx_memviewslice __pyx_v_pos, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, CYTHON_UNUSED int __pyx_skip_dispatch) {
  int __pyx_v_a;
  int __pyx_v_b;
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("moore_neighbors_same", 0);
  <span class='trace'>__Pyx_TraceCall</span>("moore_neighbors_same", __pyx_f[0], 745, 0, <span class='error_goto'>__PYX_ERR(0, 745, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("Cfuncs.moore_neighbors_same", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_57moore_neighbors_same(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_56moore_neighbors_same[] = "\n    Calculates the number of Moore neighbors that share state with the position.\n\n    :param pos:         position to be checked\n    :param dim:         dimensions of array\n    :param arr:         array\n    :return:            neighbors\n    ";
static PyObject *__pyx_pw_6Cfuncs_57moore_neighbors_same(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_pos = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("moore_neighbors_same (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_pos,&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_pos)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("moore_neighbors_same", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 745, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("moore_neighbors_same", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 745, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "moore_neighbors_same") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 745, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_pos = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_pos.memview)) __PYX_ERR(0, 745, __pyx_L3_error)</span>
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 745, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 745, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("moore_neighbors_same", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 745, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.moore_neighbors_same", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_56moore_neighbors_same(__pyx_self, __pyx_v_pos, __pyx_v_dim, __pyx_v_arr);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_56moore_neighbors_same(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_pos, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("moore_neighbors_same", 0);
  <span class='trace'>__Pyx_TraceCall</span>("moore_neighbors_same (wrapper)", __pyx_f[0], 745, 0, <span class='error_goto'>__PYX_ERR(0, 745, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_pos.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("pos"); <span class='error_goto'>__PYX_ERR(0, 745, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 745, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 745, __pyx_L1_error)</span> }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_f_6Cfuncs_moore_neighbors_same(__pyx_v_pos, __pyx_v_dim, __pyx_v_arr, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 745, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.moore_neighbors_same", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pos, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">746</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">747</span>: <span class="sd">    Calculates the number of Moore neighbors that share state with the position.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">748</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">749</span>: <span class="sd">    :param pos:         position to be checked</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">750</span>: <span class="sd">    :param dim:         dimensions of array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">751</span>: <span class="sd">    :param arr:         array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">752</span>: <span class="sd">    :return:            neighbors</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">753</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">754</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">a</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(754,0,<span class='error_goto'>__PYX_ERR(0, 754, __pyx_L1_error)</span>)
  __pyx_t_1 = 0;
  __pyx_v_a = (*((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_1 * __pyx_v_pos.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">755</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">b</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(755,0,<span class='error_goto'>__PYX_ERR(0, 755, __pyx_L1_error)</span>)
  __pyx_t_2 = 1;
  __pyx_v_b = (*((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_2 * __pyx_v_pos.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">756</span>:     <span class="k">if</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(756,0,<span class='error_goto'>__PYX_ERR(0, 756, __pyx_L1_error)</span>)
  __pyx_t_3 = __pyx_v_a;
  __pyx_t_4 = __pyx_v_b;
  __pyx_t_5 = ((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_3 * __pyx_v_arr.strides[0]) )) + __pyx_t_4)) ))) != 0);
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">757</span>:         <span class="k">return</span> <span class="n">moore_neighbors_sum</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(757,0,<span class='error_goto'>__PYX_ERR(0, 757, __pyx_L1_error)</span>)
    __pyx_r = __pyx_f_6Cfuncs_moore_neighbors_sum(__pyx_v_pos, __pyx_v_dim, __pyx_v_arr, 0);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">758</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">759</span>:         <span class="k">return</span> <span class="mf">4</span> <span class="o">-</span> <span class="n">moore_neighbors_sum</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(759,0,<span class='error_goto'>__PYX_ERR(0, 759, __pyx_L1_error)</span>)
  /*else*/ {
    __pyx_r = (4 - __pyx_f_6Cfuncs_moore_neighbors_sum(__pyx_v_pos, __pyx_v_dim, __pyx_v_arr, 0));
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">760</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">761</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">762</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">763</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">764</span>: <span class="k">cpdef</span> <span class="kt">int</span> <span class="nf">moore_neighbors_sum</span><span class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">pos</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">arr</span><span class="p">):</span></pre>
<pre class='cython code score-50 '>static PyObject *__pyx_pw_6Cfuncs_59moore_neighbors_sum(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_6Cfuncs_moore_neighbors_sum(__Pyx_memviewslice __pyx_v_pos, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, CYTHON_UNUSED int __pyx_skip_dispatch) {
  int __pyx_v_N;
  int __pyx_v_D;
  int __pyx_v_a;
  int __pyx_v_b;
  int __pyx_v_l;
  int __pyx_v_r;
  int __pyx_v_u;
  int __pyx_v_d;
  int __pyx_v_nb;
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("moore_neighbors_sum", 0);
  <span class='trace'>__Pyx_TraceCall</span>("moore_neighbors_sum", __pyx_f[0], 764, 0, <span class='error_goto'>__PYX_ERR(0, 764, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("Cfuncs.moore_neighbors_sum", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_59moore_neighbors_sum(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_58moore_neighbors_sum[] = "\n    Calculated the population of the Moore neighborhood at position.\n\n    :param pos:         position to be checked\n    :param dim:         dimensions of array\n    :param arr:         array\n    :return:            neighbors\n    ";
static PyObject *__pyx_pw_6Cfuncs_59moore_neighbors_sum(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_pos = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("moore_neighbors_sum (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_pos,&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_pos)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("moore_neighbors_sum", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 764, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("moore_neighbors_sum", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 764, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "moore_neighbors_sum") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 764, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_pos = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_pos.memview)) __PYX_ERR(0, 764, __pyx_L3_error)</span>
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 764, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 764, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("moore_neighbors_sum", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 764, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.moore_neighbors_sum", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_58moore_neighbors_sum(__pyx_self, __pyx_v_pos, __pyx_v_dim, __pyx_v_arr);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_58moore_neighbors_sum(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_pos, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("moore_neighbors_sum", 0);
  <span class='trace'>__Pyx_TraceCall</span>("moore_neighbors_sum (wrapper)", __pyx_f[0], 764, 0, <span class='error_goto'>__PYX_ERR(0, 764, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_pos.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("pos"); <span class='error_goto'>__PYX_ERR(0, 764, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 764, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 764, __pyx_L1_error)</span> }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_f_6Cfuncs_moore_neighbors_sum(__pyx_v_pos, __pyx_v_dim, __pyx_v_arr, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 764, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.moore_neighbors_sum", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pos, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">765</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">766</span>: <span class="sd">    Calculated the population of the Moore neighborhood at position.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">767</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">768</span>: <span class="sd">    :param pos:         position to be checked</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">769</span>: <span class="sd">    :param dim:         dimensions of array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">770</span>: <span class="sd">    :param arr:         array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">771</span>: <span class="sd">    :return:            neighbors</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">772</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">773</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">N</span> <span class="o">=</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(773,0,<span class='error_goto'>__PYX_ERR(0, 773, __pyx_L1_error)</span>)
  __pyx_t_1 = 0;
  __pyx_v_N = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_1 * __pyx_v_dim.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">774</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">D</span> <span class="o">=</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(774,0,<span class='error_goto'>__PYX_ERR(0, 774, __pyx_L1_error)</span>)
  __pyx_t_2 = 1;
  __pyx_v_D = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_2 * __pyx_v_dim.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">775</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">a</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(775,0,<span class='error_goto'>__PYX_ERR(0, 775, __pyx_L1_error)</span>)
  __pyx_t_3 = 0;
  __pyx_v_a = (*((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_3 * __pyx_v_pos.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">776</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">b</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(776,0,<span class='error_goto'>__PYX_ERR(0, 776, __pyx_L1_error)</span>)
  __pyx_t_4 = 1;
  __pyx_v_b = (*((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_4 * __pyx_v_pos.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">777</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">l</span><span class="p">,</span> <span class="nf">r</span><span class="p">,</span> <span class="nf">u</span><span class="p">,</span> <span class="nf">d</span><span class="p">,</span> <span class="nf">nb</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">778</span>:     <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">b</span> <span class="o">==</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">a</span> <span class="o">==</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">-</span><span class="mf">1</span> <span class="ow">or</span> <span class="n">b</span> <span class="o">==</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(778,0,<span class='error_goto'>__PYX_ERR(0, 778, __pyx_L1_error)</span>)
  __pyx_t_6 = ((__pyx_v_a == 0) != 0);
  if (!__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_6 = ((__pyx_v_b == 0) != 0);
  if (!__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_7 = 0;
  __pyx_t_6 = ((__pyx_v_a == ((*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_7 * __pyx_v_dim.strides[0]) ))) - 1)) != 0);
  if (!__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_8 = 1;
  __pyx_t_6 = ((__pyx_v_b == ((*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_8 * __pyx_v_dim.strides[0]) ))) - 1)) != 0);
  __pyx_t_5 = __pyx_t_6;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_5) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">779</span>:         <span class="n">l</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">N</span><span class="p">][</span><span class="n">b</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(779,0,<span class='error_goto'>__PYX_ERR(0, 779, __pyx_L1_error)</span>)
    __pyx_t_9 = ((__pyx_v_a + 1) % __pyx_v_N);
    __pyx_t_10 = __pyx_v_b;
    __pyx_v_l = (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_9 * __pyx_v_arr.strides[0]) )) + __pyx_t_10)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">780</span>:         <span class="n">r</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">+</span> <span class="n">N</span><span class="p">)</span> <span class="o">%</span> <span class="n">N</span><span class="p">][</span><span class="n">b</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(780,0,<span class='error_goto'>__PYX_ERR(0, 780, __pyx_L1_error)</span>)
    __pyx_t_11 = (((__pyx_v_a - 1) + __pyx_v_N) % __pyx_v_N);
    __pyx_t_12 = __pyx_v_b;
    __pyx_v_r = (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_11 * __pyx_v_arr.strides[0]) )) + __pyx_t_12)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">781</span>:         <span class="n">u</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][(</span><span class="n">b</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">D</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(781,0,<span class='error_goto'>__PYX_ERR(0, 781, __pyx_L1_error)</span>)
    __pyx_t_13 = __pyx_v_a;
    __pyx_t_14 = ((__pyx_v_b + 1) % __pyx_v_D);
    __pyx_v_u = (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_13 * __pyx_v_arr.strides[0]) )) + __pyx_t_14)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">782</span>:         <span class="n">d</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][(</span><span class="n">b</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">+</span> <span class="n">D</span><span class="p">)</span> <span class="o">%</span> <span class="n">D</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(782,0,<span class='error_goto'>__PYX_ERR(0, 782, __pyx_L1_error)</span>)
    __pyx_t_15 = __pyx_v_a;
    __pyx_t_16 = (((__pyx_v_b - 1) + __pyx_v_D) % __pyx_v_D);
    __pyx_v_d = (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_15 * __pyx_v_arr.strides[0]) )) + __pyx_t_16)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">783</span>:         <span class="n">nb</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">u</span> <span class="o">+</span> <span class="n">d</span> <span class="o">+</span> <span class="n">r</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(783,0,<span class='error_goto'>__PYX_ERR(0, 783, __pyx_L1_error)</span>)
    __pyx_v_nb = (((__pyx_v_l + __pyx_v_u) + __pyx_v_d) + __pyx_v_r);
</pre><pre class="cython line score-0">&#xA0;<span class="">784</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">785</span>:         <span class="n">l</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)][</span><span class="n">b</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(785,0,<span class='error_goto'>__PYX_ERR(0, 785, __pyx_L1_error)</span>)
  /*else*/ {
    __pyx_t_17 = (__pyx_v_a + 1);
    __pyx_t_18 = __pyx_v_b;
    __pyx_v_l = (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_17 * __pyx_v_arr.strides[0]) )) + __pyx_t_18)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">786</span>:         <span class="n">r</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)][</span><span class="n">b</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(786,0,<span class='error_goto'>__PYX_ERR(0, 786, __pyx_L1_error)</span>)
    __pyx_t_19 = (__pyx_v_a - 1);
    __pyx_t_20 = __pyx_v_b;
    __pyx_v_r = (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_19 * __pyx_v_arr.strides[0]) )) + __pyx_t_20)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">787</span>:         <span class="n">u</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][(</span><span class="n">b</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)]</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(787,0,<span class='error_goto'>__PYX_ERR(0, 787, __pyx_L1_error)</span>)
    __pyx_t_21 = __pyx_v_a;
    __pyx_t_22 = (__pyx_v_b + 1);
    __pyx_v_u = (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_21 * __pyx_v_arr.strides[0]) )) + __pyx_t_22)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">788</span>:         <span class="n">d</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][(</span><span class="n">b</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)]</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(788,0,<span class='error_goto'>__PYX_ERR(0, 788, __pyx_L1_error)</span>)
    __pyx_t_23 = __pyx_v_a;
    __pyx_t_24 = (__pyx_v_b - 1);
    __pyx_v_d = (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_23 * __pyx_v_arr.strides[0]) )) + __pyx_t_24)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">789</span>:         <span class="n">nb</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">u</span> <span class="o">+</span> <span class="n">d</span> <span class="o">+</span> <span class="n">r</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(789,0,<span class='error_goto'>__PYX_ERR(0, 789, __pyx_L1_error)</span>)
    __pyx_v_nb = (((__pyx_v_l + __pyx_v_u) + __pyx_v_d) + __pyx_v_r);
  }
  __pyx_L3:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">790</span>:     <span class="k">return</span> <span class="n">nb</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(790,0,<span class='error_goto'>__PYX_ERR(0, 790, __pyx_L1_error)</span>)
  __pyx_r = __pyx_v_nb;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">791</span>: </pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">792</span>: <span class="k">cpdef</span> <span class="kt">int</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">moore_neighbors_array</span><span class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">arr</span><span class="p">):</span></pre>
<pre class='cython code score-47 '>static PyObject *__pyx_pw_6Cfuncs_61moore_neighbors_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static __Pyx_memviewslice __pyx_f_6Cfuncs_moore_neighbors_array(__Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, CYTHON_UNUSED int __pyx_skip_dispatch) {
  __Pyx_memviewslice __pyx_v_pos = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_nb = { 0, 0, { 0 }, { 0 }, { 0 } };
  Py_ssize_t __pyx_v_i;
  Py_ssize_t __pyx_v_j;
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("moore_neighbors_array", 0);
  <span class='trace'>__Pyx_TraceCall</span>("moore_neighbors_array", __pyx_f[0], 792, 0, <span class='error_goto'>__PYX_ERR(0, 792, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.moore_neighbors_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pos, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_nb, 1);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_61moore_neighbors_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_6Cfuncs_61moore_neighbors_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("moore_neighbors_array (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("moore_neighbors_array", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 792, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "moore_neighbors_array") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 792, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 792, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 792, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("moore_neighbors_array", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 792, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.moore_neighbors_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_60moore_neighbors_array(__pyx_self, __pyx_v_dim, __pyx_v_arr);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_60moore_neighbors_array(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("moore_neighbors_array", 0);
  <span class='trace'>__Pyx_TraceCall</span>("moore_neighbors_array (wrapper)", __pyx_f[0], 792, 0, <span class='error_goto'>__PYX_ERR(0, 792, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 792, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 792, __pyx_L1_error)</span> }
  __pyx_t_1 = __pyx_f_6Cfuncs_moore_neighbors_array(__pyx_v_dim, __pyx_v_arr, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 792, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_1, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 792, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.moore_neighbors_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">793</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:]</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-23 '>  <span class='trace'>__Pyx_TraceLine</span>(793,0,<span class='error_goto'>__PYX_ERR(0, 793, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 793, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_0);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 793, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 793, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 793, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_pos = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">794</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">nb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-23 '>  <span class='trace'>__Pyx_TraceLine</span>(794,0,<span class='error_goto'>__PYX_ERR(0, 794, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty_like);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_arr, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 794, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_nb = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">795</span>:     <span class="k">cdef</span> <span class="kt">Py_ssize_t</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">796</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(796,0,<span class='error_goto'>__PYX_ERR(0, 796, __pyx_L1_error)</span>)
  __pyx_t_7 = 0;
  __pyx_t_8 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_dim.shape[0])) __pyx_t_8 = 0;
  if (unlikely(__pyx_t_8 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
    <span class='error_goto'>__PYX_ERR(0, 796, __pyx_L1_error)</span>
  }
  __pyx_t_8 = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_7 * __pyx_v_dim.strides[0]) )));
  __pyx_t_9 = __pyx_t_8;
  for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_i = __pyx_t_10;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">797</span>:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(797,0,<span class='error_goto'>__PYX_ERR(0, 797, __pyx_L1_error)</span>)
    __pyx_t_11 = 1;
    __pyx_t_12 = -1;
    if (__pyx_t_11 &lt; 0) {
      __pyx_t_11 += __pyx_v_dim.shape[0];
      if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_dim.shape[0])) __pyx_t_12 = 0;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>__PYX_ERR(0, 797, __pyx_L1_error)</span>
    }
    __pyx_t_12 = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_11 * __pyx_v_dim.strides[0]) )));
    __pyx_t_13 = __pyx_t_12;
    for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
      __pyx_v_j = __pyx_t_14;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">798</span>:             <span class="n">pos</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span></pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(798,0,<span class='error_goto'>__PYX_ERR(0, 798, __pyx_L1_error)</span>)
      __pyx_t_15 = 0;
      __pyx_t_16 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_pos.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_pos.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 798, __pyx_L1_error)</span>
      }
      *((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_15 * __pyx_v_pos.strides[0]) )) = __pyx_v_i;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">799</span>:             <span class="n">pos</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span></pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(799,0,<span class='error_goto'>__PYX_ERR(0, 799, __pyx_L1_error)</span>)
      __pyx_t_17 = 1;
      __pyx_t_16 = -1;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_v_pos.shape[0];
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_pos.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 799, __pyx_L1_error)</span>
      }
      *((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_17 * __pyx_v_pos.strides[0]) )) = __pyx_v_j;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">800</span>:             <span class="n">nb</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">moore_neighbors_sum</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(800,0,<span class='error_goto'>__PYX_ERR(0, 800, __pyx_L1_error)</span>)
      __pyx_t_18 = __pyx_v_i;
      __pyx_t_19 = __pyx_v_j;
      __pyx_t_16 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_nb.shape[0];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_nb.shape[0])) __pyx_t_16 = 0;
      if (__pyx_t_19 &lt; 0) {
        __pyx_t_19 += __pyx_v_nb.shape[1];
        if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_16 = 1;
      } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_nb.shape[1])) __pyx_t_16 = 1;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 800, __pyx_L1_error)</span>
      }
      *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_nb.data + __pyx_t_18 * __pyx_v_nb.strides[0]) ) + __pyx_t_19 * __pyx_v_nb.strides[1]) )) = __pyx_f_6Cfuncs_moore_neighbors_sum(__pyx_v_pos, __pyx_v_dim, __pyx_v_arr, 0);
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">801</span>:     <span class="k">return</span> <span class="n">nb</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(801,0,<span class='error_goto'>__PYX_ERR(0, 801, __pyx_L1_error)</span>)
  __PYX_INC_MEMVIEW(&amp;__pyx_v_nb, 0);
  __pyx_r = __pyx_v_nb;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">802</span>: </pre>
<pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">803</span>: <span class="k">cpdef</span> <span class="kt">int</span> <span class="nf">neumann_neighbors_same</span><span class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">pos</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">arr</span><span class="p">):</span></pre>
<pre class='cython code score-50 '>static PyObject *__pyx_pw_6Cfuncs_63neumann_neighbors_same(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_6Cfuncs_neumann_neighbors_same(__Pyx_memviewslice __pyx_v_pos, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, CYTHON_UNUSED int __pyx_skip_dispatch) {
  int __pyx_v_a;
  int __pyx_v_b;
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("neumann_neighbors_same", 0);
  <span class='trace'>__Pyx_TraceCall</span>("neumann_neighbors_same", __pyx_f[0], 803, 0, <span class='error_goto'>__PYX_ERR(0, 803, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("Cfuncs.neumann_neighbors_same", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_63neumann_neighbors_same(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_62neumann_neighbors_same[] = "\n    Calculates the number of Neumann neighbors that share state with the position.\n\n    :param pos:         position to be checked\n    :param dim:         dimensions of array\n    :param arr:         array\n    :return:            neighbors\n    ";
static PyObject *__pyx_pw_6Cfuncs_63neumann_neighbors_same(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_pos = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("neumann_neighbors_same (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_pos,&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_pos)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("neumann_neighbors_same", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 803, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("neumann_neighbors_same", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 803, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "neumann_neighbors_same") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 803, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_pos = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_pos.memview)) __PYX_ERR(0, 803, __pyx_L3_error)</span>
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 803, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 803, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("neumann_neighbors_same", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 803, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.neumann_neighbors_same", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_62neumann_neighbors_same(__pyx_self, __pyx_v_pos, __pyx_v_dim, __pyx_v_arr);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_62neumann_neighbors_same(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_pos, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("neumann_neighbors_same", 0);
  <span class='trace'>__Pyx_TraceCall</span>("neumann_neighbors_same (wrapper)", __pyx_f[0], 803, 0, <span class='error_goto'>__PYX_ERR(0, 803, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_pos.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("pos"); <span class='error_goto'>__PYX_ERR(0, 803, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 803, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 803, __pyx_L1_error)</span> }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_f_6Cfuncs_neumann_neighbors_same(__pyx_v_pos, __pyx_v_dim, __pyx_v_arr, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 803, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.neumann_neighbors_same", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pos, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">804</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">805</span>: <span class="sd">    Calculates the number of Neumann neighbors that share state with the position.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">806</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">807</span>: <span class="sd">    :param pos:         position to be checked</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">808</span>: <span class="sd">    :param dim:         dimensions of array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">809</span>: <span class="sd">    :param arr:         array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">810</span>: <span class="sd">    :return:            neighbors</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">811</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">812</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">a</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(812,0,<span class='error_goto'>__PYX_ERR(0, 812, __pyx_L1_error)</span>)
  __pyx_t_1 = 0;
  __pyx_t_2 = -1;
  if (__pyx_t_1 &lt; 0) {
    __pyx_t_1 += __pyx_v_pos.shape[0];
    if (unlikely(__pyx_t_1 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_1 &gt;= __pyx_v_pos.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 812, __pyx_L1_error)</span>
  }
  __pyx_v_a = (*((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_1 * __pyx_v_pos.strides[0]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">813</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">b</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(813,0,<span class='error_goto'>__PYX_ERR(0, 813, __pyx_L1_error)</span>)
  __pyx_t_3 = 1;
  __pyx_t_2 = -1;
  if (__pyx_t_3 &lt; 0) {
    __pyx_t_3 += __pyx_v_pos.shape[0];
    if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_pos.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 813, __pyx_L1_error)</span>
  }
  __pyx_v_b = (*((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_3 * __pyx_v_pos.strides[0]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">814</span>:     <span class="k">if</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">]:</span></pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(814,0,<span class='error_goto'>__PYX_ERR(0, 814, __pyx_L1_error)</span>)
  __pyx_t_4 = __pyx_v_a;
  __pyx_t_5 = __pyx_v_b;
  __pyx_t_2 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_arr.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_arr.shape[0])) __pyx_t_2 = 0;
  if (__pyx_t_5 &lt; 0) {
    __pyx_t_5 += __pyx_v_arr.shape[1];
    if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_2 = 1;
  } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_arr.shape[1])) __pyx_t_2 = 1;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 814, __pyx_L1_error)</span>
  }
  __pyx_t_6 = ((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_4 * __pyx_v_arr.strides[0]) )) + __pyx_t_5)) ))) != 0);
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">815</span>:         <span class="k">return</span> <span class="n">neumann_neighbors_sum</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(815,0,<span class='error_goto'>__PYX_ERR(0, 815, __pyx_L1_error)</span>)
    __pyx_r = __pyx_f_6Cfuncs_neumann_neighbors_sum(__pyx_v_pos, __pyx_v_dim, __pyx_v_arr);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">816</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">817</span>:         <span class="k">return</span> <span class="mf">8</span> <span class="o">-</span> <span class="n">neumann_neighbors_sum</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(817,0,<span class='error_goto'>__PYX_ERR(0, 817, __pyx_L1_error)</span>)
  /*else*/ {
    __pyx_r = (8 - __pyx_f_6Cfuncs_neumann_neighbors_sum(__pyx_v_pos, __pyx_v_dim, __pyx_v_arr));
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">818</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">819</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">820</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">821</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">822</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">823</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">neumann_neighbors_sum</span><span class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">pos</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">arr</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>static int __pyx_f_6Cfuncs_neumann_neighbors_sum(__Pyx_memviewslice __pyx_v_pos, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr) {
  int __pyx_v_N;
  int __pyx_v_D;
  int __pyx_v_a;
  int __pyx_v_b;
  int __pyx_v_l;
  int __pyx_v_r;
  int __pyx_v_u;
  int __pyx_v_d;
  int __pyx_v_ur;
  int __pyx_v_ul;
  int __pyx_v_dr;
  int __pyx_v_dl;
  int __pyx_v_nb;
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceCall</span>("neumann_neighbors_sum", __pyx_f[0], 823, 1, <span class='error_goto'>__PYX_ERR(0, 823, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("Cfuncs.neumann_neighbors_sum", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 1);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 1);
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">824</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">825</span>: <span class="sd">    Calculated the population of the Neumann neighborhood at position.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">826</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">827</span>: <span class="sd">    :param pos:         position to be checked</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">828</span>: <span class="sd">    :param dim:         dimensions of array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">829</span>: <span class="sd">    :param arr:         array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">830</span>: <span class="sd">    :return:            neighbors</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">831</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">832</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">N</span> <span class="o">=</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(832,1,<span class='error_goto'>__PYX_ERR(0, 832, __pyx_L1_error)</span>)
  __pyx_t_1 = 0;
  __pyx_v_N = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_1 * __pyx_v_dim.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">833</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">D</span> <span class="o">=</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(833,1,<span class='error_goto'>__PYX_ERR(0, 833, __pyx_L1_error)</span>)
  __pyx_t_2 = 1;
  __pyx_v_D = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_2 * __pyx_v_dim.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">834</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">a</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(834,1,<span class='error_goto'>__PYX_ERR(0, 834, __pyx_L1_error)</span>)
  __pyx_t_3 = 0;
  __pyx_v_a = (*((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_3 * __pyx_v_pos.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">835</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">b</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(835,1,<span class='error_goto'>__PYX_ERR(0, 835, __pyx_L1_error)</span>)
  __pyx_t_4 = 1;
  __pyx_v_b = (*((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_4 * __pyx_v_pos.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">836</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">l</span><span class="p">,</span> <span class="nf">r</span><span class="p">,</span> <span class="nf">u</span><span class="p">,</span> <span class="nf">d</span><span class="p">,</span> <span class="nf">ur</span><span class="p">,</span> <span class="nf">ul</span><span class="p">,</span> <span class="nf">dr</span><span class="p">,</span> <span class="nf">dl</span><span class="p">,</span> <span class="nf">nb</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">837</span>:     <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">b</span> <span class="o">==</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">a</span> <span class="o">==</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">-</span><span class="mf">1</span> <span class="ow">or</span> <span class="n">b</span> <span class="o">==</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(837,1,<span class='error_goto'>__PYX_ERR(0, 837, __pyx_L1_error)</span>)
  __pyx_t_6 = ((__pyx_v_a == 0) != 0);
  if (!__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_6 = ((__pyx_v_b == 0) != 0);
  if (!__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_7 = 0;
  __pyx_t_6 = ((__pyx_v_a == ((*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_7 * __pyx_v_dim.strides[0]) ))) - 1)) != 0);
  if (!__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_8 = 1;
  __pyx_t_6 = ((__pyx_v_b == ((*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_8 * __pyx_v_dim.strides[0]) ))) - 1)) != 0);
  __pyx_t_5 = __pyx_t_6;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_5) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">838</span>:         <span class="n">l</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">N</span><span class="p">][</span><span class="n">b</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(838,1,<span class='error_goto'>__PYX_ERR(0, 838, __pyx_L1_error)</span>)
    __pyx_t_9 = ((__pyx_v_a + 1) % __pyx_v_N);
    __pyx_t_10 = __pyx_v_b;
    __pyx_v_l = (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_9 * __pyx_v_arr.strides[0]) )) + __pyx_t_10)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">839</span>:         <span class="n">r</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">+</span> <span class="n">N</span><span class="p">)</span> <span class="o">%</span> <span class="n">N</span><span class="p">][</span><span class="n">b</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(839,1,<span class='error_goto'>__PYX_ERR(0, 839, __pyx_L1_error)</span>)
    __pyx_t_11 = (((__pyx_v_a - 1) + __pyx_v_N) % __pyx_v_N);
    __pyx_t_12 = __pyx_v_b;
    __pyx_v_r = (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_11 * __pyx_v_arr.strides[0]) )) + __pyx_t_12)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">840</span>:         <span class="n">ul</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">N</span><span class="p">][(</span><span class="n">b</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">D</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(840,1,<span class='error_goto'>__PYX_ERR(0, 840, __pyx_L1_error)</span>)
    __pyx_t_13 = ((__pyx_v_a + 1) % __pyx_v_N);
    __pyx_t_14 = ((__pyx_v_b + 1) % __pyx_v_D);
    __pyx_v_ul = (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_13 * __pyx_v_arr.strides[0]) )) + __pyx_t_14)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">841</span>:         <span class="n">ur</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">+</span> <span class="n">N</span><span class="p">)</span> <span class="o">%</span> <span class="n">N</span><span class="p">][(</span><span class="n">b</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">D</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(841,1,<span class='error_goto'>__PYX_ERR(0, 841, __pyx_L1_error)</span>)
    __pyx_t_15 = (((__pyx_v_a - 1) + __pyx_v_N) % __pyx_v_N);
    __pyx_t_16 = ((__pyx_v_b + 1) % __pyx_v_D);
    __pyx_v_ur = (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_15 * __pyx_v_arr.strides[0]) )) + __pyx_t_16)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">842</span>:         <span class="n">dl</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">N</span><span class="p">][(</span><span class="n">b</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">+</span> <span class="n">D</span><span class="p">)</span> <span class="o">%</span> <span class="n">D</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(842,1,<span class='error_goto'>__PYX_ERR(0, 842, __pyx_L1_error)</span>)
    __pyx_t_17 = ((__pyx_v_a + 1) % __pyx_v_N);
    __pyx_t_18 = (((__pyx_v_b - 1) + __pyx_v_D) % __pyx_v_D);
    __pyx_v_dl = (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_17 * __pyx_v_arr.strides[0]) )) + __pyx_t_18)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">843</span>:         <span class="n">dr</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">+</span> <span class="n">N</span><span class="p">)</span> <span class="o">%</span> <span class="n">N</span><span class="p">][(</span><span class="n">b</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">+</span> <span class="n">D</span><span class="p">)</span> <span class="o">%</span> <span class="n">D</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(843,1,<span class='error_goto'>__PYX_ERR(0, 843, __pyx_L1_error)</span>)
    __pyx_t_19 = (((__pyx_v_a - 1) + __pyx_v_N) % __pyx_v_N);
    __pyx_t_20 = (((__pyx_v_b - 1) + __pyx_v_D) % __pyx_v_D);
    __pyx_v_dr = (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_19 * __pyx_v_arr.strides[0]) )) + __pyx_t_20)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">844</span>:         <span class="n">u</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][(</span><span class="n">b</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">D</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(844,1,<span class='error_goto'>__PYX_ERR(0, 844, __pyx_L1_error)</span>)
    __pyx_t_21 = __pyx_v_a;
    __pyx_t_22 = ((__pyx_v_b + 1) % __pyx_v_D);
    __pyx_v_u = (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_21 * __pyx_v_arr.strides[0]) )) + __pyx_t_22)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">845</span>:         <span class="n">d</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][(</span><span class="n">b</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">+</span> <span class="n">D</span><span class="p">)</span> <span class="o">%</span> <span class="n">D</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(845,1,<span class='error_goto'>__PYX_ERR(0, 845, __pyx_L1_error)</span>)
    __pyx_t_23 = __pyx_v_a;
    __pyx_t_24 = (((__pyx_v_b - 1) + __pyx_v_D) % __pyx_v_D);
    __pyx_v_d = (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_23 * __pyx_v_arr.strides[0]) )) + __pyx_t_24)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">846</span>:         <span class="n">nb</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">u</span> <span class="o">+</span> <span class="n">d</span> <span class="o">+</span> <span class="n">r</span> <span class="o">+</span> <span class="n">ul</span> <span class="o">+</span> <span class="n">ur</span> <span class="o">+</span> <span class="n">dl</span> <span class="o">+</span> <span class="n">dr</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(846,1,<span class='error_goto'>__PYX_ERR(0, 846, __pyx_L1_error)</span>)
    __pyx_v_nb = (((((((__pyx_v_l + __pyx_v_u) + __pyx_v_d) + __pyx_v_r) + __pyx_v_ul) + __pyx_v_ur) + __pyx_v_dl) + __pyx_v_dr);
</pre><pre class="cython line score-0">&#xA0;<span class="">847</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">848</span>:         <span class="n">l</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)][</span><span class="n">b</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(848,1,<span class='error_goto'>__PYX_ERR(0, 848, __pyx_L1_error)</span>)
  /*else*/ {
    __pyx_t_25 = (__pyx_v_a + 1);
    __pyx_t_26 = __pyx_v_b;
    __pyx_v_l = (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_25 * __pyx_v_arr.strides[0]) )) + __pyx_t_26)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">849</span>:         <span class="n">r</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)][</span><span class="n">b</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(849,1,<span class='error_goto'>__PYX_ERR(0, 849, __pyx_L1_error)</span>)
    __pyx_t_27 = (__pyx_v_a - 1);
    __pyx_t_28 = __pyx_v_b;
    __pyx_v_r = (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_27 * __pyx_v_arr.strides[0]) )) + __pyx_t_28)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">850</span>:         <span class="n">ul</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)][(</span><span class="n">b</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)]</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(850,1,<span class='error_goto'>__PYX_ERR(0, 850, __pyx_L1_error)</span>)
    __pyx_t_29 = (__pyx_v_a + 1);
    __pyx_t_30 = (__pyx_v_b + 1);
    __pyx_v_ul = (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_29 * __pyx_v_arr.strides[0]) )) + __pyx_t_30)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">851</span>:         <span class="n">ur</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)][(</span><span class="n">b</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)]</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(851,1,<span class='error_goto'>__PYX_ERR(0, 851, __pyx_L1_error)</span>)
    __pyx_t_31 = (__pyx_v_a - 1);
    __pyx_t_32 = (__pyx_v_b + 1);
    __pyx_v_ur = (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_31 * __pyx_v_arr.strides[0]) )) + __pyx_t_32)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">852</span>:         <span class="n">dl</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)][(</span><span class="n">b</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)]</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(852,1,<span class='error_goto'>__PYX_ERR(0, 852, __pyx_L1_error)</span>)
    __pyx_t_33 = (__pyx_v_a + 1);
    __pyx_t_34 = (__pyx_v_b - 1);
    __pyx_v_dl = (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_33 * __pyx_v_arr.strides[0]) )) + __pyx_t_34)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">853</span>:         <span class="n">dr</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)][(</span><span class="n">b</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)]</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(853,1,<span class='error_goto'>__PYX_ERR(0, 853, __pyx_L1_error)</span>)
    __pyx_t_35 = (__pyx_v_a - 1);
    __pyx_t_36 = (__pyx_v_b - 1);
    __pyx_v_dr = (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_35 * __pyx_v_arr.strides[0]) )) + __pyx_t_36)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">854</span>:         <span class="n">u</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][(</span><span class="n">b</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)]</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(854,1,<span class='error_goto'>__PYX_ERR(0, 854, __pyx_L1_error)</span>)
    __pyx_t_37 = __pyx_v_a;
    __pyx_t_38 = (__pyx_v_b + 1);
    __pyx_v_u = (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_37 * __pyx_v_arr.strides[0]) )) + __pyx_t_38)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">855</span>:         <span class="n">d</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][(</span><span class="n">b</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)]</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(855,1,<span class='error_goto'>__PYX_ERR(0, 855, __pyx_L1_error)</span>)
    __pyx_t_39 = __pyx_v_a;
    __pyx_t_40 = (__pyx_v_b - 1);
    __pyx_v_d = (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_39 * __pyx_v_arr.strides[0]) )) + __pyx_t_40)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">856</span>:         <span class="n">nb</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">u</span> <span class="o">+</span> <span class="n">d</span> <span class="o">+</span> <span class="n">r</span> <span class="o">+</span> <span class="n">ul</span> <span class="o">+</span> <span class="n">ur</span> <span class="o">+</span> <span class="n">dl</span> <span class="o">+</span> <span class="n">dr</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(856,1,<span class='error_goto'>__PYX_ERR(0, 856, __pyx_L1_error)</span>)
    __pyx_v_nb = (((((((__pyx_v_l + __pyx_v_u) + __pyx_v_d) + __pyx_v_r) + __pyx_v_ul) + __pyx_v_ur) + __pyx_v_dl) + __pyx_v_dr);
  }
  __pyx_L3:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">857</span>:     <span class="k">return</span> <span class="n">nb</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(857,1,<span class='error_goto'>__PYX_ERR(0, 857, __pyx_L1_error)</span>)
  __pyx_r = __pyx_v_nb;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">858</span>: </pre>
<pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">859</span>: <span class="k">cpdef</span> <span class="kt">int</span> <span class="nf">neumann_neighbors_sum_CP</span><span class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">pos</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">arr</span><span class="p">):</span></pre>
<pre class='cython code score-50 '>static PyObject *__pyx_pw_6Cfuncs_65neumann_neighbors_sum_CP(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_6Cfuncs_neumann_neighbors_sum_CP(__Pyx_memviewslice __pyx_v_pos, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, CYTHON_UNUSED int __pyx_skip_dispatch) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("neumann_neighbors_sum_CP", 0);
  <span class='trace'>__Pyx_TraceCall</span>("neumann_neighbors_sum_CP", __pyx_f[0], 859, 0, <span class='error_goto'>__PYX_ERR(0, 859, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("Cfuncs.neumann_neighbors_sum_CP", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_65neumann_neighbors_sum_CP(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_6Cfuncs_65neumann_neighbors_sum_CP(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_pos = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("neumann_neighbors_sum_CP (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_pos,&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_pos)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("neumann_neighbors_sum_CP", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 859, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("neumann_neighbors_sum_CP", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 859, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "neumann_neighbors_sum_CP") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 859, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_pos = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_pos.memview)) __PYX_ERR(0, 859, __pyx_L3_error)</span>
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 859, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 859, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("neumann_neighbors_sum_CP", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 859, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.neumann_neighbors_sum_CP", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_64neumann_neighbors_sum_CP(__pyx_self, __pyx_v_pos, __pyx_v_dim, __pyx_v_arr);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_64neumann_neighbors_sum_CP(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_pos, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("neumann_neighbors_sum_CP", 0);
  <span class='trace'>__Pyx_TraceCall</span>("neumann_neighbors_sum_CP (wrapper)", __pyx_f[0], 859, 0, <span class='error_goto'>__PYX_ERR(0, 859, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_pos.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("pos"); <span class='error_goto'>__PYX_ERR(0, 859, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 859, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 859, __pyx_L1_error)</span> }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_f_6Cfuncs_neumann_neighbors_sum_CP(__pyx_v_pos, __pyx_v_dim, __pyx_v_arr, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 859, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.neumann_neighbors_sum_CP", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pos, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">860</span>:     <span class="k">return</span> <span class="n">neumann_neighbors_sum</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(860,0,<span class='error_goto'>__PYX_ERR(0, 860, __pyx_L1_error)</span>)
  __pyx_r = __pyx_f_6Cfuncs_neumann_neighbors_sum(__pyx_v_pos, __pyx_v_dim, __pyx_v_arr);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">861</span>: </pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">862</span>: <span class="k">cpdef</span> <span class="kt">int</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">neumann_neighbors_array</span><span class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">arr</span><span class="p">):</span></pre>
<pre class='cython code score-47 '>static PyObject *__pyx_pw_6Cfuncs_67neumann_neighbors_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static __Pyx_memviewslice __pyx_f_6Cfuncs_neumann_neighbors_array(__Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, CYTHON_UNUSED int __pyx_skip_dispatch) {
  __Pyx_memviewslice __pyx_v_pos = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_nb = { 0, 0, { 0 }, { 0 }, { 0 } };
  Py_ssize_t __pyx_v_i;
  Py_ssize_t __pyx_v_j;
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("neumann_neighbors_array", 0);
  <span class='trace'>__Pyx_TraceCall</span>("neumann_neighbors_array", __pyx_f[0], 862, 0, <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.neumann_neighbors_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pos, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_nb, 1);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_67neumann_neighbors_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_6Cfuncs_67neumann_neighbors_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("neumann_neighbors_array (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("neumann_neighbors_array", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "neumann_neighbors_array") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 862, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 862, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("neumann_neighbors_array", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.neumann_neighbors_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_66neumann_neighbors_array(__pyx_self, __pyx_v_dim, __pyx_v_arr);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_66neumann_neighbors_array(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("neumann_neighbors_array", 0);
  <span class='trace'>__Pyx_TraceCall</span>("neumann_neighbors_array (wrapper)", __pyx_f[0], 862, 0, <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L1_error)</span> }
  __pyx_t_1 = __pyx_f_6Cfuncs_neumann_neighbors_array(__pyx_v_dim, __pyx_v_arr, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 862, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_1, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 862, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.neumann_neighbors_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">863</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:]</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-23 '>  <span class='trace'>__Pyx_TraceLine</span>(863,0,<span class='error_goto'>__PYX_ERR(0, 863, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 863, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_0);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 863, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_i);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_u_i);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_7cpython_5array_array), __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 863, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 863, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_pos = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">864</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">nb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-23 '>  <span class='trace'>__Pyx_TraceLine</span>(864,0,<span class='error_goto'>__PYX_ERR(0, 864, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty_like);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 864, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_arr, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 864, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 864, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_nb = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">865</span>:     <span class="k">cdef</span> <span class="kt">Py_ssize_t</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">866</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(866,0,<span class='error_goto'>__PYX_ERR(0, 866, __pyx_L1_error)</span>)
  __pyx_t_7 = 0;
  __pyx_t_8 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_dim.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_dim.shape[0])) __pyx_t_8 = 0;
  if (unlikely(__pyx_t_8 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
    <span class='error_goto'>__PYX_ERR(0, 866, __pyx_L1_error)</span>
  }
  __pyx_t_8 = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_7 * __pyx_v_dim.strides[0]) )));
  __pyx_t_9 = __pyx_t_8;
  for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_i = __pyx_t_10;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">867</span>:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(867,0,<span class='error_goto'>__PYX_ERR(0, 867, __pyx_L1_error)</span>)
    __pyx_t_11 = 1;
    __pyx_t_12 = -1;
    if (__pyx_t_11 &lt; 0) {
      __pyx_t_11 += __pyx_v_dim.shape[0];
      if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_dim.shape[0])) __pyx_t_12 = 0;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>__PYX_ERR(0, 867, __pyx_L1_error)</span>
    }
    __pyx_t_12 = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_11 * __pyx_v_dim.strides[0]) )));
    __pyx_t_13 = __pyx_t_12;
    for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
      __pyx_v_j = __pyx_t_14;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">868</span>:             <span class="n">pos</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span></pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(868,0,<span class='error_goto'>__PYX_ERR(0, 868, __pyx_L1_error)</span>)
      __pyx_t_15 = 0;
      __pyx_t_16 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_pos.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_pos.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L1_error)</span>
      }
      *((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_15 * __pyx_v_pos.strides[0]) )) = __pyx_v_i;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">869</span>:             <span class="n">pos</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span></pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(869,0,<span class='error_goto'>__PYX_ERR(0, 869, __pyx_L1_error)</span>)
      __pyx_t_17 = 1;
      __pyx_t_16 = -1;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_v_pos.shape[0];
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_pos.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 869, __pyx_L1_error)</span>
      }
      *((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_17 * __pyx_v_pos.strides[0]) )) = __pyx_v_j;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">870</span>:             <span class="n">nb</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">neumann_neighbors_sum</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(870,0,<span class='error_goto'>__PYX_ERR(0, 870, __pyx_L1_error)</span>)
      __pyx_t_18 = __pyx_v_i;
      __pyx_t_19 = __pyx_v_j;
      __pyx_t_16 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_nb.shape[0];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_nb.shape[0])) __pyx_t_16 = 0;
      if (__pyx_t_19 &lt; 0) {
        __pyx_t_19 += __pyx_v_nb.shape[1];
        if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_16 = 1;
      } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_nb.shape[1])) __pyx_t_16 = 1;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 870, __pyx_L1_error)</span>
      }
      *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_nb.data + __pyx_t_18 * __pyx_v_nb.strides[0]) ) + __pyx_t_19 * __pyx_v_nb.strides[1]) )) = __pyx_f_6Cfuncs_neumann_neighbors_sum(__pyx_v_pos, __pyx_v_dim, __pyx_v_arr);
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">871</span>:     <span class="k">return</span> <span class="n">nb</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(871,0,<span class='error_goto'>__PYX_ERR(0, 871, __pyx_L1_error)</span>)
  __PYX_INC_MEMVIEW(&amp;__pyx_v_nb, 0);
  __pyx_r = __pyx_v_nb;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">872</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">873</span>: <span class="c">#=============================OLDFUNCS for testing</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">874</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">875</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">876</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">877</span>: <span class="k">cpdef</span> <span class="kt">int</span> <span class="nf">moore_neighbors_same_complex</span><span class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">pos</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">arr</span><span class="p">):</span></pre>
<pre class='cython code score-50 '>static PyObject *__pyx_pw_6Cfuncs_69moore_neighbors_same_complex(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_6Cfuncs_moore_neighbors_same_complex(__Pyx_memviewslice __pyx_v_pos, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, CYTHON_UNUSED int __pyx_skip_dispatch) {
  int __pyx_v_N;
  int __pyx_v_D;
  int __pyx_v_a;
  int __pyx_v_b;
  int __pyx_v_l;
  int __pyx_v_r;
  int __pyx_v_u;
  int __pyx_v_d;
  int __pyx_v_nb;
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("moore_neighbors_same_complex", 0);
  <span class='trace'>__Pyx_TraceCall</span>("moore_neighbors_same_complex", __pyx_f[0], 877, 0, <span class='error_goto'>__PYX_ERR(0, 877, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("Cfuncs.moore_neighbors_same_complex", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_69moore_neighbors_same_complex(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_68moore_neighbors_same_complex[] = "\n    Calculates the number of Moore neighbors that share state with the position.\n\n    :param pos:         position to be checked\n    :param dim:         dimensions of array\n    :param arr:         array\n    :return:            neighbors\n    ";
static PyObject *__pyx_pw_6Cfuncs_69moore_neighbors_same_complex(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_pos = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("moore_neighbors_same_complex (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_pos,&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_pos)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("moore_neighbors_same_complex", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 877, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("moore_neighbors_same_complex", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 877, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "moore_neighbors_same_complex") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 877, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_pos = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_pos.memview)) __PYX_ERR(0, 877, __pyx_L3_error)</span>
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 877, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 877, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("moore_neighbors_same_complex", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 877, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.moore_neighbors_same_complex", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_68moore_neighbors_same_complex(__pyx_self, __pyx_v_pos, __pyx_v_dim, __pyx_v_arr);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_68moore_neighbors_same_complex(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_pos, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("moore_neighbors_same_complex", 0);
  <span class='trace'>__Pyx_TraceCall</span>("moore_neighbors_same_complex (wrapper)", __pyx_f[0], 877, 0, <span class='error_goto'>__PYX_ERR(0, 877, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_pos.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("pos"); <span class='error_goto'>__PYX_ERR(0, 877, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 877, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 877, __pyx_L1_error)</span> }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_f_6Cfuncs_moore_neighbors_same_complex(__pyx_v_pos, __pyx_v_dim, __pyx_v_arr, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 877, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.moore_neighbors_same_complex", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pos, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">878</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">879</span>: <span class="sd">    Calculates the number of Moore neighbors that share state with the position.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">880</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">881</span>: <span class="sd">    :param pos:         position to be checked</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">882</span>: <span class="sd">    :param dim:         dimensions of array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">883</span>: <span class="sd">    :param arr:         array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">884</span>: <span class="sd">    :return:            neighbors</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">885</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">886</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">N</span> <span class="o">=</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(886,0,<span class='error_goto'>__PYX_ERR(0, 886, __pyx_L1_error)</span>)
  __pyx_t_1 = 0;
  __pyx_v_N = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_1 * __pyx_v_dim.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">887</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">D</span> <span class="o">=</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(887,0,<span class='error_goto'>__PYX_ERR(0, 887, __pyx_L1_error)</span>)
  __pyx_t_2 = 1;
  __pyx_v_D = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_2 * __pyx_v_dim.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">888</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">a</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(888,0,<span class='error_goto'>__PYX_ERR(0, 888, __pyx_L1_error)</span>)
  __pyx_t_3 = 0;
  __pyx_v_a = (*((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_3 * __pyx_v_pos.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">889</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">b</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(889,0,<span class='error_goto'>__PYX_ERR(0, 889, __pyx_L1_error)</span>)
  __pyx_t_4 = 1;
  __pyx_v_b = (*((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_4 * __pyx_v_pos.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">890</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">l</span><span class="p">,</span> <span class="nf">r</span><span class="p">,</span> <span class="nf">u</span><span class="p">,</span> <span class="nf">d</span><span class="p">,</span> <span class="nf">nb</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">891</span>:     <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">b</span> <span class="o">==</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">a</span> <span class="o">==</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">-</span><span class="mf">1</span> <span class="ow">or</span> <span class="n">b</span> <span class="o">==</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(891,0,<span class='error_goto'>__PYX_ERR(0, 891, __pyx_L1_error)</span>)
  __pyx_t_6 = ((__pyx_v_a == 0) != 0);
  if (!__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_6 = ((__pyx_v_b == 0) != 0);
  if (!__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_7 = 0;
  __pyx_t_6 = ((__pyx_v_a == ((*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_7 * __pyx_v_dim.strides[0]) ))) - 1)) != 0);
  if (!__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_8 = 1;
  __pyx_t_6 = ((__pyx_v_b == ((*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_8 * __pyx_v_dim.strides[0]) ))) - 1)) != 0);
  __pyx_t_5 = __pyx_t_6;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_5) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">892</span>:         <span class="n">l</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">N</span><span class="p">][</span><span class="n">b</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(892,0,<span class='error_goto'>__PYX_ERR(0, 892, __pyx_L1_error)</span>)
    __pyx_t_9 = __pyx_v_a;
    __pyx_t_10 = __pyx_v_b;
    __pyx_t_11 = ((__pyx_v_a + 1) % __pyx_v_N);
    __pyx_t_12 = __pyx_v_b;
    __pyx_v_l = ((int)((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_9 * __pyx_v_arr.strides[0]) )) + __pyx_t_10)) ))) == (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_11 * __pyx_v_arr.strides[0]) )) + __pyx_t_12)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">893</span>:         <span class="n">r</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">+</span> <span class="n">N</span><span class="p">)</span> <span class="o">%</span> <span class="n">N</span><span class="p">][</span><span class="n">b</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(893,0,<span class='error_goto'>__PYX_ERR(0, 893, __pyx_L1_error)</span>)
    __pyx_t_13 = __pyx_v_a;
    __pyx_t_14 = __pyx_v_b;
    __pyx_t_15 = (((__pyx_v_a - 1) + __pyx_v_N) % __pyx_v_N);
    __pyx_t_16 = __pyx_v_b;
    __pyx_v_r = ((int)((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_13 * __pyx_v_arr.strides[0]) )) + __pyx_t_14)) ))) == (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_15 * __pyx_v_arr.strides[0]) )) + __pyx_t_16)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">894</span>:         <span class="n">u</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][(</span><span class="n">b</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">D</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(894,0,<span class='error_goto'>__PYX_ERR(0, 894, __pyx_L1_error)</span>)
    __pyx_t_17 = __pyx_v_a;
    __pyx_t_18 = __pyx_v_b;
    __pyx_t_19 = __pyx_v_a;
    __pyx_t_20 = ((__pyx_v_b + 1) % __pyx_v_D);
    __pyx_v_u = ((int)((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_17 * __pyx_v_arr.strides[0]) )) + __pyx_t_18)) ))) == (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_19 * __pyx_v_arr.strides[0]) )) + __pyx_t_20)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">895</span>:         <span class="n">d</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][(</span><span class="n">b</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">+</span> <span class="n">D</span><span class="p">)</span> <span class="o">%</span> <span class="n">D</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(895,0,<span class='error_goto'>__PYX_ERR(0, 895, __pyx_L1_error)</span>)
    __pyx_t_21 = __pyx_v_a;
    __pyx_t_22 = __pyx_v_b;
    __pyx_t_23 = __pyx_v_a;
    __pyx_t_24 = (((__pyx_v_b - 1) + __pyx_v_D) % __pyx_v_D);
    __pyx_v_d = ((int)((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_21 * __pyx_v_arr.strides[0]) )) + __pyx_t_22)) ))) == (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_23 * __pyx_v_arr.strides[0]) )) + __pyx_t_24)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">896</span>:         <span class="n">nb</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">u</span> <span class="o">+</span> <span class="n">d</span> <span class="o">+</span> <span class="n">r</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(896,0,<span class='error_goto'>__PYX_ERR(0, 896, __pyx_L1_error)</span>)
    __pyx_v_nb = (((__pyx_v_l + __pyx_v_u) + __pyx_v_d) + __pyx_v_r);
</pre><pre class="cython line score-0">&#xA0;<span class="">897</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">898</span>:         <span class="n">l</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)][</span><span class="n">b</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(898,0,<span class='error_goto'>__PYX_ERR(0, 898, __pyx_L1_error)</span>)
  /*else*/ {
    __pyx_t_25 = __pyx_v_a;
    __pyx_t_26 = __pyx_v_b;
    __pyx_t_27 = (__pyx_v_a + 1);
    __pyx_t_28 = __pyx_v_b;
    __pyx_v_l = ((int)((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_25 * __pyx_v_arr.strides[0]) )) + __pyx_t_26)) ))) == (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_27 * __pyx_v_arr.strides[0]) )) + __pyx_t_28)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">899</span>:         <span class="n">r</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)][</span><span class="n">b</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(899,0,<span class='error_goto'>__PYX_ERR(0, 899, __pyx_L1_error)</span>)
    __pyx_t_29 = __pyx_v_a;
    __pyx_t_30 = __pyx_v_b;
    __pyx_t_31 = (__pyx_v_a - 1);
    __pyx_t_32 = __pyx_v_b;
    __pyx_v_r = ((int)((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_29 * __pyx_v_arr.strides[0]) )) + __pyx_t_30)) ))) == (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_31 * __pyx_v_arr.strides[0]) )) + __pyx_t_32)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">900</span>:         <span class="n">u</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][(</span><span class="n">b</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)])</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(900,0,<span class='error_goto'>__PYX_ERR(0, 900, __pyx_L1_error)</span>)
    __pyx_t_33 = __pyx_v_a;
    __pyx_t_34 = __pyx_v_b;
    __pyx_t_35 = __pyx_v_a;
    __pyx_t_36 = (__pyx_v_b + 1);
    __pyx_v_u = ((int)((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_33 * __pyx_v_arr.strides[0]) )) + __pyx_t_34)) ))) == (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_35 * __pyx_v_arr.strides[0]) )) + __pyx_t_36)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">901</span>:         <span class="n">d</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][(</span><span class="n">b</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)])</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(901,0,<span class='error_goto'>__PYX_ERR(0, 901, __pyx_L1_error)</span>)
    __pyx_t_37 = __pyx_v_a;
    __pyx_t_38 = __pyx_v_b;
    __pyx_t_39 = __pyx_v_a;
    __pyx_t_40 = (__pyx_v_b - 1);
    __pyx_v_d = ((int)((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_37 * __pyx_v_arr.strides[0]) )) + __pyx_t_38)) ))) == (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_39 * __pyx_v_arr.strides[0]) )) + __pyx_t_40)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">902</span>:         <span class="n">nb</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">u</span> <span class="o">+</span> <span class="n">d</span> <span class="o">+</span> <span class="n">r</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(902,0,<span class='error_goto'>__PYX_ERR(0, 902, __pyx_L1_error)</span>)
    __pyx_v_nb = (((__pyx_v_l + __pyx_v_u) + __pyx_v_d) + __pyx_v_r);
  }
  __pyx_L3:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">903</span>:     <span class="k">return</span> <span class="n">nb</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(903,0,<span class='error_goto'>__PYX_ERR(0, 903, __pyx_L1_error)</span>)
  __pyx_r = __pyx_v_nb;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">904</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">905</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">906</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">907</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">908</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">909</span>: <span class="k">cpdef</span> <span class="kt">int</span> <span class="nf">neumann_neighbors_same_complex</span><span class="p">(</span><span class="nb">int</span><span class="p">[:]</span> <span class="n">pos</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">arr</span><span class="p">):</span></pre>
<pre class='cython code score-50 '>static PyObject *__pyx_pw_6Cfuncs_71neumann_neighbors_same_complex(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_6Cfuncs_neumann_neighbors_same_complex(__Pyx_memviewslice __pyx_v_pos, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr, CYTHON_UNUSED int __pyx_skip_dispatch) {
  int __pyx_v_N;
  int __pyx_v_D;
  int __pyx_v_a;
  int __pyx_v_b;
  int __pyx_v_l;
  int __pyx_v_r;
  int __pyx_v_u;
  int __pyx_v_d;
  int __pyx_v_ur;
  int __pyx_v_ul;
  int __pyx_v_dr;
  int __pyx_v_dl;
  int __pyx_v_nb;
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("neumann_neighbors_same_complex", 0);
  <span class='trace'>__Pyx_TraceCall</span>("neumann_neighbors_same_complex", __pyx_f[0], 909, 0, <span class='error_goto'>__PYX_ERR(0, 909, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("Cfuncs.neumann_neighbors_same_complex", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6Cfuncs_71neumann_neighbors_same_complex(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6Cfuncs_70neumann_neighbors_same_complex[] = "\n    Calculates the number of Neumann neighbors that share state with the position.\n\n    :param pos:         position to be checked\n    :param dim:         dimensions of array\n    :param arr:         array\n    :return:            neighbors\n    ";
static PyObject *__pyx_pw_6Cfuncs_71neumann_neighbors_same_complex(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_pos = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_arr = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("neumann_neighbors_same_complex (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_pos,&amp;__pyx_n_s_dim,&amp;__pyx_n_s_arr,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_pos)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("neumann_neighbors_same_complex", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 909, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_arr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("neumann_neighbors_same_complex", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 909, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "neumann_neighbors_same_complex") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 909, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_pos = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_pos.memview)) __PYX_ERR(0, 909, __pyx_L3_error)</span>
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 909, __pyx_L3_error)</span>
    __pyx_v_arr = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_arr.memview)) __PYX_ERR(0, 909, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("neumann_neighbors_same_complex", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 909, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.neumann_neighbors_same_complex", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6Cfuncs_70neumann_neighbors_same_complex(__pyx_self, __pyx_v_pos, __pyx_v_dim, __pyx_v_arr);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6Cfuncs_70neumann_neighbors_same_complex(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_pos, __Pyx_memviewslice __pyx_v_dim, __Pyx_memviewslice __pyx_v_arr) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("neumann_neighbors_same_complex", 0);
  <span class='trace'>__Pyx_TraceCall</span>("neumann_neighbors_same_complex (wrapper)", __pyx_f[0], 909, 0, <span class='error_goto'>__PYX_ERR(0, 909, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_pos.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("pos"); <span class='error_goto'>__PYX_ERR(0, 909, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 909, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_arr.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("arr"); <span class='error_goto'>__PYX_ERR(0, 909, __pyx_L1_error)</span> }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_f_6Cfuncs_neumann_neighbors_same_complex(__pyx_v_pos, __pyx_v_dim, __pyx_v_arr, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 909, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("Cfuncs.neumann_neighbors_same_complex", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pos, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_arr, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">910</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">911</span>: <span class="sd">    Calculates the number of Neumann neighbors that share state with the position.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">912</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">913</span>: <span class="sd">    :param pos:         position to be checked</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">914</span>: <span class="sd">    :param dim:         dimensions of array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">915</span>: <span class="sd">    :param arr:         array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">916</span>: <span class="sd">    :return:            neighbors</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">917</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">918</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">N</span> <span class="o">=</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(918,0,<span class='error_goto'>__PYX_ERR(0, 918, __pyx_L1_error)</span>)
  __pyx_t_1 = 0;
  __pyx_v_N = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_1 * __pyx_v_dim.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">919</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">D</span> <span class="o">=</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(919,0,<span class='error_goto'>__PYX_ERR(0, 919, __pyx_L1_error)</span>)
  __pyx_t_2 = 1;
  __pyx_v_D = (*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_2 * __pyx_v_dim.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">920</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">a</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(920,0,<span class='error_goto'>__PYX_ERR(0, 920, __pyx_L1_error)</span>)
  __pyx_t_3 = 0;
  __pyx_v_a = (*((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_3 * __pyx_v_pos.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">921</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">b</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(921,0,<span class='error_goto'>__PYX_ERR(0, 921, __pyx_L1_error)</span>)
  __pyx_t_4 = 1;
  __pyx_v_b = (*((int *) ( /* dim=0 */ (__pyx_v_pos.data + __pyx_t_4 * __pyx_v_pos.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">922</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">l</span><span class="p">,</span> <span class="nf">r</span><span class="p">,</span> <span class="nf">u</span><span class="p">,</span> <span class="nf">d</span><span class="p">,</span> <span class="nf">ur</span><span class="p">,</span> <span class="nf">ul</span><span class="p">,</span> <span class="nf">dr</span><span class="p">,</span> <span class="nf">dl</span><span class="p">,</span> <span class="nf">nb</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">923</span>:     <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">b</span> <span class="o">==</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">a</span> <span class="o">==</span> <span class="n">dim</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">-</span><span class="mf">1</span> <span class="ow">or</span> <span class="n">b</span> <span class="o">==</span> <span class="n">dim</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(923,0,<span class='error_goto'>__PYX_ERR(0, 923, __pyx_L1_error)</span>)
  __pyx_t_6 = ((__pyx_v_a == 0) != 0);
  if (!__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_6 = ((__pyx_v_b == 0) != 0);
  if (!__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_7 = 0;
  __pyx_t_6 = ((__pyx_v_a == ((*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_7 * __pyx_v_dim.strides[0]) ))) - 1)) != 0);
  if (!__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_8 = 1;
  __pyx_t_6 = ((__pyx_v_b == ((*((int *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_8 * __pyx_v_dim.strides[0]) ))) - 1)) != 0);
  __pyx_t_5 = __pyx_t_6;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_5) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">924</span>:         <span class="n">l</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">N</span><span class="p">][</span><span class="n">b</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(924,0,<span class='error_goto'>__PYX_ERR(0, 924, __pyx_L1_error)</span>)
    __pyx_t_9 = __pyx_v_a;
    __pyx_t_10 = __pyx_v_b;
    __pyx_t_11 = ((__pyx_v_a + 1) % __pyx_v_N);
    __pyx_t_12 = __pyx_v_b;
    __pyx_v_l = ((int)((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_9 * __pyx_v_arr.strides[0]) )) + __pyx_t_10)) ))) == (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_11 * __pyx_v_arr.strides[0]) )) + __pyx_t_12)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">925</span>:         <span class="n">r</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">+</span> <span class="n">N</span><span class="p">)</span> <span class="o">%</span> <span class="n">N</span><span class="p">][</span><span class="n">b</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(925,0,<span class='error_goto'>__PYX_ERR(0, 925, __pyx_L1_error)</span>)
    __pyx_t_13 = __pyx_v_a;
    __pyx_t_14 = __pyx_v_b;
    __pyx_t_15 = (((__pyx_v_a - 1) + __pyx_v_N) % __pyx_v_N);
    __pyx_t_16 = __pyx_v_b;
    __pyx_v_r = ((int)((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_13 * __pyx_v_arr.strides[0]) )) + __pyx_t_14)) ))) == (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_15 * __pyx_v_arr.strides[0]) )) + __pyx_t_16)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">926</span>:         <span class="n">ul</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">N</span><span class="p">][(</span><span class="n">b</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">D</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(926,0,<span class='error_goto'>__PYX_ERR(0, 926, __pyx_L1_error)</span>)
    __pyx_t_17 = __pyx_v_a;
    __pyx_t_18 = __pyx_v_b;
    __pyx_t_19 = ((__pyx_v_a + 1) % __pyx_v_N);
    __pyx_t_20 = ((__pyx_v_b + 1) % __pyx_v_D);
    __pyx_v_ul = ((int)((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_17 * __pyx_v_arr.strides[0]) )) + __pyx_t_18)) ))) == (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_19 * __pyx_v_arr.strides[0]) )) + __pyx_t_20)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">927</span>:         <span class="n">ur</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">+</span> <span class="n">N</span><span class="p">)</span> <span class="o">%</span> <span class="n">N</span><span class="p">][(</span><span class="n">b</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">D</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(927,0,<span class='error_goto'>__PYX_ERR(0, 927, __pyx_L1_error)</span>)
    __pyx_t_21 = __pyx_v_a;
    __pyx_t_22 = __pyx_v_b;
    __pyx_t_23 = (((__pyx_v_a - 1) + __pyx_v_N) % __pyx_v_N);
    __pyx_t_24 = ((__pyx_v_b + 1) % __pyx_v_D);
    __pyx_v_ur = ((int)((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_21 * __pyx_v_arr.strides[0]) )) + __pyx_t_22)) ))) == (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_23 * __pyx_v_arr.strides[0]) )) + __pyx_t_24)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">928</span>:         <span class="n">dl</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">N</span><span class="p">][(</span><span class="n">b</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">+</span> <span class="n">D</span><span class="p">)</span> <span class="o">%</span> <span class="n">D</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(928,0,<span class='error_goto'>__PYX_ERR(0, 928, __pyx_L1_error)</span>)
    __pyx_t_25 = __pyx_v_a;
    __pyx_t_26 = __pyx_v_b;
    __pyx_t_27 = ((__pyx_v_a + 1) % __pyx_v_N);
    __pyx_t_28 = (((__pyx_v_b - 1) + __pyx_v_D) % __pyx_v_D);
    __pyx_v_dl = ((int)((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_25 * __pyx_v_arr.strides[0]) )) + __pyx_t_26)) ))) == (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_27 * __pyx_v_arr.strides[0]) )) + __pyx_t_28)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">929</span>:         <span class="n">dr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">+</span> <span class="n">N</span><span class="p">)</span> <span class="o">%</span> <span class="n">N</span><span class="p">][(</span><span class="n">b</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">+</span> <span class="n">D</span><span class="p">)</span> <span class="o">%</span> <span class="n">D</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(929,0,<span class='error_goto'>__PYX_ERR(0, 929, __pyx_L1_error)</span>)
    __pyx_t_29 = __pyx_v_a;
    __pyx_t_30 = __pyx_v_b;
    __pyx_t_31 = (((__pyx_v_a - 1) + __pyx_v_N) % __pyx_v_N);
    __pyx_t_32 = (((__pyx_v_b - 1) + __pyx_v_D) % __pyx_v_D);
    __pyx_v_dr = ((int)((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_29 * __pyx_v_arr.strides[0]) )) + __pyx_t_30)) ))) == (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_31 * __pyx_v_arr.strides[0]) )) + __pyx_t_32)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">930</span>:         <span class="n">u</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][(</span><span class="n">b</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">D</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(930,0,<span class='error_goto'>__PYX_ERR(0, 930, __pyx_L1_error)</span>)
    __pyx_t_33 = __pyx_v_a;
    __pyx_t_34 = __pyx_v_b;
    __pyx_t_35 = __pyx_v_a;
    __pyx_t_36 = ((__pyx_v_b + 1) % __pyx_v_D);
    __pyx_v_u = ((int)((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_33 * __pyx_v_arr.strides[0]) )) + __pyx_t_34)) ))) == (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_35 * __pyx_v_arr.strides[0]) )) + __pyx_t_36)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">931</span>:         <span class="n">d</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][(</span><span class="n">b</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">+</span> <span class="n">D</span><span class="p">)</span> <span class="o">%</span> <span class="n">D</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(931,0,<span class='error_goto'>__PYX_ERR(0, 931, __pyx_L1_error)</span>)
    __pyx_t_37 = __pyx_v_a;
    __pyx_t_38 = __pyx_v_b;
    __pyx_t_39 = __pyx_v_a;
    __pyx_t_40 = (((__pyx_v_b - 1) + __pyx_v_D) % __pyx_v_D);
    __pyx_v_d = ((int)((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_37 * __pyx_v_arr.strides[0]) )) + __pyx_t_38)) ))) == (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_39 * __pyx_v_arr.strides[0]) )) + __pyx_t_40)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">932</span>:         <span class="n">nb</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">u</span> <span class="o">+</span> <span class="n">d</span> <span class="o">+</span> <span class="n">r</span> <span class="o">+</span> <span class="n">ul</span> <span class="o">+</span> <span class="n">ur</span> <span class="o">+</span> <span class="n">dl</span> <span class="o">+</span> <span class="n">dr</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(932,0,<span class='error_goto'>__PYX_ERR(0, 932, __pyx_L1_error)</span>)
    __pyx_v_nb = (((((((__pyx_v_l + __pyx_v_u) + __pyx_v_d) + __pyx_v_r) + __pyx_v_ul) + __pyx_v_ur) + __pyx_v_dl) + __pyx_v_dr);
</pre><pre class="cython line score-0">&#xA0;<span class="">933</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">934</span>:         <span class="n">l</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)][</span><span class="n">b</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(934,0,<span class='error_goto'>__PYX_ERR(0, 934, __pyx_L1_error)</span>)
  /*else*/ {
    __pyx_t_41 = __pyx_v_a;
    __pyx_t_42 = __pyx_v_b;
    __pyx_t_43 = (__pyx_v_a + 1);
    __pyx_t_44 = __pyx_v_b;
    __pyx_v_l = ((int)((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_41 * __pyx_v_arr.strides[0]) )) + __pyx_t_42)) ))) == (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_43 * __pyx_v_arr.strides[0]) )) + __pyx_t_44)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">935</span>:         <span class="n">r</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)][</span><span class="n">b</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(935,0,<span class='error_goto'>__PYX_ERR(0, 935, __pyx_L1_error)</span>)
    __pyx_t_45 = __pyx_v_a;
    __pyx_t_46 = __pyx_v_b;
    __pyx_t_47 = (__pyx_v_a - 1);
    __pyx_t_48 = __pyx_v_b;
    __pyx_v_r = ((int)((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_45 * __pyx_v_arr.strides[0]) )) + __pyx_t_46)) ))) == (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_47 * __pyx_v_arr.strides[0]) )) + __pyx_t_48)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">936</span>:         <span class="n">ul</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)][(</span><span class="n">b</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)])</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(936,0,<span class='error_goto'>__PYX_ERR(0, 936, __pyx_L1_error)</span>)
    __pyx_t_49 = __pyx_v_a;
    __pyx_t_50 = __pyx_v_b;
    __pyx_t_51 = (__pyx_v_a + 1);
    __pyx_t_52 = (__pyx_v_b + 1);
    __pyx_v_ul = ((int)((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_49 * __pyx_v_arr.strides[0]) )) + __pyx_t_50)) ))) == (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_51 * __pyx_v_arr.strides[0]) )) + __pyx_t_52)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">937</span>:         <span class="n">ur</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)][(</span><span class="n">b</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)])</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(937,0,<span class='error_goto'>__PYX_ERR(0, 937, __pyx_L1_error)</span>)
    __pyx_t_53 = __pyx_v_a;
    __pyx_t_54 = __pyx_v_b;
    __pyx_t_55 = (__pyx_v_a - 1);
    __pyx_t_56 = (__pyx_v_b + 1);
    __pyx_v_ur = ((int)((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_53 * __pyx_v_arr.strides[0]) )) + __pyx_t_54)) ))) == (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_55 * __pyx_v_arr.strides[0]) )) + __pyx_t_56)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">938</span>:         <span class="n">dl</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)][(</span><span class="n">b</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)])</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(938,0,<span class='error_goto'>__PYX_ERR(0, 938, __pyx_L1_error)</span>)
    __pyx_t_57 = __pyx_v_a;
    __pyx_t_58 = __pyx_v_b;
    __pyx_t_59 = (__pyx_v_a + 1);
    __pyx_t_60 = (__pyx_v_b - 1);
    __pyx_v_dl = ((int)((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_57 * __pyx_v_arr.strides[0]) )) + __pyx_t_58)) ))) == (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_59 * __pyx_v_arr.strides[0]) )) + __pyx_t_60)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">939</span>:         <span class="n">dr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[(</span><span class="n">a</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)][(</span><span class="n">b</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)])</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(939,0,<span class='error_goto'>__PYX_ERR(0, 939, __pyx_L1_error)</span>)
    __pyx_t_61 = __pyx_v_a;
    __pyx_t_62 = __pyx_v_b;
    __pyx_t_63 = (__pyx_v_a - 1);
    __pyx_t_64 = (__pyx_v_b - 1);
    __pyx_v_dr = ((int)((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_61 * __pyx_v_arr.strides[0]) )) + __pyx_t_62)) ))) == (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_63 * __pyx_v_arr.strides[0]) )) + __pyx_t_64)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">940</span>:         <span class="n">u</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][(</span><span class="n">b</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)])</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(940,0,<span class='error_goto'>__PYX_ERR(0, 940, __pyx_L1_error)</span>)
    __pyx_t_65 = __pyx_v_a;
    __pyx_t_66 = __pyx_v_b;
    __pyx_t_67 = __pyx_v_a;
    __pyx_t_68 = (__pyx_v_b + 1);
    __pyx_v_u = ((int)((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_65 * __pyx_v_arr.strides[0]) )) + __pyx_t_66)) ))) == (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_67 * __pyx_v_arr.strides[0]) )) + __pyx_t_68)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">941</span>:         <span class="n">d</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span> <span class="o">==</span> <span class="n">arr</span><span class="p">[</span><span class="n">a</span><span class="p">][(</span><span class="n">b</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)])</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(941,0,<span class='error_goto'>__PYX_ERR(0, 941, __pyx_L1_error)</span>)
    __pyx_t_69 = __pyx_v_a;
    __pyx_t_70 = __pyx_v_b;
    __pyx_t_71 = __pyx_v_a;
    __pyx_t_72 = (__pyx_v_b - 1);
    __pyx_v_d = ((int)((*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_69 * __pyx_v_arr.strides[0]) )) + __pyx_t_70)) ))) == (*((int *) ( /* dim=1 */ ((char *) (((int *) ( /* dim=0 */ (__pyx_v_arr.data + __pyx_t_71 * __pyx_v_arr.strides[0]) )) + __pyx_t_72)) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">942</span>:         <span class="n">nb</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">u</span> <span class="o">+</span> <span class="n">d</span> <span class="o">+</span> <span class="n">r</span> <span class="o">+</span> <span class="n">ul</span> <span class="o">+</span> <span class="n">ur</span> <span class="o">+</span> <span class="n">dl</span> <span class="o">+</span> <span class="n">dr</span></pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(942,0,<span class='error_goto'>__PYX_ERR(0, 942, __pyx_L1_error)</span>)
    __pyx_v_nb = (((((((__pyx_v_l + __pyx_v_u) + __pyx_v_d) + __pyx_v_r) + __pyx_v_ul) + __pyx_v_ur) + __pyx_v_dl) + __pyx_v_dr);
  }
  __pyx_L3:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">943</span>:     <span class="k">return</span> <span class="n">nb</span></pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(943,0,<span class='error_goto'>__PYX_ERR(0, 943, __pyx_L1_error)</span>)
  __pyx_r = __pyx_v_nb;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">944</span>: </pre>
</div></body></html>
